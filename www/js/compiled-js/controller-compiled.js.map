{"version":3,"sources":["controller.js"],"names":[],"mappings":";;;;AAAA;;;;AAIA;;;;;;;;AAQA;AACA,eAAe,4BAAf,EAA6C,UAA7C,GAA0D;;AAEtD;;;AAGA,aAAS,mBAAU;;AAEf;AACA,YAAI,KAAJ,yDAAU;AAAA;AAAA;AAAA;AAAA;AACN;AACA,gCAAI,kCAAJ,CAAuC,YAAU;AAC7C;AACH,6BAFD;;AAIA;AACA,8BAAE,uBAAF,EAA2B,IAA3B,CAAgC,gBAAhC;AACA,8BAAE,eAAF,EAAmB,GAAnB,CAAuB,CAAvB,EAA0B,IAA1B,GARM,CAQ4B;;AAElC,gCAAG,IAAH,EAAQ;AAAE;AACN;AACA,kCAAE,cAAF,EAAkB,GAAlB,CAAsB,CAAtB,EAAyB,OAAzB,CAAiC,IAAjC,CAAsC,mBAAtC;AAEH,6BAJD,MAKI;AAAE;AACF;AACA,kCAAE,cAAF,EAAkB,GAAlB,CAAsB,CAAtB,EAAyB,OAAzB,CAAiC,IAAjC,CAAsC,gBAAtC;AACH;;AAED;AACA,gCAAG;AACC;AACA,uCAAO,WAAP,CAAmB,IAAnB,CAAwB,UAAxB;AACH,6BAHD,CAIA,OAAM,GAAN,EAAU,CAAE;;AAzBN;AA4BA;;AAEF;AACA,2CAAe,4BAAf,EAA6C,KAA7C,CAAmD,WAAnD,GAAiE,IAAI,OAAJ,CAAY,0BAAZ,EAAwC;AACrG,yCAAS,gBAD4F;AAErG,0CAAU,SAF2F;AAGrG,+DAA+B;AAHsE,6BAAxC,CAAjE;AAKA;AACA,2CAAe,4BAAf,EAA6C,KAA7C,CAAmD,WAAnD,CAA+D,YAA/D;;AAEA;AACA,2CAAe,4BAAf,EAA6C,KAA7C,CAAmD,oBAAnD,GACI,IAAI,OAAJ,CAAY,mCAAZ,EAAiD;AACjD,yCAAS,gBADwC;AAEjD,0CAAU,SAFuC;AAGjD,+DAA+B;AAHkB,6BAAjD,CADJ;;AAOA;AACA,gCAAG,CAAC,OAAO,YAAP,CAAoB,OAApB,CAA4B,sCAA5B,CAAD,IACC,OAAO,YAAP,CAAoB,OAApB,CAA4B,sCAA5B,MAAwE,EAD5E,EACgF;AAC5E,uCAAO,YAAP,CAAoB,OAApB,CAA4B,sCAA5B,EACI,OAAO,KAAP,CAAa,eAAe,4BAAf,EAA6C,mBAA1D,CADJ;AAEH;AACD;AArDE;AAAA,mCAsDI,IAAI,OAAJ,CAAY,UAAS,OAAT,EAAkB,MAAlB,EAAyB;AACvC,+CAAe,4BAAf,EAA6C,KAA7C,CAAmD,oBAAnD,CACA,MADA,CACO,OAAO,YAAP,CAAoB,OAApB,CAA4B,sCAA5B,CADP,EAC4E;AACxE,4CAAQ,CAAC,cAAD,EAAiB,UAAjB,CADgE;AAExE,wCAAI,YAAS,GAAT,EAAc,GAAd,EAAkB;AAClB,4CAAG,GAAH,EAAO;AAAE;AACL,mDAAO,GAAP,EADG,CACU;AAChB,yCAFD,MAGI;AAAE;AACF,oDAAQ,GAAR,EADA,CACc;AACjB;AACJ,qCATuE,EAD5E;AAWH,6BAZK,CAtDJ;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAsEF,oCAAQ,GAAR,CAAY,mBAAZ;;AAtEE;AAAA;;AAyEF;AACA,sCAAU,0BAAV,CAAqC,SAArC;AACA,sCAAU,YAAV,CAAuB,IAAvB,GA3EE,CA2E6B;AAC/B,2CAAe,4BAAf,EAA6C,KAA7C,CAAmD,UAAnD,GAAgE,IAAhE,CA5EE,CA4EoE;AACtE,8BAAE,eAAF,EAAmB,GAAnB,CAAuB,CAAvB,EAA0B,IAA1B,GA7EE,CA6EgC;AA7EhC;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAAV,IAHe,CAmFX;AAEP;AA1FqD,CAA1D","file":"controller-compiled.js","sourcesContent":["/**\r\n * Created by UTOPIA SOFTWARE on 18/11/2018.\r\n */\r\n\r\n/**\r\n* file defines all View-Models, Controllers and Event Listeners used by the app\r\n*\r\n* The 'utopiasoftware_app_namespace' namespace variable has being defined in the base js file.\r\n* The author uses the terms 'method' and function interchangeably; likewise the terms 'attribute' and 'property' are\r\n* also used interchangeably\r\n*/\r\n\r\n// define the controller namespace\r\nutopiasoftware[utopiasoftware_app_namespace].controller = {\r\n\r\n    /**\r\n     * method contains the startup/bootstrap code needed to initiate app logic execution\r\n     */\r\n    startup: function(){\r\n\r\n        // initialise the app libraries and plugins\r\n        ons.ready(async function () {\r\n            // set the default handler for the app\r\n            ons.setDefaultDeviceBackButtonListener(function(){\r\n                // does nothing for now!!\r\n            });\r\n\r\n            // displaying prepping message\r\n            $('#loader-modal-message').html(\"Loading App...\");\r\n            $('#loader-modal').get(0).show(); // show loader\r\n\r\n            if(true){ // there is a previous logged in user\r\n                // load the app main page\r\n                $('ons-splitter').get(0).content.load(\"app-main-template\");\r\n\r\n            }\r\n            else{ // there is no previously logged in user\r\n                // load the login page\r\n                $('ons-splitter').get(0).content.load(\"login-template\");\r\n            }\r\n\r\n            // START ALL CORDOVA PLUGINS CONFIGURATIONS\r\n            try{\r\n                // lock the orientation of the device to 'PORTRAIT'\r\n                screen.orientation.lock('portrait');\r\n            }\r\n            catch(err){}\r\n\r\n\r\n            try { // START ALL THE CORDOVA PLUGINS CONFIGURATION WHICH REQUIRE PROMISE SYNTAX\r\n\r\n                // create the pouchdb app database\r\n                utopiasoftware[utopiasoftware_app_namespace].model.appDatabase = new PouchDB('PrintServiceEcommerce.db', {\r\n                    adapter: 'cordova-sqlite',\r\n                    location: 'default',\r\n                    androidDatabaseImplementation: 2\r\n                });\r\n                // ensure encryption is disabled for this database\r\n                utopiasoftware[utopiasoftware_app_namespace].model.appDatabase.removeCrypto();\r\n\r\n                // create the encrypted pouchdb app database\r\n                utopiasoftware[utopiasoftware_app_namespace].model.encryptedAppDatabase =\r\n                    new PouchDB('PrintServiceEcommerceEncrypted.db', {\r\n                    adapter: 'cordova-sqlite',\r\n                    location: 'default',\r\n                    androidDatabaseImplementation: 2\r\n                });\r\n\r\n                // generate a password for encrypting the app database (if it does NOT already exist)\r\n                if(!window.localStorage.getItem(\"utopiasoftware-oak-print-service-rid\") ||\r\n                    window.localStorage.getItem(\"utopiasoftware-oak-print-service-rid\") === \"\") {\r\n                    window.localStorage.setItem(\"utopiasoftware-oak-print-service-rid\",\r\n                        Random.uuid4(utopiasoftware[utopiasoftware_app_namespace].randomisationEngine));\r\n                }\r\n                // enable the db encryption using the generated password\r\n                await new Promise(function(resolve, reject){\r\n                    utopiasoftware[utopiasoftware_app_namespace].model.encryptedAppDatabase.\r\n                    crypto(window.localStorage.getItem(\"utopiasoftware-oak-print-service-rid\"), {\r\n                        ignore: ['_attachments', '_deleted'],\r\n                        cb: function(err, key){\r\n                            if(err){ // there is an error\r\n                                reject(err); // reject Promise\r\n                            }\r\n                            else{ // no error\r\n                                resolve(key); // resolve Promise\r\n                            }\r\n                        }});\r\n                });\r\n\r\n            }\r\n            catch(err){\r\n                console.log(\"APP LOADING ERROR\", err);\r\n            }\r\n            finally{\r\n                // set status bar color\r\n                StatusBar.backgroundColorByHexString(\"#363E7C\");\r\n                navigator.splashscreen.hide(); // hide the splashscreen\r\n                utopiasoftware[utopiasoftware_app_namespace].model.isAppReady = true; // flag that app is fully loaded and ready\r\n                $('#loader-modal').get(0).show(); // show loader\r\n            }\r\n\r\n        }); // end of ons.ready()\r\n\r\n    }\r\n};"]}