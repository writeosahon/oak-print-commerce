'use strict';var _slicedToArray=function(){function e(e,a){var t=[],o=!0,s=!1,i=void 0;try{for(var n=e[Symbol.iterator](),p;!(o=(p=n.next()).done)&&(t.push(p.value),!(a&&t.length===a));o=!0);}catch(e){s=!0,i=e}finally{try{!o&&n['return']&&n['return']()}finally{if(s)throw i}}return t}return function(a,t){if(Array.isArray(a))return a;if(Symbol.iterator in Object(a))return e(a,t);throw new TypeError('Invalid attempt to destructure non-iterable instance')}}();function _defineProperty(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}function _asyncToGenerator(e){return function(){var a=e.apply(this,arguments);return new Promise(function(e,t){function o(s,i){try{var n=a[s](i),p=n.value}catch(e){return void t(e)}return n.done?void e(p):Promise.resolve(p).then(function(e){o('next',e)},function(e){o('throw',e)})}return o('next')})}}utopiasoftware[utopiasoftware_app_namespace].controller={startup:function e(){ons.ready(_asyncToGenerator(regeneratorRuntime.mark(function e(){var a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:ons.setDefaultDeviceBackButtonListener(function(){}),$('#search-page-search-input-popover').get(0).onDeviceBackButton.disable(),$('#loader-modal-message').html('Loading App...'),$('#loader-modal').get(0).show(),new ej.notifications.Toast({content:'',cssClass:'default-ej2-toast',target:document.body,position:{X:'Center',Y:'Bottom'},width:'100%',timeOut:0,extendedTimeout:0,showCloseButton:!0}).appendTo($('.page-toast').get(0)),new ej.notifications.Toast({content:'',cssClass:'default-ej2-toast',target:document.body,position:{X:'Center',Y:'Bottom'},width:'100%',timeOut:4e3,extendedTimeout:0,showCloseButton:!0}).appendTo($('.timed-page-toast').get(0)),new ej.buttons.Button({cssClass:'e-flat e-small',iconPosition:'Left'}).appendTo('#view-cart-page-delete-cart-item-yes'),new ej.buttons.Button({cssClass:'e-flat e-small',iconPosition:'Left'}).appendTo('#view-cart-page-delete-cart-item-no');try{screen.orientation.lock('portrait')}catch(e){}return e.prev=9,utopiasoftware[utopiasoftware_app_namespace].model.appDatabase=new PouchDB('PrintServiceEcommerce.db',{adapter:'cordova-sqlite',location:'default',androidDatabaseImplementation:2}),utopiasoftware[utopiasoftware_app_namespace].model.encryptedAppDatabase=new PouchDB('PrintServiceEcommerceEncrypted.db',{adapter:'cordova-sqlite',location:'default',androidDatabaseImplementation:2}),a=null,e.prev=13,e.next=16,new Promise(function(e,a){NativeStorage.getItem('utopiasoftware-oak-print-service-secure-key',e,a)});case 16:a=e.sent,e.next=24;break;case 19:return e.prev=19,e.t0=e['catch'](13),e.next=23,new Promise(function(e,a){NativeStorage.setItem('utopiasoftware-oak-print-service-secure-key',{password:Random.uuid4(utopiasoftware[utopiasoftware_app_namespace].randomisationEngine)},e,a)});case 23:a=e.sent;case 24:return e.next=26,new Promise(function(e,t){utopiasoftware[utopiasoftware_app_namespace].model.encryptedAppDatabase.crypto(a.password,{ignore:['_attachments','_deleted','docType'],cb:function s(a,o){a?t(a):e(o)}})});case 26:return e.prev=26,e.next=29,utopiasoftware[utopiasoftware_app_namespace].databaseOperations.loadData('user-cart',utopiasoftware[utopiasoftware_app_namespace].model.appDatabase);case 29:utopiasoftware[utopiasoftware_app_namespace].model.cartCount=e.sent.cart.length,e.next=34;break;case 32:e.prev=32,e.t1=e['catch'](26);case 34:utopiasoftware[utopiasoftware_app_namespace].controller.appDatabaseChangesListenerViewModel.changesEventEmitter=utopiasoftware[utopiasoftware_app_namespace].model.appDatabase.changes({live:!0,include_docs:!0,since:'now',doc_ids:['user-cart']}).on('change',utopiasoftware[utopiasoftware_app_namespace].controller.appDatabaseChangesListenerViewModel.userCartChanged),e.next=40;break;case 37:e.prev=37,e.t2=e['catch'](9),console.log('APP LOADING ERROR',e.t2);case 40:return e.prev=40,$('ons-splitter').get(0).content.load('app-main-template'),StatusBar.backgroundColorByHexString('#363E7C'),navigator.splashscreen.hide(),utopiasoftware[utopiasoftware_app_namespace].model.isAppReady=!0,e.finish(40);case 46:case'end':return e.stop();}},e,this,[[9,37,40,46],[13,19],[26,32]])})))},appDatabaseChangesListenerViewModel:{changesEventEmitter:null,userCartChanged:function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(a){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:utopiasoftware[utopiasoftware_app_namespace].model.cartCount=!0===a.deleted?0:a.doc.cart.length,$('.cart-count').html(utopiasoftware[utopiasoftware_app_namespace].model.cartCount);case 2:case'end':return e.stop();}},e,this)}));return function a(){return e.apply(this,arguments)}}()},homePageViewModel:{newProductsCarousel:null,featuredProductsCarousel:null,salesProductsCarousel:null,pageInit:function o(e){var a=function(){var o=_asyncToGenerator(regeneratorRuntime.mark(function o(){var s,i,n,p;return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(ons.isReady()&&!1!==utopiasoftware[utopiasoftware_app_namespace].model.isAppReady){o.next=3;break}return setTimeout(a,500),o.abrupt('return');case 3:return e.target.onDeviceBackButton=utopiasoftware[utopiasoftware_app_namespace].controller.homePageViewModel.backButtonClicked,$('#home-page-pull-hook',t).get(0).onAction=utopiasoftware[utopiasoftware_app_namespace].controller.homePageViewModel.pagePullHookAction,$('#home-page-pull-hook',t).on('changestate',function(e){switch(e.originalEvent.state){case'initial':$('#home-page-pull-hook-fab',e.originalEvent.pullHook).html('<ons-icon icon="md-long-arrow-down" size="24px" style="color: #363E7C"></ons-icon>');break;case'preaction':$('#home-page-pull-hook-fab',e.originalEvent.pullHook).html('<ons-icon icon="md-long-arrow-up" size="24px" style="color: #363E7C"></ons-icon>');break;case'action':$('#home-page-pull-hook-fab',e.originalEvent.pullHook).html('<ons-progress-circular indeterminate modifier="pull-hook"></ons-progress-circular>');}}),o.prev=6,s=new Flickity($('#home-page #home-latest-design-block .row').get(0),{wrapAround:!0,groupCells:1,imagesLoaded:!0,cellSelector:'.col-xs-12',autoPlay:5e3,pauseAutoPlayOnHover:!1,dragThreshold:10,initialIndex:0,cellAlign:'left',contain:!1,prevNextButtons:!1,pageDots:!1}),s.on('scroll',function(){s._utopiasoftware_scrollTimer&&(window.clearTimeout(s._utopiasoftware_scrollTimer),s._utopiasoftware_scrollTimer=null),s._utopiasoftware_scrollTimer=window.setTimeout(function(){s.playPlayer()},0)}),s.on('staticClick',function(e,a,t){}),utopiasoftware[utopiasoftware_app_namespace].controller.homePageViewModel.newProductsCarousel=s,i=new Flickity($('#home-page #home-featured-design-block .row').get(0),{wrapAround:!0,groupCells:1,cellSelector:'.col-xs-7',autoPlay:4e3,pauseAutoPlayOnHover:!1,dragThreshold:10,initialIndex:0,cellAlign:'center',contain:!1,prevNextButtons:!1,pageDots:!1}),i.on('scroll',function(){i._utopiasoftware_scrollTimer&&(window.clearTimeout(i._utopiasoftware_scrollTimer),i._utopiasoftware_scrollTimer=null),i._utopiasoftware_scrollTimer=window.setTimeout(function(){i.playPlayer()},0)}),i.on('staticClick',function(e,a,t){t&&utopiasoftware[utopiasoftware_app_namespace].controller.homePageViewModel.productItemClicked(window.parseInt($(t).attr('data-product')),$(t).attr('data-segment'))}),utopiasoftware[utopiasoftware_app_namespace].controller.homePageViewModel.featuredProductsCarousel=i,n=new Flickity($('#home-page #home-sales-design-block .row').get(0),{wrapAround:!0,groupCells:1,cellSelector:'.col-xs-7',autoPlay:4500,pauseAutoPlayOnHover:!1,dragThreshold:10,initialIndex:0,cellAlign:'center',contain:!1,prevNextButtons:!1,pageDots:!1}),n.on('scroll',function(){n._utopiasoftware_scrollTimer&&(window.clearTimeout(n._utopiasoftware_scrollTimer),n._utopiasoftware_scrollTimer=null),n._utopiasoftware_scrollTimer=window.setTimeout(function(){n.playPlayer()},0)}),n.on('staticClick',function(e,a,t){t&&utopiasoftware[utopiasoftware_app_namespace].controller.homePageViewModel.productItemClicked(window.parseInt($(t).attr('data-product')),$(t).attr('data-segment'))}),utopiasoftware[utopiasoftware_app_namespace].controller.homePageViewModel.salesProductsCarousel=n,$('#loader-modal').get(0).hide(),$('#home-page .page-preloader').css('display','block'),o.next=23,utopiasoftware[utopiasoftware_app_namespace].controller.homePageViewModel.loadProducts();case 23:$('#home-page .page-preloader').css('display','none'),o.next=35;break;case 26:o.prev=26,o.t0=o['catch'](6),console.log('HOME PAGE ERROR',o.t0),$('.page-toast').get(0).ej2_instances[0].hide('All'),p=$('.page-toast').get(0).ej2_instances[0],p.cssClass='error-ej2-toast',p.content='Sorry, an error occurred.'+(navigator.connection.type===Connection.NONE?' Connect to the Internet.':'')+' Pull down to refresh and try again',p.dataBind(),p.show();case 35:return o.prev=35,o.finish(35);case 37:case'end':return o.stop();}},o,this,[[6,26,35,37]])}));return function(){return o.apply(this,arguments)}}(),t=$(e.target);a()},pageShow:function e(){$('#app-main-page ons-toolbar div.title-bar').html('OAK'),$('#app-main-page .cart-count').html(utopiasoftware[utopiasoftware_app_namespace].model.cartCount),window.SoftInputMode.set('adjustPan'),document.addEventListener('offline',utopiasoftware[utopiasoftware_app_namespace].controller.homePageViewModel.deviceOfflineListener,!1),document.addEventListener('online',utopiasoftware[utopiasoftware_app_namespace].controller.homePageViewModel.deviceOnlineListener,!1),utopiasoftware[utopiasoftware_app_namespace].controller.homePageViewModel.newProductsCarousel&&utopiasoftware[utopiasoftware_app_namespace].controller.homePageViewModel.newProductsCarousel.reloadCells(),utopiasoftware[utopiasoftware_app_namespace].controller.homePageViewModel.featuredProductsCarousel&&utopiasoftware[utopiasoftware_app_namespace].controller.homePageViewModel.featuredProductsCarousel.reloadCells(),utopiasoftware[utopiasoftware_app_namespace].controller.homePageViewModel.salesProductsCarousel&&utopiasoftware[utopiasoftware_app_namespace].controller.homePageViewModel.salesProductsCarousel.reloadCells()},pageHide:function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:document.removeEventListener('offline',utopiasoftware[utopiasoftware_app_namespace].controller.homePageViewModel.deviceOfflineListener,!1),document.removeEventListener('online',utopiasoftware[utopiasoftware_app_namespace].controller.homePageViewModel.deviceOnlineListener,!1);case 2:case'end':return e.stop();}},e,this)}));return function a(){return e.apply(this,arguments)}}(),pageDestroy:function e(){utopiasoftware[utopiasoftware_app_namespace].controller.homePageViewModel.newProductsCarousel.destroy(),utopiasoftware[utopiasoftware_app_namespace].controller.homePageViewModel.newProductsCarousel=null,utopiasoftware[utopiasoftware_app_namespace].controller.homePageViewModel.featuredProductsCarousel.destroy(),utopiasoftware[utopiasoftware_app_namespace].controller.homePageViewModel.featuredProductsCarousel=null,utopiasoftware[utopiasoftware_app_namespace].controller.homePageViewModel.salesProductsCarousel.destroy(),utopiasoftware[utopiasoftware_app_namespace].controller.homePageViewModel.salesProductsCarousel=null},backButtonClicked:function e(){ons.notification.confirm('Do you want to close the app?',{title:'<img src="css/app-images/oak-design-logo.png" style="height: 1.5em; width: auto; margin-right: 0.5em">Exit App',buttonLabels:['No','Yes'],modifier:'utopiasoftware-alert-dialog utopiasoftware-oak-alert-dialog'}).then(function(e){1===e&&navigator.app.exitApp()})},deviceOfflineListener:function a(){var e=$('.page-toast').get(0).ej2_instances[0];e.hide('All'),e.cssClass='default-ej2-toast',e.content='No Internet connection. Connect to the Internet to see live products',e.dataBind(),e.show()},deviceOnlineListener:function e(){$('.page-toast').get(0).ej2_instances[0].hide('All')},pagePullHookAction:function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){var a=0<arguments.length&&arguments[0]!==void 0?arguments[0]:function(){},t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return $('#home-page #home-page-pull-hook').attr('disabled',!0),$('.page-toast').get(0).ej2_instances[0].hide('All'),e.prev=2,e.next=5,utopiasoftware[utopiasoftware_app_namespace].controller.homePageViewModel.loadProducts();case 5:$('#home-page .page-preloader').css('display','none'),e.next=16;break;case 8:e.prev=8,e.t0=e['catch'](2),t=$('.page-toast').get(0).ej2_instances[0],t.hide('All'),t.cssClass='error-ej2-toast',t.content='Sorry, an error occurred. Refresh to try again',t.dataBind(),t.show();case 16:return e.prev=16,$('#home-page #home-page-pull-hook').removeAttr('disabled'),a(),e.finish(16);case 20:case'end':return e.stop();}},e,this,[[2,8,16,20]])}));return function a(){return e.apply(this,arguments)}}(),loadProducts:function(){var e=Math.ceil,a=Math.abs,t=_asyncToGenerator(regeneratorRuntime.mark(function t(){var o,s;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return o=[],navigator.connection.type===Connection.NONE?(s=$('.page-toast').get(0).ej2_instances[0],s.hide('All'),s.cssClass='default-ej2-toast',s.content='No Internet connection. Pull down to refresh and see live products',s.dataBind(),s.show(),o.push(new Promise(function(e,a){Promise.resolve(utopiasoftware[utopiasoftware_app_namespace].databaseOperations.loadData('banner-products',utopiasoftware[utopiasoftware_app_namespace].model.appDatabase)).then(function(e){return e.products}).then(function(a){$('#home-page #home-latest-design-block').css('opacity','1'),utopiasoftware[utopiasoftware_app_namespace].controller.homePageViewModel.newProductsCarousel.remove($('#home-page #home-latest-design-block .row .col-xs-12').get());for(var t=0,o;t<a.length;t++)o='<div class="col-xs-12" style="padding-left: 0; padding-right: 0;">\n                                    <div class="e-card" style="min-height: 40vh; max-height: 90vh">\n                                        <div class="e-card-image" style="">\n                                        <img src="css/app-images/blank-img.png" style="width: 100%; height: auto; max-height: 90vh">\n                                        </div>\n                                    </div>\n                                </div>',utopiasoftware[utopiasoftware_app_namespace].controller.homePageViewModel.newProductsCarousel.append($('<div class="col-xs-12" style="padding-left: 0; padding-right: 0;">\n                                    <div class="e-card" style="min-height: 40vh; max-height: 90vh">\n                                        <div class="e-card-image" style="">\n                                        <img src="css/app-images/blank-img.png" style="width: 100%; height: auto; max-height: 90vh">\n                                        </div>\n                                    </div>\n                                </div>'));$('#home-page #home-latest-design-block').css({opacity:'0',display:'none'}),e()}).catch(function(){$('#home-page #home-latest-design-block').css({opacity:'0',display:'none'}),a()})})),o.push(new Promise(function(e,a){Promise.resolve(utopiasoftware[utopiasoftware_app_namespace].databaseOperations.loadData('popular-products',utopiasoftware[utopiasoftware_app_namespace].model.appDatabase)).then(function(e){return e.products}).then(function(a){0<a.length?($('#home-page #home-featured-design-block').css({opacity:'1',display:'block'}),utopiasoftware[utopiasoftware_app_namespace].controller.homePageViewModel.featuredProductsCarousel.remove($('#home-page #home-featured-design-block .row .col-xs-7').get())):$('#home-page #home-featured-design-block').css({opacity:'0',display:'none'});for(var t=0,o;t<a.length;t++)o='<div class="col-xs-7" style="margin-left: 20.5%; margin-right: 20.5%;" \n                                    data-product="'+t+'" data-segment="featured">\n                                    <div class="e-card" style="min-height: 34vh;">\n                                        <div class="e-card-image" style="height: 60%; \n                                        background-image: url(\''+a[t].images[0].src+'\');">\n                                        </div>\n                                        <div class="e-card-header">\n                                            <div class="e-card-header-caption">\n                                                <div class="e-card-sub-title" style="color: #000000; text-align: center; font-size: 14px; text-transform: capitalize">\n                                                    '+a[t].name+'\n                                                </div>\n                                                <div class="e-card-sub-title" style="text-align: center;">\n                                                &#x20a6;'+kendo.toString(kendo.parseFloat(a[t].price),'n2')+'</div>\n                                            </div>\n                                        </div>\n                                    </div>\n                                </div>',utopiasoftware[utopiasoftware_app_namespace].controller.homePageViewModel.featuredProductsCarousel.append($(o));e()}).catch(function(){a()})})),o.push(new Promise(function(t,o){Promise.resolve(utopiasoftware[utopiasoftware_app_namespace].databaseOperations.loadData('sales-products',utopiasoftware[utopiasoftware_app_namespace].model.appDatabase)).then(function(e){return e.products}).then(function(o){0<o.length?($('#home-page #home-sales-design-block').css({opacity:'1',display:'block'}),utopiasoftware[utopiasoftware_app_namespace].controller.homePageViewModel.salesProductsCarousel.remove($('#home-page #home-sales-design-block .row .col-xs-7').get())):$('#home-page #home-sales-design-block').css({opacity:'0',display:'none'});for(var s=0;s<o.length;s++){o[s].regular_price&&''!=o[s].regular_price||(o[s].regular_price='0.00');var i='<div class="col-xs-7" style="margin-left: 20.5%; margin-right: 20.5%;" \n                                  data-product="'+s+'" data-segment="sales">\n                                    <div class="e-card" style="min-height: 34vh;">\n                                        <div class="e-card-image" style="height: 60%; \n                                        background-image: url(\''+o[s].images[0].src+'\');">\n                                        <span class="e-badge e-badge-danger" style="float: right; clear: both; \n                                                    background-color: transparent; color: #d64113;\n                                                    border: 1px #d64113 solid; font-size: 0.6em;">\n                                                    '+e(100*(a(kendo.parseFloat(o[s].price)-kendo.parseFloat(o[s].regular_price))/kendo.parseFloat('0.00'===o[s].regular_price?o[s].price:o[s].regular_price)))+'% OFF\n                                                    </span>\n                                        </div>\n                                        <div class="e-card-header">\n                                            <div class="e-card-header-caption">\n                                                <div class="e-card-sub-title" style="color: #000000; text-align: center; font-size: 14px; text-transform: capitalize">\n                                                    '+o[s].name+'\n                                                </div>\n                                                <div class="e-card-sub-title" style="text-align: center; text-decoration: line-through">\n                                                &#x20a6;'+kendo.toString(kendo.parseFloat(o[s].regular_price),'n2')+'\n                                                </div>\n                                                <div class="e-card-sub-title" style="text-align: center;">\n                                                &#x20a6;'+kendo.toString(kendo.parseFloat(o[s].price),'n2')+'\n                                                </div>\n                                            </div>\n                                        </div>\n                                    </div>\n                                </div>';utopiasoftware[utopiasoftware_app_namespace].controller.homePageViewModel.salesProductsCarousel.append($(i))}t()}).catch(function(){o()})}))):(o.push(new Promise(function(e,a){Promise.resolve($.ajax({url:utopiasoftware[utopiasoftware_app_namespace].model.appBaseUrl+'/wp-json/wc/v3/products',type:'get',beforeSend:function a(e){e.setRequestHeader('Authorization','Basic '+utopiasoftware[utopiasoftware_app_namespace].accessor)},dataType:'json',timeout:24e4,processData:!0,data:{order:'desc',orderby:'date',status:'private',type:'external',page:1,per_page:5}})).then(function(a){utopiasoftware[utopiasoftware_app_namespace].databaseOperations.saveData({_id:'banner-products',docType:'BANNER_PRODUCTS',products:a},utopiasoftware[utopiasoftware_app_namespace].model.appDatabase),0<a.length?($('#home-page #home-latest-design-block').css({opacity:'1',display:'block'}),utopiasoftware[utopiasoftware_app_namespace].controller.homePageViewModel.newProductsCarousel.remove($('#home-page #home-latest-design-block .row .col-xs-12').get())):$('#home-page #home-latest-design-block').css({opacity:'0',display:'none'});for(var t=0,o;t<a.length;t++)o='<div class="col-xs-12" style="padding-left: 0; padding-right: 0;">\n                                    <div class="e-card" style="min-height: 40vh; max-height: 90vh">\n                                        <div class="e-card-image" style="">\n                                        <img src="'+a[t].images[0].src+'" style="width: 100%; height: auto; max-height: 90vh">\n                                        </div>\n                                    </div>\n                                </div>',utopiasoftware[utopiasoftware_app_namespace].controller.homePageViewModel.newProductsCarousel.append($(o));e()}).catch(function(){a()})})),o.push(new Promise(function(e,a){Promise.resolve($.ajax({url:utopiasoftware[utopiasoftware_app_namespace].model.appBaseUrl+'/wp-json/wc/v3/products',type:'get',beforeSend:function a(e){e.setRequestHeader('Authorization','Basic '+utopiasoftware[utopiasoftware_app_namespace].accessor)},dataType:'json',timeout:24e4,processData:!0,data:{order:'desc',orderby:'date',status:'publish',type:'variable',stock_status:'instock',page:1,per_page:5,featured:!0}})).then(function(a){utopiasoftware[utopiasoftware_app_namespace].databaseOperations.saveData({_id:'popular-products',docType:'POPULAR_PRODUCTS',products:a},utopiasoftware[utopiasoftware_app_namespace].model.appDatabase),0<a.length?($('#home-page #home-featured-design-block').css({opacity:'1',display:'block'}),utopiasoftware[utopiasoftware_app_namespace].controller.homePageViewModel.featuredProductsCarousel.remove($('#home-page #home-featured-design-block .row .col-xs-7').get())):$('#home-page #home-featured-design-block').css({opacity:'0',display:'none'});for(var t=0,o;t<a.length;t++)o='<div class="col-xs-7" style="margin-left: 20.5%; margin-right: 20.5%;" \n                                 data-product="'+t+'" data-segment="featured">\n                                    <div class="e-card" style="min-height: 34vh;">\n                                        <div class="e-card-image" style="height: 60%; \n                                        background-image: url(\''+a[t].images[0].src+'\');">\n                                        </div>\n                                        <div class="e-card-header">\n                                            <div class="e-card-header-caption">\n                                                <div class="e-card-sub-title" style="color: #000000; text-align: center; font-size: 14px; text-transform: capitalize">\n                                                    '+a[t].name+'\n                                                </div>\n                                                <div class="e-card-sub-title" style="text-align: center;">\n                                                &#x20a6;'+kendo.toString(kendo.parseFloat(a[t].price),'n2')+'</div>\n                                            </div>\n                                        </div>\n                                    </div>\n                                </div>',utopiasoftware[utopiasoftware_app_namespace].controller.homePageViewModel.featuredProductsCarousel.append($(o));e()}).catch(function(){a()})})),o.push(new Promise(function(t,o){Promise.resolve($.ajax({url:utopiasoftware[utopiasoftware_app_namespace].model.appBaseUrl+'/wp-json/wc/v3/products',type:'get',beforeSend:function a(e){e.setRequestHeader('Authorization','Basic '+utopiasoftware[utopiasoftware_app_namespace].accessor)},dataType:'json',timeout:24e4,processData:!0,data:{order:'desc',orderby:'date',status:'publish',type:'variable',stock_status:'instock',page:1,per_page:5,on_sale:!0}})).then(function(o){utopiasoftware[utopiasoftware_app_namespace].databaseOperations.saveData({_id:'sales-products',docType:'SALES_PRODUCTS',products:o},utopiasoftware[utopiasoftware_app_namespace].model.appDatabase),0<o.length?($('#home-page #home-sales-design-block').css({opacity:'1',display:'block'}),utopiasoftware[utopiasoftware_app_namespace].controller.homePageViewModel.salesProductsCarousel.remove($('#home-page #home-sales-design-block .row .col-xs-7').get())):$('#home-page #home-sales-design-block').css({opacity:'0',display:'none'});for(var s=0;s<o.length;s++){o[s].regular_price&&''!=o[s].regular_price||(o[s].regular_price='0.00');var i='<div class="col-xs-7" style="margin-left: 20.5%; margin-right: 20.5%;" \n                                    data-product="'+s+'" data-segment="sales">\n                                    <div class="e-card" style="min-height: 34vh;">\n                                        <div class="e-card-image" style="height: 60%; \n                                        background-image: url(\''+o[s].images[0].src+'\');">\n                                        <span class="e-badge e-badge-danger" style="float: right; clear: both; \n                                                    background-color: transparent; color: #d64113;\n                                                    border: 1px #d64113 solid; font-size: 0.6em;">\n                                                    '+e(100*(a(kendo.parseFloat(o[s].price)-kendo.parseFloat(o[s].regular_price))/kendo.parseFloat('0.00'===o[s].regular_price?o[s].price:o[s].regular_price)))+'% OFF\n                                                    </span>\n                                        </div>\n                                        <div class="e-card-header">\n                                            <div class="e-card-header-caption">\n                                                <div class="e-card-sub-title" style="color: #000000; text-align: center; font-size: 14px; text-transform: capitalize">\n                                                    '+o[s].name+'\n                                                </div>\n                                                <div class="e-card-sub-title" style="text-align: center; text-decoration: line-through">\n                                                &#x20a6;'+kendo.toString(kendo.parseFloat(o[s].regular_price),'n2')+'\n                                                </div>\n                                                <div class="e-card-sub-title" style="text-align: center;">\n                                                &#x20a6;'+kendo.toString(kendo.parseFloat(o[s].price),'n2')+'\n                                                </div>\n                                            </div>\n                                        </div>\n                                    </div>\n                                </div>';utopiasoftware[utopiasoftware_app_namespace].controller.homePageViewModel.salesProductsCarousel.append($(i))}t()}).catch(function(){o()})}))),t.abrupt('return',Promise.all(o));case 3:case'end':return t.stop();}},t,this)}));return function e(){return t.apply(this,arguments)}}(),showMoreFeaturedProducts:function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:window.setTimeout(_asyncToGenerator(regeneratorRuntime.mark(function e(){var a,t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,$('#app-main-tabbar').get(0).setActiveTab(4,{animation:'none'});case 3:return e.next=5,utopiasoftware[utopiasoftware_app_namespace].controller.productsPageViewModel.loadProducts({order:'desc',orderby:'date',status:'publish',type:'variable',stock_status:'instock',page:1,per_page:20,featured:!0});case 5:return a=e.sent,e.next=8,utopiasoftware[utopiasoftware_app_namespace].controller.productsPageViewModel.displayPageContent(a[0]);case 8:e.next=18;break;case 10:e.prev=10,e.t0=e['catch'](0),$('.page-toast').get(0).ej2_instances[0].hide('All'),t=$('.page-toast').get(0).ej2_instances[0],t.cssClass='error-ej2-toast',t.content='Sorry, an error occurred.'+(navigator.connection.type===Connection.NONE?' Connect to the Internet.':'')+' Pull down to refresh and try again',t.dataBind(),t.show();case 18:return e.prev=18,$('#products-page .page-preloader').css('display','none'),e.finish(18);case 21:case'end':return e.stop();}},e,this,[[0,10,18,21]])})),0);case 1:case'end':return e.stop();}},e,this)}));return function a(){return e.apply(this,arguments)}}(),showMoreSalesProducts:function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:window.setTimeout(_asyncToGenerator(regeneratorRuntime.mark(function e(){var a,t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,$('#app-main-tabbar').get(0).setActiveTab(4,{animation:'none'});case 3:return e.next=5,utopiasoftware[utopiasoftware_app_namespace].controller.productsPageViewModel.loadProducts({order:'desc',orderby:'date',status:'publish',type:'variable',stock_status:'instock',page:1,per_page:20,on_sale:!0});case 5:return a=e.sent,e.next=8,utopiasoftware[utopiasoftware_app_namespace].controller.productsPageViewModel.displayPageContent(a[0]);case 8:e.next=18;break;case 10:e.prev=10,e.t0=e['catch'](0),$('.page-toast').get(0).ej2_instances[0].hide('All'),t=$('.page-toast').get(0).ej2_instances[0],t.cssClass='error-ej2-toast',t.content='Sorry, an error occurred.'+(navigator.connection.type===Connection.NONE?' Connect to the Internet.':'')+' Pull down to refresh and try again',t.dataBind(),t.show();case 18:return e.prev=18,$('#products-page .page-preloader').css('display','none'),e.finish(18);case 21:case'end':return e.stop();}},e,this,[[0,10,18,21]])})),0);case 1:case'end':return e.stop();}},e,this)}));return function a(){return e.apply(this,arguments)}}(),productItemClicked:function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(a,t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:window.setTimeout(_asyncToGenerator(regeneratorRuntime.mark(function e(){var o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:o=[],e.prev=1,e.t0=t,e.next='featured'===e.t0?5:'sales'===e.t0?9:13;break;case 5:return e.next=7,utopiasoftware[utopiasoftware_app_namespace].databaseOperations.loadData('popular-products',utopiasoftware[utopiasoftware_app_namespace].model.appDatabase);case 7:return o=e.sent.products,e.abrupt('break',13);case 9:return e.next=11,utopiasoftware[utopiasoftware_app_namespace].databaseOperations.loadData('sales-products',utopiasoftware[utopiasoftware_app_namespace].model.appDatabase);case 11:return o=e.sent.products,e.abrupt('break',13);case 13:$('#app-main-navigator').get(0).pushPage('product-details-page.html',{animation:'lift',data:{product:o[a]}}),e.next=18;break;case 16:e.prev=16,e.t1=e['catch'](1);case 18:case'end':return e.stop();}},e,this,[[1,16]])})),0);case 1:case'end':return e.stop();}},e,this)}));return function a(){return e.apply(this,arguments)}}()},categoriesPageViewModel:{currentPage:0,pageSize:100,viewContentHeight:0,pageInit:function s(e){var a=Math.floor,t=function(){var s=_asyncToGenerator(regeneratorRuntime.mark(function s(){var i,n;return regeneratorRuntime.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(ons.isReady()&&!1!==utopiasoftware[utopiasoftware_app_namespace].model.isAppReady){s.next=3;break}return setTimeout(t,500),s.abrupt('return');case 3:return e.target.onDeviceBackButton=utopiasoftware[utopiasoftware_app_namespace].controller.categoriesPageViewModel.backButtonClicked,$('#categories-page-pull-hook',o).get(0).onAction=utopiasoftware[utopiasoftware_app_namespace].controller.categoriesPageViewModel.pagePullHookAction,$('#categories-page-pull-hook',o).on('changestate',function(e){switch(e.originalEvent.state){case'initial':$('#categories-page-pull-hook-fab',e.originalEvent.pullHook).html('<ons-icon icon="md-long-arrow-down" size="24px" style="color: #363E7C"></ons-icon>');break;case'preaction':$('#categories-page-pull-hook-fab',e.originalEvent.pullHook).html('<ons-icon icon="md-long-arrow-up" size="24px" style="color: #363E7C"></ons-icon>');break;case'action':$('#categories-page-pull-hook-fab',e.originalEvent.pullHook).html('<ons-progress-circular indeterminate modifier="pull-hook"></ons-progress-circular>');}}),utopiasoftware[utopiasoftware_app_namespace].controller.categoriesPageViewModel.viewContentHeight=a($('#categories-page .page__content').height()),$('#categories-page .page__content').on('scroll',function(){window.setTimeout(function(){var e=a($('#categories-page .page__content').scrollTop()),t=100*(e/utopiasoftware[utopiasoftware_app_namespace].controller.categoriesPageViewModel.viewContentHeight);50<=t?$('#categories-page #categories-page-scroll-top-fab').css({transform:'scale(1)',display:'inline-block'}):$('#categories-page #categories-page-scroll-top-fab').css({transform:'scale(0)'})},0)}),o.on('click','.e-card',function(e){window.setTimeout(_asyncToGenerator(regeneratorRuntime.mark(function a(){var t,o;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,$('#app-main-tabbar').get(0).setActiveTab(4,{animation:'none'});case 3:return a.next=5,utopiasoftware[utopiasoftware_app_namespace].controller.productsPageViewModel.loadProducts({order:'desc',orderby:'date',status:'publish',type:'variable',stock_status:'instock',page:1,per_page:20,category:$(e.currentTarget).attr('data-category-id')});case 5:return t=a.sent,a.next=8,utopiasoftware[utopiasoftware_app_namespace].controller.productsPageViewModel.displayPageContent(t[0]);case 8:a.next=18;break;case 10:a.prev=10,a.t0=a['catch'](0),$('.page-toast').get(0).ej2_instances[0].hide('All'),o=$('.page-toast').get(0).ej2_instances[0],o.cssClass='error-ej2-toast',o.content='Sorry, an error occurred.'+(navigator.connection.type===Connection.NONE?' Connect to the Internet.':'')+' Pull down to refresh and try again',o.dataBind(),o.show();case 18:return a.prev=18,$('#products-page .page-preloader').css('display','none'),a.finish(18);case 21:case'end':return a.stop();}},a,this,[[0,10,18,21]])})),0)}),s.prev=9,s.next=12,utopiasoftware[utopiasoftware_app_namespace].controller.categoriesPageViewModel.loadCategories();case 12:return i=s.sent,s.next=15,utopiasoftware[utopiasoftware_app_namespace].controller.categoriesPageViewModel.displayPageContent(i[0]);case 15:s.next=26;break;case 17:s.prev=17,s.t0=s['catch'](9),console.log('CATEGORY PAGE ERROR',s.t0),$('.page-toast').get(0).ej2_instances[0].hide('All'),n=$('.page-toast').get(0).ej2_instances[0],n.cssClass='error-ej2-toast',n.content='Sorry, an error occurred.'+(navigator.connection.type===Connection.NONE?' Connect to the Internet.':'')+' Pull down to refresh and try again',n.dataBind(),n.show();case 26:return s.prev=26,$('#categories-page .page-preloader').css('display','none'),s.finish(26);case 29:case'end':return s.stop();}},s,this,[[9,17,26,29]])}));return function(){return s.apply(this,arguments)}}(),o=$(e.target);t()},pageShow:function e(){$('#app-main-page ons-toolbar div.title-bar').html('Products'),$('#app-main-page .cart-count').html(utopiasoftware[utopiasoftware_app_namespace].model.cartCount),$('#categories-page #categories-page-scroll-top-fab').css({display:'none'}),window.SoftInputMode.set('adjustPan'),document.addEventListener('offline',utopiasoftware[utopiasoftware_app_namespace].controller.categoriesPageViewModel.deviceOfflineListener,!1),document.addEventListener('online',utopiasoftware[utopiasoftware_app_namespace].controller.categoriesPageViewModel.deviceOnlineListener,!1)},pageHide:function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:document.removeEventListener('offline',utopiasoftware[utopiasoftware_app_namespace].controller.categoriesPageViewModel.deviceOfflineListener,!1),document.removeEventListener('online',utopiasoftware[utopiasoftware_app_namespace].controller.categoriesPageViewModel.deviceOnlineListener,!1);case 2:case'end':return e.stop();}},e,this)}));return function a(){return e.apply(this,arguments)}}(),pageDestroy:function e(){utopiasoftware[utopiasoftware_app_namespace].controller.categoriesPageViewModel.currentPage=0,utopiasoftware[utopiasoftware_app_namespace].controller.categoriesPageViewModel.pageSize=100,utopiasoftware[utopiasoftware_app_namespace].controller.categoriesPageViewModel.viewContentHeight=0},backButtonClicked:function e(){$('#app-main-tabbar').get(0).setActiveTab(0)},deviceOfflineListener:function a(){var e=$('.page-toast').get(0).ej2_instances[0];e.hide('All'),e.cssClass='default-ej2-toast',e.content='No Internet connection. Connect to the Internet to see updated products',e.dataBind(),e.show()},deviceOnlineListener:function e(){$('.page-toast').get(0).ej2_instances[0].hide('All')},pagePullHookAction:function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){var a=0<arguments.length&&arguments[0]!==void 0?arguments[0]:function(){},t,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return $('#categories-page #categories-page-pull-hook').attr('disabled',!0),$('.page-toast').get(0).ej2_instances[0].hide('All'),e.prev=2,e.next=5,utopiasoftware[utopiasoftware_app_namespace].controller.categoriesPageViewModel.loadCategories(1,utopiasoftware[utopiasoftware_app_namespace].controller.categoriesPageViewModel.pageSize);case 5:return t=e.sent,e.next=8,utopiasoftware[utopiasoftware_app_namespace].controller.categoriesPageViewModel.displayPageContent(t[0]);case 8:e.next=17;break;case 10:e.prev=10,e.t0=e['catch'](2),o=$('.page-toast').get(0).ej2_instances[0],o.cssClass='error-ej2-toast',o.content='Sorry, an error occurred. Refresh to try again',o.dataBind(),o.show();case 17:return e.prev=17,$('#categories-page #categories-page-pull-hook').removeAttr('disabled'),a(),e.finish(17);case 21:case'end':return e.stop();}},e,this,[[2,10,17,21]])}));return function a(){return e.apply(this,arguments)}}(),loadCategories:function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){var a=0<arguments.length&&arguments[0]!==void 0?arguments[0]:utopiasoftware[utopiasoftware_app_namespace].controller.categoriesPageViewModel.currentPage+1,t=1<arguments.length&&arguments[1]!==void 0?arguments[1]:utopiasoftware[utopiasoftware_app_namespace].controller.categoriesPageViewModel.pageSize,o,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o=[],navigator.connection.type===Connection.NONE?(s=$('.page-toast').get(0).ej2_instances[0],s.hide('All'),s.cssClass='default-ej2-toast',s.content='No Internet connection. Pull down to refresh and see updated products',s.dataBind(),s.show(),o.push(new Promise(function(e,t){var o=(''+a).padStart(7,'0')+'categories';Promise.resolve(utopiasoftware[utopiasoftware_app_namespace].databaseOperations.loadData(o,utopiasoftware[utopiasoftware_app_namespace].model.appDatabase)).then(function(a){e(a.categories)}).catch(function(e){t(e)})}))):o.push(new Promise(function(e,o){Promise.resolve($.ajax({url:utopiasoftware[utopiasoftware_app_namespace].model.appBaseUrl+'/wp-json/wc/v3/products/categories',type:'get',beforeSend:function a(e){e.setRequestHeader('Authorization','Basic '+utopiasoftware[utopiasoftware_app_namespace].accessor)},dataType:'json',timeout:24e4,processData:!0,data:{order:'asc',orderby:'name',hide_empty:!0,page:a,per_page:t}})).then(function(t){if(0<t.length){t=t.filter(function(e){return'uncategorized'!==e.slug});var o=(''+a).padStart(7,'0')+'categories';utopiasoftware[utopiasoftware_app_namespace].databaseOperations.saveData({_id:o,docType:'PRODUCT_CATEGORIES',categories:t},utopiasoftware[utopiasoftware_app_namespace].model.appDatabase),utopiasoftware[utopiasoftware_app_namespace].controller.categoriesPageViewModel.currentPage=a}e(t)}).catch(function(e){o(e)})})),e.abrupt('return',Promise.all(o));case 3:case'end':return e.stop();}},e,this)}));return function a(){return e.apply(this,arguments)}}(),displayPageContent:function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(a){var t=!(1<arguments.length&&arguments[1]!==void 0)||arguments[1],o=!(2<arguments.length&&arguments[2]!==void 0)||arguments[2],s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s=new Promise(function(e){var s='';if(0>=a.length)e(a.length);else{for(var i=0;i<a.length;i++)s+='<div class="col-xs-4" ',s+=0==(i+1)%3?'style="border-bottom: 1px lightgray solid">':'style="border-right: 1px lightgray solid; border-bottom: 1px lightgray solid">',s+='\n                        <ons-ripple background="rgba(63, 81, 181, 0.3)"></ons-ripple>\n                        <div class="e-card" data-category-id="'+a[i].id+'">\n                            <div class="e-card-image" style="min-height: 100px; \n                            background-image: url(\''+a[i].image.src+'\');">\n                            </div>\n                            <div class="e-card-header">\n                                <div class="e-card-header-caption"  style="padding-left: 3px; padding-right: 5px">\n                                    <div class="e-card-sub-title" style="font-size: 14px; text-align: center; text-transform: capitalize">\n                                        '+a[i].name+'\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                      </div>';!0===o?$('#categories-page #categories-contents-container').html(s):!0===t?$('#categories-page #categories-contents-container').append(s):$('#categories-page #categories-contents-container').prepend(s),e(a.length)}}),e.abrupt('return',s);case 2:case'end':return e.stop();}},e,this)}));return function a(){return e.apply(this,arguments)}}(),scrollPageToTop:function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:window.setTimeout(function(){$('#categories-page .page__content').animate({scrollTop:0},400)},0);case 1:case'end':return e.stop();}},e,this)}));return function a(){return e.apply(this,arguments)}}()},searchPageViewModel:{currentSearchResultsArray:null,pageInit:function o(e){var a=function(){var t=_asyncToGenerator(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(ons.isReady()&&!1!==utopiasoftware[utopiasoftware_app_namespace].model.isAppReady){t.next=3;break}return setTimeout(a,500),t.abrupt('return');case 3:e.target.onDeviceBackButton=utopiasoftware[utopiasoftware_app_namespace].controller.searchPageViewModel.backButtonClicked;try{new ej.dropdowns.AutoComplete({floatLabelType:'Never',placeholder:'Search Products',allowCustom:!0,filterType:'Contains',minLength:1e3,suggestionCount:20,dataSource:[],noRecordsTemplate:'Tap \'Search\' key to begin search',blur:function e(){this._allowRemoteSearch=!1,$('#search-page-search-input-popover').get(0).hide()},change:function a(){var e='';return!0===this._allowRemoteSearch?this.value&&''!==this.value.trim()?void(e=this.value.trim(),$('#search-page-search-input-popover #search-input-popover-list').html('\n                            <ons-list-item modifier="nodivider" lock-on-drag="true">\n                                <div class="left">\n                                    <ons-progress-circular indeterminate modifier="pull-hook" \n                                    style="transform: scale(0.6)"></ons-progress-circular>\n                                </div>\n                                <div class="center">\n                                    <div style="text-align: center;">\n                                        Searching for products\n                                    </div>\n                                </div>\n                            </ons-list-item>'),$('#search-page-search-input-popover').get(0).show(document.getElementById('search-page-input')),window.setTimeout(_asyncToGenerator(regeneratorRuntime.mark(function a(){var t,o;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return t=[],a.prev=1,a.next=4,utopiasoftware[utopiasoftware_app_namespace].controller.searchPageViewModel.loadProducts({order:'desc',orderby:'date',status:'publish',type:'variable',stock_status:'instock',page:1,per_page:3,search:e});case 4:return t=a.sent,a.next=7,utopiasoftware[utopiasoftware_app_namespace].controller.searchPageViewModel.displayPageContent(t[0]);case 7:a.next=20;break;case 9:a.prev=9,a.t0=a['catch'](1),$('#search-page #search-page-input').get(0).ej2_instances[0].focusOut(),$('.page-toast').get(0).ej2_instances[0].hide('All'),$('.timed-page-toast').get(0).ej2_instances[0].hide('All'),o=$('.timed-page-toast').get(0).ej2_instances[0],o.cssClass='error-ej2-toast',o.timeOut=3e3,o.content='Sorry, a search error occurred.'+(navigator.connection.type===Connection.NONE?' Connect to the Internet.':''),o.dataBind(),o.show();case 20:case'end':return a.stop();}},a,this,[[1,9]])})),0)):void(this._allowRemoteSearch=!1):void(this._allowRemoteSearch=!1)}}).appendTo('#search-page-input')}catch(e){}case 5:case'end':return t.stop();}},t,this)}));return function(){return t.apply(this,arguments)}}(),t=$(e.target);a()},pageShow:function e(){$('#app-main-page ons-toolbar div.title-bar').html('Search'),$('#app-main-page .cart-count').html(utopiasoftware[utopiasoftware_app_namespace].model.cartCount),window.SoftInputMode.set('adjustPan'),document.addEventListener('offline',utopiasoftware[utopiasoftware_app_namespace].controller.searchPageViewModel.deviceOfflineListener,!1),document.addEventListener('online',utopiasoftware[utopiasoftware_app_namespace].controller.searchPageViewModel.deviceOnlineListener,!1),utopiasoftware[utopiasoftware_app_namespace].controller.searchPageViewModel.displayRecentSearches()},pageHide:function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:document.removeEventListener('offline',utopiasoftware[utopiasoftware_app_namespace].controller.searchPageViewModel.deviceOfflineListener,!1),document.removeEventListener('online',utopiasoftware[utopiasoftware_app_namespace].controller.searchPageViewModel.deviceOnlineListener,!1),utopiasoftware[utopiasoftware_app_namespace].controller.searchPageViewModel.currentSearchResultsArray=null;case 3:case'end':return e.stop();}},e,this)}));return function a(){return e.apply(this,arguments)}}(),pageDestroy:function e(){$('#search-page #search-page-input').get(0).ej2_instances[0].destroy()},backButtonClicked:function e(){$('#search-page-search-input-popover').get(0).hide(),$('#app-main-tabbar').get(0).setActiveTab(1)},deviceOfflineListener:function a(){var e=$('.page-toast').get(0).ej2_instances[0];e.hide('All'),e.cssClass='default-ej2-toast',e.content='No Internet connection. Connect to the Internet to see search results',e.dataBind(),e.show()},deviceOnlineListener:function e(){$('.page-toast').get(0).ej2_instances[0].hide('All')},displayRecentSearches:function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){var a,t,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,utopiasoftware[utopiasoftware_app_namespace].databaseOperations.loadData('recent-searches',utopiasoftware[utopiasoftware_app_namespace].model.appDatabase);case 3:for(a=e.sent,t='<ons-list-title>Recent Searches</ons-list-title>',o=0;o<a.products.length;o++)t+='\n                    <ons-list-item modifier="longdivider" tappable lock-on-drag="true">\n                        <div class="center">\n                            <div style="width: 100%;" \n                            onclick="utopiasoftware[utopiasoftware_app_namespace].controller.searchPageViewModel.\n                              recentSearchesItemClicked('+o+')">\n                                <span class="list-item__subtitle">'+a.products[o].name+'</span>\n                            </div>\n                        </div>\n                        <div class="right" prevent-tap \n                        onclick="utopiasoftware[utopiasoftware_app_namespace].controller.searchPageViewModel.\n                                    removeRecentSearchItem('+o+', this);">\n                            <ons-icon icon="md-close-circle" style="color: lavender; font-size: 18px;"></ons-icon>\n                        </div>\n                    </ons-list-item>';$('#search-page #search-list').html(t),e.next=11;break;case 9:e.prev=9,e.t0=e['catch'](0);case 11:case'end':return e.stop();}},e,this,[[0,9]])}));return function a(){return e.apply(this,arguments)}}(),saveRecentSearchItem:function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(a){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],e.prev=1,e.next=4,utopiasoftware[utopiasoftware_app_namespace].databaseOperations.loadData('recent-searches',utopiasoftware[utopiasoftware_app_namespace].model.appDatabase);case 4:t=e.sent.products,e.next=9;break;case 7:e.prev=7,e.t0=e['catch'](1);case 9:return e.prev=9,t.unshift(a),t=t.slice(0,5),e.next=14,utopiasoftware[utopiasoftware_app_namespace].databaseOperations.saveData({_id:'recent-searches',docType:'RECENT_SEARCHES',products:t},utopiasoftware[utopiasoftware_app_namespace].model.appDatabase);case 14:return e.next=16,utopiasoftware[utopiasoftware_app_namespace].controller.searchPageViewModel.displayRecentSearches();case 16:e.next=20;break;case 18:e.prev=18,e.t1=e['catch'](9);case 20:case'end':return e.stop();}},e,this,[[1,7],[9,18]])}));return function a(){return e.apply(this,arguments)}}(),removeRecentSearchItem:function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(a,t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:window.setTimeout(_asyncToGenerator(regeneratorRuntime.mark(function e(){var o,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o=[],e.prev=1,e.next=4,utopiasoftware[utopiasoftware_app_namespace].databaseOperations.loadData('recent-searches',utopiasoftware[utopiasoftware_app_namespace].model.appDatabase);case 4:o=e.sent.products,e.next=9;break;case 7:e.prev=7,e.t0=e['catch'](1);case 9:return e.prev=9,o.splice(a,1),e.next=13,utopiasoftware[utopiasoftware_app_namespace].databaseOperations.saveData({_id:'recent-searches',docType:'RECENT_SEARCHES',products:o},utopiasoftware[utopiasoftware_app_namespace].model.appDatabase);case 13:return s=$(t).closest('ons-list-item'),e.next=16,kendo.fx(s).expand('vertical').duration(300).reverse();case 16:return e.next=18,utopiasoftware[utopiasoftware_app_namespace].controller.searchPageViewModel.displayRecentSearches();case 18:e.next=22;break;case 20:e.prev=20,e.t1=e['catch'](9);case 22:case'end':return e.stop();}},e,this,[[1,7],[9,20]])})),0);case 1:case'end':return e.stop();}},e,this)}));return function a(){return e.apply(this,arguments)}}(),recentSearchesItemClicked:function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(a){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:window.setTimeout(_asyncToGenerator(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,utopiasoftware[utopiasoftware_app_namespace].databaseOperations.loadData('recent-searches',utopiasoftware[utopiasoftware_app_namespace].model.appDatabase);case 3:t=e.sent.products,$('#app-main-navigator').get(0).pushPage('product-details-page.html',{animation:'lift',data:{product:t[a]}}),e.next=9;break;case 7:e.prev=7,e.t0=e['catch'](0);case 9:case'end':return e.stop();}},e,this,[[0,7]])})),0);case 1:case'end':return e.stop();}},e,this)}));return function a(){return e.apply(this,arguments)}}(),enterButtonClicked:function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(a){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a.which===kendo.keys.ENTER&&(a.preventDefault(),a.stopImmediatePropagation(),a.stopPropagation(),Keyboard.hide(),t=$('#search-page #search-page-input').get(0).ej2_instances[0],t.value=$('#search-page #search-page-input').val(),t._allowRemoteSearch=!0,t.dataBind(),t.change());case 1:case'end':return e.stop();}},e,this)}));return function a(){return e.apply(this,arguments)}}(),loadProducts:function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(a){var t=1<arguments.length&&arguments[1]!==void 0?arguments[1]:a.page||1,o=2<arguments.length&&arguments[2]!==void 0?arguments[2]:a.per_page||3,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a.page=t,a.per_page=o,s=[],navigator.connection.type===Connection.NONE?s.push(Promise.reject('no internet connection')):s.push(new Promise(function(e,t){Promise.resolve($.ajax({url:utopiasoftware[utopiasoftware_app_namespace].model.appBaseUrl+'/wp-json/wc/v3/products',type:'get',beforeSend:function a(e){e.setRequestHeader('Authorization','Basic '+utopiasoftware[utopiasoftware_app_namespace].accessor)},dataType:'json',timeout:24e4,processData:!0,data:a})).then(function(a){0<a.length&&(utopiasoftware[utopiasoftware_app_namespace].controller.searchPageViewModel.currentSearchResultsArray=a),e(a)}).catch(function(e){t(e)})})),e.abrupt('return',Promise.all(s));case 5:case'end':return e.stop();}},e,this)}));return function a(){return e.apply(this,arguments)}}(),displayPageContent:function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(a){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=new Promise(function(e){var t='';if(0>=a.length)$('#search-page-search-input-popover #search-input-popover-list').html('<ons-list-item modifier="nodivider" lock-on-drag="true">\n                                <div class="center">\n                                    <div style="text-align: center; width: 100%;">\n                                        No Results Found\n                                    </div>\n                                </div>\n                            </ons-list-item>'),e(a.length);else{for(var o=0;o<a.length;o++)t+='<ons-list-item modifier="nodivider" tappable lock-on-drag="true" \n                              onclick="utopiasoftware[utopiasoftware_app_namespace].controller.searchPageViewModel.\n                              searchAutocompletePopOverItemClicked('+o+')">\n                                <div class="left">\n                                    <div class="search-result-image" style="background-image: url(\''+a[o].images[0].src+'\'); \n                                                            width: 2em; height: 2em"></div>\n                                </div>\n                                <div class="center">\n                                    <div style="text-align: center;">\n                                        '+a[o].name+'\n                                    </div>\n                                </div>\n                            </ons-list-item>';t+='<ons-list-item modifier="nodivider" tappable lock-on-drag="true" \n                          onclick="utopiasoftware[utopiasoftware_app_namespace].controller.searchPageViewModel.findMoreClicked();">\n                                <div class="center">\n                                    <div style="text-align: center; width: 100%; font-weight: bold;">\n                                        Find More...\n                                    </div>\n                                </div>\n                            </ons-list-item>',$('#search-page-search-input-popover #search-input-popover-list').html(t),e(a.length)}}),e.abrupt('return',t);case 2:case'end':return e.stop();}},e,this)}));return function a(){return e.apply(this,arguments)}}(),searchAutocompletePopOverItemClicked:function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(a){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=utopiasoftware[utopiasoftware_app_namespace].controller.searchPageViewModel.currentSearchResultsArray[a],window.setTimeout(_asyncToGenerator(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,$('#app-main-navigator').get(0).pushPage('product-details-page.html',{animation:'lift',data:{product:t}});case 3:return e.next=5,utopiasoftware[utopiasoftware_app_namespace].controller.searchPageViewModel.saveRecentSearchItem(t);case 5:$('#search-page #search-page-input').val(t.name),e.next=10;break;case 8:e.prev=8,e.t0=e['catch'](0);case 10:case'end':return e.stop();}},e,this,[[0,8]])})),0);case 2:case'end':return e.stop();}},e,this)}));return function a(){return e.apply(this,arguments)}}(),findMoreClicked:function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:window.setTimeout(_asyncToGenerator(regeneratorRuntime.mark(function e(){var a,t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,$('#app-main-tabbar').get(0).setActiveTab(4,{animation:'none'});case 3:return e.next=5,utopiasoftware[utopiasoftware_app_namespace].controller.productsPageViewModel.loadProducts({order:'desc',orderby:'date',status:'publish',type:'variable',stock_status:'instock',page:1,per_page:20,search:$('#search-page #search-page-input').get(0).ej2_instances[0].value.trim()});case 5:return a=e.sent,e.next=8,utopiasoftware[utopiasoftware_app_namespace].controller.productsPageViewModel.displayPageContent(a[0]);case 8:e.next=18;break;case 10:e.prev=10,e.t0=e['catch'](0),$('.page-toast').get(0).ej2_instances[0].hide('All'),t=$('.page-toast').get(0).ej2_instances[0],t.cssClass='error-ej2-toast',t.content='Sorry, an error occurred.'+(navigator.connection.type===Connection.NONE?' Connect to the Internet.':'')+' Pull down to refresh and try again',t.dataBind(),t.show();case 18:return e.prev=18,$('#products-page .page-preloader').css('display','none'),e.finish(18);case 21:case'end':return e.stop();}},e,this,[[0,10,18,21]])})),0);case 1:case'end':return e.stop();}},e,this)}));return function a(){return e.apply(this,arguments)}}()},accountPageViewModel:{pageInit:function o(e){var a=function(){var t=_asyncToGenerator(regeneratorRuntime.mark(function t(){var o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(ons.isReady()&&!1!==utopiasoftware[utopiasoftware_app_namespace].model.isAppReady){t.next=3;break}return setTimeout(a,500),t.abrupt('return');case 3:e.target.onDeviceBackButton=utopiasoftware[utopiasoftware_app_namespace].controller.accountPageViewModel.backButtonClicked;try{o=new ej.navigations.Accordion({expandMode:'Single'}),o.appendTo('#account-accordion'),o.expandItem(!0,0)}catch(e){}case 5:case'end':return t.stop();}},t,this)}));return function(){return t.apply(this,arguments)}}(),t=$(e.target);a()},pageShow:function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return $('#app-main-page ons-toolbar div.title-bar').html('Account'),$('#app-main-page .cart-count').html(utopiasoftware[utopiasoftware_app_namespace].model.cartCount),window.SoftInputMode.set('adjustPan'),e.abrupt('return',new Promise(function(e){window.setTimeout(_asyncToGenerator(regeneratorRuntime.mark(function a(){var t;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,utopiasoftware[utopiasoftware_app_namespace].databaseOperations.loadData('user-details',utopiasoftware[utopiasoftware_app_namespace].model.encryptedAppDatabase);case 3:t=a.sent,$('#account-page .utopiasoftware-can-hide-list-item.utopiasoftware-user-sign-in-show').css('display','flex'),$('#account-page .utopiasoftware-can-hide-list-item:not(.utopiasoftware-user-sign-in-show)').css('display','none'),e(),a.next=14;break;case 9:a.prev=9,a.t0=a['catch'](0),$('#account-page .utopiasoftware-can-hide-list-item.utopiasoftware-user-sign-in-show').css('display','none'),$('#account-page .utopiasoftware-can-hide-list-item:not(.utopiasoftware-user-sign-in-show)').css('display','flex'),e();case 14:case'end':return a.stop();}},a,this,[[0,9]])})),0)}));case 4:case'end':return e.stop();}},e,this)}));return function a(){return e.apply(this,arguments)}}(),pageHide:function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case'end':return e.stop();}},e,this)}));return function a(){return e.apply(this,arguments)}}(),pageDestroy:function e(){$('#account-page #account-accordion').get(0).ej2_instances[0].destroy()},backButtonClicked:function e(){$('#app-main-tabbar').get(0).setActiveTab(2)},signOutListItemClicked:function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){var a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return $('#loader-modal-message').html('Signing user out...'),e.next=3,$('#loader-modal').get(0).show();case 3:return e.prev=3,e.next=6,Promise.all([utopiasoftware[utopiasoftware_app_namespace].databaseOperations.removeData('user-details',utopiasoftware[utopiasoftware_app_namespace].model.encryptedAppDatabase),utopiasoftware[utopiasoftware_app_namespace].databaseOperations.removeData('user-cart',utopiasoftware[utopiasoftware_app_namespace].model.appDatabase)]);case 6:e.next=11;break;case 8:e.prev=8,e.t0=e['catch'](3),console.log('USER SIGN OUT',e.t0);case 11:return $('#user-signout-iframe-container #user-signout-iframe').get(0).contentWindow&&$('#user-signout-iframe-container #user-signout-iframe').get(0).contentWindow.utopiasoftware_removeUsage&&$('#user-signout-iframe-container #user-signout-iframe').get(0).contentWindow.utopiasoftware_removeUsage(),e.next=14,utopiasoftware[utopiasoftware_app_namespace].controller.accountPageViewModel.pageShow();case 14:return $('#account-page .utopiasoftware-can-hide-list-item.utopiasoftware-user-sign-in-show').css('display','none'),$('#account-page .utopiasoftware-can-hide-list-item:not(.utopiasoftware-user-sign-in-show)').css('display','flex'),e.next=18,$('#loader-modal').get(0).hide();case 18:$('.page-toast').get(0).ej2_instances[0].hide('All'),$('.timed-page-toast').get(0).ej2_instances[0].hide('All'),a=$('.timed-page-toast').get(0).ej2_instances[0],a.cssClass='success-ej2-toast',a.timeOut=3e3,a.content='User signed out',a.dataBind(),a.show();case 26:case'end':return e.stop();}},e,this,[[3,8]])}));return function a(){return e.apply(this,arguments)}}(),profileListItemClicked:function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt('return',new Promise(function(e){window.setTimeout(_asyncToGenerator(regeneratorRuntime.mark(function a(){var t,o;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,utopiasoftware[utopiasoftware_app_namespace].databaseOperations.loadData('user-details',utopiasoftware[utopiasoftware_app_namespace].model.encryptedAppDatabase);case 3:return t=a.sent,a.next=6,$('#app-main-navigator').get(0).pushPage('profile-page.html');case 6:e(),a.next=20;break;case 9:a.prev=9,a.t0=a['catch'](0),$('.page-toast').get(0).ej2_instances[0].hide('All'),$('.timed-page-toast').get(0).ej2_instances[0].hide('All'),o=$('.timed-page-toast').get(0).ej2_instances[0],o.cssClass='default-ej2-toast',o.timeOut=3e3,o.content='Sign in to view your profile',o.dataBind(),o.show(),e();case 20:case'end':return a.stop();}},a,this,[[0,9]])})),0)}));case 1:case'end':return e.stop();}},e,this)}));return function a(){return e.apply(this,arguments)}}()},loginPageViewModel:{loginFormValidator:null,signupFormValidator:null,forgotPasswordFormValidator:null,pageInit:function o(e){var a=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(ons.isReady()&&!1!==utopiasoftware[utopiasoftware_app_namespace].model.isAppReady){e.next=3;break}return setTimeout(a,500),e.abrupt('return');case 3:$('#app-main-navigator').get(0).topPage.onDeviceBackButton=utopiasoftware[utopiasoftware_app_namespace].controller.loginPageViewModel.backButtonClicked,t.on('postchange','#login-carousel',utopiasoftware[utopiasoftware_app_namespace].controller.loginPageViewModel.changeScreenCarouselPostChange),t.on('postchange','#login-carousel',utopiasoftware[utopiasoftware_app_namespace].controller.loginPageViewModel.hideTooltipsCarouselPostChange),utopiasoftware[utopiasoftware_app_namespace].controller.loginPageViewModel.loginFormValidator=$('#login-page #login-form').parsley(),utopiasoftware[utopiasoftware_app_namespace].controller.loginPageViewModel.signupFormValidator=$('#login-page #signup-form').parsley(),utopiasoftware[utopiasoftware_app_namespace].controller.loginPageViewModel.forgotPasswordFormValidator=$('#login-page #forgot-password-form').parsley(),utopiasoftware[utopiasoftware_app_namespace].controller.loginPageViewModel.loginFormValidator.on('field:error',function(e){var a=$('#login-page #login-form').get(0).ej2_instances[e.$element.get(0)._utopiasoftware_validator_index];a.content=e.getErrorsMessages()[0],a.dataBind(),a.open(e.$element.get(0))}),utopiasoftware[utopiasoftware_app_namespace].controller.loginPageViewModel.loginFormValidator.on('field:success',function(e){var a=$('#login-page #login-form').get(0).ej2_instances[e.$element.get(0)._utopiasoftware_validator_index];a.close()}),utopiasoftware[utopiasoftware_app_namespace].controller.loginPageViewModel.loginFormValidator.on('form:success',utopiasoftware[utopiasoftware_app_namespace].controller.loginPageViewModel.loginFormValidated),utopiasoftware[utopiasoftware_app_namespace].controller.loginPageViewModel.signupFormValidator.on('field:error',function(e){var a=$('#login-page #signup-form').get(0).ej2_instances[e.$element.get(0)._utopiasoftware_validator_index];a.content=e.getErrorsMessages()[0],a.dataBind(),a.open(e.$element.get(0))}),utopiasoftware[utopiasoftware_app_namespace].controller.loginPageViewModel.signupFormValidator.on('field:success',function(e){var a=$('#login-page #signup-form').get(0).ej2_instances[e.$element.get(0)._utopiasoftware_validator_index];a.close()}),utopiasoftware[utopiasoftware_app_namespace].controller.loginPageViewModel.signupFormValidator.on('form:success',utopiasoftware[utopiasoftware_app_namespace].controller.loginPageViewModel.signupFormValidated),utopiasoftware[utopiasoftware_app_namespace].controller.loginPageViewModel.forgotPasswordFormValidator.on('field:error',function(e){var a=$('#login-page #forgot-password-form').get(0).ej2_instances[e.$element.get(0)._utopiasoftware_validator_index];a.content=e.getErrorsMessages()[0],a.dataBind(),a.open(e.$element.get(0))}),utopiasoftware[utopiasoftware_app_namespace].controller.loginPageViewModel.forgotPasswordFormValidator.on('field:success',function(e){var a=$('#login-page #forgot-password-form').get(0).ej2_instances[e.$element.get(0)._utopiasoftware_validator_index];a.close()}),utopiasoftware[utopiasoftware_app_namespace].controller.loginPageViewModel.forgotPasswordFormValidator.on('form:success',utopiasoftware[utopiasoftware_app_namespace].controller.loginPageViewModel.forgotPasswordFormValidated),$('#login-page .login-page-form-container').on('scroll',function(){window.setTimeout(function(){switch($('#login-page #login-carousel').get(0).getActiveIndex()){case 0:$('#login-page #login-form ons-input').each(function(e,a){document.getElementById('login-form').ej2_instances[e].refresh(a)});break;case 1:$('#login-page #signup-form ons-input').each(function(e,a){document.getElementById('signup-form').ej2_instances[e].refresh(a)});break;case 2:$('#login-page #forgot-password-form ons-input').each(function(e,a){document.getElementById('forgot-password-form').ej2_instances[e].refresh(a)});}},0)});try{$('#login-form ons-input',t).each(function(e,a){a._utopiasoftware_validator_index=e,new ej.popups.Tooltip({cssClass:'utopiasoftware-ej2-validation-tooltip',position:'TopCenter',opensOn:'Custom'}).appendTo($('#login-page #login-form').get(0))}),$('#signup-form ons-input',t).each(function(e,a){a._utopiasoftware_validator_index=e,new ej.popups.Tooltip({cssClass:'utopiasoftware-ej2-validation-tooltip',position:'TopCenter',opensOn:'Custom'}).appendTo($('#login-page #signup-form').get(0))}),$('#forgot-password-form ons-input',t).each(function(e,a){a._utopiasoftware_validator_index=e,new ej.popups.Tooltip({cssClass:'utopiasoftware-ej2-validation-tooltip',position:'TopCenter',opensOn:'Custom'}).appendTo($('#login-page #forgot-password-form').get(0))}),new ej.buttons.Button({isToggle:!0,cssClass:'e-flat e-small e-round',iconCss:'zmdi zmdi-eye',iconPosition:'Left'}).appendTo($('#signup-password-view-button',t).get(0))}catch(e){}case 20:case'end':return e.stop();}},e,this)}));return function(){return e.apply(this,arguments)}}(),t=$(e.target);a()},pageShow:function e(){window.SoftInputMode.set('adjustPan'),window.addEventListener('keyboardDidShow',utopiasoftware[utopiasoftware_app_namespace].controller.loginPageViewModel.keyboardShownAdjustView)},pageHide:function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:window.removeEventListener('keyboardDidShow',utopiasoftware[utopiasoftware_app_namespace].controller.loginPageViewModel.keyboardShownAdjustView),$('#login-page #login-form').get(0).ej2_instances.forEach(function(e){e.close()}),$('#login-page #signup-form').get(0).ej2_instances.forEach(function(e){e.close()}),$('#login-page #forgot-password-form').get(0).ej2_instances.forEach(function(e){e.close()}),utopiasoftware[utopiasoftware_app_namespace].controller.loginPageViewModel.loginFormValidator.reset(),utopiasoftware[utopiasoftware_app_namespace].controller.loginPageViewModel.signupFormValidator.reset(),utopiasoftware[utopiasoftware_app_namespace].controller.loginPageViewModel.forgotPasswordFormValidator.reset();case 7:case'end':return e.stop();}},e,this)}));return function a(){return e.apply(this,arguments)}}(),pageDestroy:function e(){$('#login-page #login-form').get(0).ej2_instances.forEach(function(e){e.destroy()}),$('#login-page #signup-form').get(0).ej2_instances.forEach(function(e){e.destroy()}),$('#login-page #forgot-password-form').get(0).ej2_instances.forEach(function(e){e.destroy()}),$('#login-page #signup-password-view-button').get(0).ej2_instances[0].destroy(),utopiasoftware[utopiasoftware_app_namespace].controller.loginPageViewModel.loginFormValidator.destroy(),utopiasoftware[utopiasoftware_app_namespace].controller.loginPageViewModel.signupFormValidator.destroy(),utopiasoftware[utopiasoftware_app_namespace].controller.loginPageViewModel.forgotPasswordFormValidator.destroy()},backButtonClicked:function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt('return',$('#app-main-navigator').get(0).popPage());case 1:case'end':return e.stop();}},e,this)}));return function a(){return e.apply(this,arguments)}}(),segmentButtonClicked:function a(e){$('#login-page #login-carousel').get(0).setActiveIndex(e)},passwordVisibilityButtonClicked:function t(e,a){if(!$(e).hasClass('e-active')){$(document.getElementById(a)).attr('type','text');var o=e.ej2_instances[0];o.iconCss='zmdi zmdi-eye-off',o.dataBind()}else{$(document.getElementById(a)).attr('type','password');var s=e.ej2_instances[0];s.iconCss='zmdi zmdi-eye',s.dataBind()}},changeScreenCarouselPostChange:function a(e){switch(e.originalEvent.activeIndex){case 0:$('#login-page ons-carousel-item.second .login-segment button:nth-of-type(2) input').prop('checked',!0),$('#login-page ons-carousel-item.second .login-segment button:nth-of-type(1) input').prop('checked',!1),$('#login-page ons-carousel-item.third .login-segment button input').prop('checked',!1),$('#login-page ons-carousel-item.first .login-page-form-container').scrollTop(0);break;case 1:$('#login-page ons-carousel-item.first .login-segment button:nth-of-type(1) input').prop('checked',!0),$('#login-page ons-carousel-item.first .login-segment button:nth-of-type(2) input').prop('checked',!1),$('#login-page ons-carousel-item.third .login-segment button input').prop('checked',!1),$('#login-page ons-carousel-item.second .login-page-form-container').scrollTop(0);break;case 2:$('#login-page ons-carousel-item.first .login-segment button:nth-of-type(1) input').prop('checked',!0),$('#login-page ons-carousel-item.first .login-segment button:nth-of-type(2) input').prop('checked',!1),$('#login-page ons-carousel-item.second .login-segment button:nth-of-type(2) input').prop('checked',!0),$('#login-page ons-carousel-item.second .login-segment button:nth-of-type(1) input').prop('checked',!1),$('#login-page ons-carousel-item.third .login-page-form-container').scrollTop(0);}},hideTooltipsCarouselPostChange:function a(e){switch(e.originalEvent.lastActiveIndex){case 0:$('#login-page #login-form').get(0).ej2_instances.forEach(function(e){e.close()});break;case 1:$('#login-page #signup-form').get(0).ej2_instances.forEach(function(e){e.close()});break;case 2:$('#login-page #forgot-password-form').get(0).ej2_instances.forEach(function(e){e.close()});}},keyboardShownAdjustView:function o(e){var a=Math.floor,t=Math.ceil(e.keyboardHeight)+6e3;switch($('#login-page #login-carousel').get(0).getActiveIndex()){case 0:$('#login-page ons-carousel-item.first .login-page-form-container').css({"padding-bottom":t+'px'}),$('#login-page ons-carousel-item.first .login-page-form-container').scrollTop(a($(document.activeElement).closest('ons-input').position().top-30));break;case 1:$('#login-page ons-carousel-item.second .login-page-form-container').css({"padding-bottom":t+'px'}),$('#login-page ons-carousel-item.second .login-page-form-container').scrollTop(a($(document.activeElement).closest('ons-input').position().top-30));break;case 2:$('#login-page ons-carousel-item.third .login-page-form-container').css({"padding-bottom":t+'px'}),$('#login-page ons-carousel-item.third .login-page-form-container').scrollTop(a($(document.activeElement).closest('ons-input').position().top-30));}},signinButtonClicked:function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:utopiasoftware[utopiasoftware_app_namespace].controller.loginPageViewModel.loginFormValidator.whenValidate();case 1:case'end':return e.stop();}},e,this)}));return function a(){return e.apply(this,arguments)}}(),signupButtonClicked:function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:utopiasoftware[utopiasoftware_app_namespace].controller.loginPageViewModel.signupFormValidator.whenValidate();case 1:case'end':return e.stop();}},e,this)}));return function a(){return e.apply(this,arguments)}}(),forgotPasswordButtonClicked:function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:cordova.InAppBrowser.open(window.encodeURI('https://shopoakexclusive.com/my-account/lost-password/'),'_blank','location=yes,clearcache=yes,clearsessioncache=yes,closebuttoncolor=#ffffff,hardwareback=no,hidenavigationbuttons=yes,hideurlbar=yes,zoom=no,toolbarcolor=#3f51b5');case 1:case'end':return e.stop();}},e,this)}));return function a(){return e.apply(this,arguments)}}(),resetPasswordButtonClicked:function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:utopiasoftware[utopiasoftware_app_namespace].controller.loginPageViewModel.forgotPasswordFormValidator.whenValidate();case 1:case'end':return e.stop();}},e,this)}));return function a(){return e.apply(this,arguments)}}(),loginFormValidated:function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){var a,t,o,s,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(navigator.connection.type!==Connection.NONE){e.next=10;break}return $('.page-toast').get(0).ej2_instances[0].hide('All'),$('.timed-page-toast').get(0).ej2_instances[0].hide('All'),a=$('.timed-page-toast').get(0).ej2_instances[0],a.cssClass='error-ej2-toast',a.timeOut=3e3,a.content='Connect to the Internet to sign in',a.dataBind(),a.show(),e.abrupt('return');case 10:return $('#loader-modal-message').html('Completing Signin...'),e.next=13,$('#loader-modal').get(0).show();case 13:return t=[],o=$('#login-page #login-form #login-email').val().trim(),s=$('#login-page #login-form #login-password').val().trim(),t.push(Promise.resolve($.ajax({url:utopiasoftware[utopiasoftware_app_namespace].model.appBaseUrl+'/wp-json',type:'get',beforeSend:function a(e){e.setRequestHeader('Authorization','Basic '+Base64.encode(o+':'+s))},dataType:'json',timeout:24e4,processData:!1}))),t.push(Promise.resolve($.ajax({url:utopiasoftware[utopiasoftware_app_namespace].model.appBaseUrl+'/wp-json/wc/v3/customers',type:'get',beforeSend:function a(e){e.setRequestHeader('Authorization','Basic '+utopiasoftware[utopiasoftware_app_namespace].accessor)},dataType:'json',timeout:24e4,processData:!0,data:{email:o}}))),i=Promise.all(t),i.then(function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(a){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a[1][0].password=s,e.next=3,utopiasoftware[utopiasoftware_app_namespace].databaseOperations.saveData({_id:'user-details',docType:'USER_DETAILS',userDetails:a[1][0]},utopiasoftware[utopiasoftware_app_namespace].model.encryptedAppDatabase);case 3:return e.next=5,$('#loader-modal').get(0).hide();case 5:return e.next=7,utopiasoftware[utopiasoftware_app_namespace].controller.loginPageViewModel.backButtonClicked();case 7:$('.page-toast').get(0).ej2_instances[0].hide('All'),$('.timed-page-toast').get(0).ej2_instances[0].hide('All'),t=$('.timed-page-toast').get(0).ej2_instances[0],t.cssClass='success-ej2-toast',t.timeOut=3e3,t.content='User signin completed',t.dataBind(),t.show();case 15:case'end':return e.stop();}},e,this)}));return function(){return e.apply(this,arguments)}}()).catch(function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(a){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log('SIGN IN ERROR',a),a=JSON.parse(a.responseText),e.next=4,$('#loader-modal').get(0).hide();case 4:$('.page-toast').get(0).ej2_instances[0].hide('All'),$('.timed-page-toast').get(0).ej2_instances[0].hide('All'),t=$('.timed-page-toast').get(0).ej2_instances[0],t.cssClass='error-ej2-toast',t.timeOut=3e3,t.content='Invalid user email or password. User signin failed ',t.dataBind(),t.show();case 12:case'end':return e.stop();}},e,this)}));return function(){return e.apply(this,arguments)}}()),e.abrupt('return',i);case 21:case'end':return e.stop();}},e,this)}));return function a(){return e.apply(this,arguments)}}(),signupFormValidated:function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){var a,t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(navigator.connection.type!==Connection.NONE){e.next=10;break}return $('.page-toast').get(0).ej2_instances[0].hide('All'),$('.timed-page-toast').get(0).ej2_instances[0].hide('All'),a=$('.timed-page-toast').get(0).ej2_instances[0],a.cssClass='error-ej2-toast',a.timeOut=3e3,a.content='Connect to the Internet to sign up',a.dataBind(),a.show(),e.abrupt('return');case 10:return $('#loader-modal-message').html('Completing Signup...'),e.next=13,$('#loader-modal').get(0).show();case 13:return t=[],t.push(new Promise(function(e,a){Promise.resolve($.ajax({url:utopiasoftware[utopiasoftware_app_namespace].model.appBaseUrl+'/wp-json/wc/v3/customers',type:'post',contentType:'application/json',beforeSend:function a(e){e.setRequestHeader('Authorization','Basic '+utopiasoftware[utopiasoftware_app_namespace].accessor)},dataType:'json',timeout:24e4,processData:!1,data:JSON.stringify({email:$('#login-page #signup-form #signup-email').val().trim(),username:$('#login-page #signup-form #signup-email').val().trim(),password:$('#login-page #signup-form #signup-password').val().trim()})})).then(function(){var a=_asyncToGenerator(regeneratorRuntime.mark(function a(t){var o;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return t.password=$('#login-page #signup-form #signup-password').val().trim(),a.next=3,utopiasoftware[utopiasoftware_app_namespace].databaseOperations.saveData({_id:'user-details',docType:'USER_DETAILS',userDetails:t},utopiasoftware[utopiasoftware_app_namespace].model.encryptedAppDatabase);case 3:return a.next=5,$('#loader-modal').get(0).hide();case 5:return a.next=7,utopiasoftware[utopiasoftware_app_namespace].controller.loginPageViewModel.backButtonClicked();case 7:$('.page-toast').get(0).ej2_instances[0].hide('All'),$('.timed-page-toast').get(0).ej2_instances[0].hide('All'),o=$('.timed-page-toast').get(0).ej2_instances[0],o.cssClass='success-ej2-toast',o.timeOut=3e3,o.content='User signup completed',o.dataBind(),o.show(),e(t);case 16:case'end':return a.stop();}},a,this)}));return function(){return a.apply(this,arguments)}}()).catch(function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(t){var o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log('SIGN UP ERROR',t),t=JSON.parse(t.responseText),e.next=4,$('#loader-modal').get(0).hide();case 4:$('.page-toast').get(0).ej2_instances[0].hide('All'),$('.timed-page-toast').get(0).ej2_instances[0].hide('All'),o=$('.timed-page-toast').get(0).ej2_instances[0],o.cssClass='error-ej2-toast',o.timeOut=3e3,o.content='Error. '+(t.message||'User signup failed'),o.dataBind(),o.show(),a(t);case 13:case'end':return e.stop();}},e,this)}));return function(){return e.apply(this,arguments)}}())})),e.abrupt('return',Promise.all(t));case 16:case'end':return e.stop();}},e,this)}));return function a(){return e.apply(this,arguments)}}(),forgotPasswordFormValidated:function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case'end':return e.stop();}},e,this)}));return function a(){return e.apply(this,arguments)}}()},productsPageViewModel:{currentPage:0,pageSize:20,viewContentHeight:0,lastActiveNavTab:0,currentQueryParam:{status:'publish'},pageInit:function s(e){var a=Math.floor,t=function(){var s=_asyncToGenerator(regeneratorRuntime.mark(function s(){return regeneratorRuntime.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(ons.isReady()&&!1!==utopiasoftware[utopiasoftware_app_namespace].model.isAppReady){s.next=3;break}return setTimeout(t,500),s.abrupt('return');case 3:e.target.onDeviceBackButton=utopiasoftware[utopiasoftware_app_namespace].controller.productsPageViewModel.backButtonClicked,e.target.onInfiniteScroll=utopiasoftware[utopiasoftware_app_namespace].controller.productsPageViewModel.pageInfiniteScroll,$('#products-page-pull-hook',o).get(0).onAction=utopiasoftware[utopiasoftware_app_namespace].controller.productsPageViewModel.pagePullHookAction,$('#products-page-pull-hook',o).on('changestate',function(e){switch(e.originalEvent.state){case'initial':$('#products-page-pull-hook-fab',e.originalEvent.pullHook).html('<ons-icon icon="md-long-arrow-down" size="24px" style="color: #363E7C"></ons-icon>');break;case'preaction':$('#products-page-pull-hook-fab',e.originalEvent.pullHook).html('<ons-icon icon="md-long-arrow-up" size="24px" style="color: #363E7C"></ons-icon>');break;case'action':$('#products-page-pull-hook-fab',e.originalEvent.pullHook).html('<ons-progress-circular indeterminate modifier="pull-hook"></ons-progress-circular>');}}),utopiasoftware[utopiasoftware_app_namespace].controller.productsPageViewModel.viewContentHeight=a($('#products-page .page__content').height()),$('#products-page .page__content').on('scroll',function(){window.setTimeout(function(){var e=a($('#products-page .page__content').scrollTop()),t=100*(e/utopiasoftware[utopiasoftware_app_namespace].controller.productsPageViewModel.viewContentHeight);50<=t?$('#products-page #products-page-scroll-top-fab').css({transform:'scale(1)',display:'inline-block'}):$('#products-page #products-page-scroll-top-fab').css({transform:'scale(0)'})},0)}),$('#app-main-tabbar').on('prechange',function(e){4===e.originalEvent.index||(utopiasoftware[utopiasoftware_app_namespace].controller.productsPageViewModel.lastActiveNavTab=e.originalEvent.index)}),o.on('click','.e-card',function(e){utopiasoftware[utopiasoftware_app_namespace].controller.productsPageViewModel.productItemClicked(window.parseInt($(e.currentTarget).attr('data-product')),window.parseInt($(e.currentTarget).attr('data-page')))});try{}catch(e){}case 12:case'end':return s.stop();}},s,this)}));return function(){return s.apply(this,arguments)}}(),o=$(e.target);t()},pageShow:function a(e){$('#app-main-page ons-toolbar div.title-bar').html('Products'),$('#app-main-page .cart-count').html(utopiasoftware[utopiasoftware_app_namespace].model.cartCount),!1!==$('#app-main-navigator').get(0)._resetPageDisplay&&(e.target._allowInfinitePageScroll=!1,$('#products-page .page-preloader').css('display','block'),$('#products-page #products-contents-container').html(''),$('#products-page #products-page-scroll-top-fab').css({display:'none'})),window.SoftInputMode.set('adjustPan'),document.addEventListener('offline',utopiasoftware[utopiasoftware_app_namespace].controller.productsPageViewModel.deviceOfflineListener,!1),document.addEventListener('online',utopiasoftware[utopiasoftware_app_namespace].controller.productsPageViewModel.deviceOnlineListener,!1)},pageHide:function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(a){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a.target._allowInfinitePageScroll=!1,delete $('#app-main-navigator').get(0)._resetPageDisplay,document.removeEventListener('offline',utopiasoftware[utopiasoftware_app_namespace].controller.productsPageViewModel.deviceOfflineListener,!1),document.removeEventListener('online',utopiasoftware[utopiasoftware_app_namespace].controller.productsPageViewModel.deviceOnlineListener,!1),$('#products-page .page__content .infinite-load-container').remove();case 5:case'end':return e.stop();}},e,this)}));return function a(){return e.apply(this,arguments)}}(),pageDestroy:function e(){},backButtonClicked:function e(){$('#app-main-tabbar').get(0).setActiveTab(utopiasoftware[utopiasoftware_app_namespace].controller.productsPageViewModel.lastActiveNavTab)},deviceOfflineListener:function a(){var e=$('.page-toast').get(0).ej2_instances[0];e.hide('All'),e.cssClass='default-ej2-toast',e.content='No Internet connection. Connect to the Internet to see updated products',e.dataBind(),e.show()},deviceOnlineListener:function e(){$('.page-toast').get(0).ej2_instances[0].hide('All')},pagePullHookAction:function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){var a=0<arguments.length&&arguments[0]!==void 0?arguments[0]:function(){},t,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return $('#products-page #products-page-pull-hook').attr('disabled',!0),$('.page-toast').get(0).ej2_instances[0].hide('All'),e.prev=2,e.next=5,utopiasoftware[utopiasoftware_app_namespace].controller.productsPageViewModel.loadProducts(utopiasoftware[utopiasoftware_app_namespace].controller.productsPageViewModel.currentQueryParam,1);case 5:return t=e.sent,e.next=8,utopiasoftware[utopiasoftware_app_namespace].controller.productsPageViewModel.displayPageContent(t[0]);case 8:e.next=17;break;case 10:e.prev=10,e.t0=e['catch'](2),o=$('.page-toast').get(0).ej2_instances[0],o.cssClass='error-ej2-toast',o.content='Sorry, an error occurred. Refresh to try again',o.dataBind(),o.show();case 17:return e.prev=17,$('#products-page .page-preloader').css('display','none'),$('#products-page #products-page-pull-hook').removeAttr('disabled'),a(),e.finish(17);case 22:case'end':return e.stop();}},e,this,[[2,10,17,22]])}));return function a(){return e.apply(this,arguments)}}(),pageInfiniteScroll:function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){var a=0<arguments.length&&arguments[0]!==void 0?arguments[0]:function(){},t,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!1!==$('#products-page').get(0)._allowInfinitePageScroll){e.next=3;break}return a(),e.abrupt('return');case 3:return $('#products-page .page__content').append('<div class="infinite-load-container" style="text-align: center">\n                        <ons-progress-circular indeterminate modifier="pull-hook"></ons-progress-circular>\n                    </div>'),$('.page-toast').get(0).ej2_instances[0].hide('All'),t=[],e.prev=6,e.next=9,utopiasoftware[utopiasoftware_app_namespace].controller.productsPageViewModel.loadProducts(utopiasoftware[utopiasoftware_app_namespace].controller.productsPageViewModel.currentQueryParam,utopiasoftware[utopiasoftware_app_namespace].controller.productsPageViewModel.currentPage+1);case 9:return t=e.sent,e.next=12,utopiasoftware[utopiasoftware_app_namespace].controller.productsPageViewModel.displayPageContent(t[0],!0,!1);case 12:e.next=21;break;case 14:e.prev=14,e.t0=e['catch'](6),o=$('.page-toast').get(0).ej2_instances[0],o.cssClass='error-ej2-toast',o.content='Sorry, an error occurred. Refresh to try again',o.dataBind(),o.show();case 21:return e.prev=21,t&&0<t[0].length?$('#products-page .page__content .infinite-load-container').remove():$('#products-page .page__content .infinite-load-container').css({visibility:'hidden'}),a(),e.finish(21);case 25:case'end':return e.stop();}},e,this,[[6,14,21,25]])}));return function a(){return e.apply(this,arguments)}}(),loadProducts:function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(a){var t=1<arguments.length&&arguments[1]!==void 0?arguments[1]:a.page||utopiasoftware[utopiasoftware_app_namespace].controller.productsPageViewModel.currentPage+1,o=2<arguments.length&&arguments[2]!==void 0?arguments[2]:a.per_page||utopiasoftware[utopiasoftware_app_namespace].controller.productsPageViewModel.pageSize,s,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a.page=t,a.per_page=o,s=[],navigator.connection.type===Connection.NONE?(i=$('.page-toast').get(0).ej2_instances[0],i.hide('All'),i.cssClass='default-ej2-toast',i.content='No Internet connection. Pull down to refresh and see updated products',i.dataBind(),i.show(),s.push(new Promise(function(e,o){var s=(''+t).padStart(7,'0')+'products';Promise.resolve(utopiasoftware[utopiasoftware_app_namespace].databaseOperations.loadData(s,utopiasoftware[utopiasoftware_app_namespace].model.appDatabase)).then(function(t){utopiasoftware[utopiasoftware_app_namespace].controller.productsPageViewModel.currentPage=a.page,e(t.products)}).catch(function(e){o(e)})}))):s.push(new Promise(function(e,o){Promise.resolve($.ajax({url:utopiasoftware[utopiasoftware_app_namespace].model.appBaseUrl+'/wp-json/wc/v3/products',type:'get',beforeSend:function a(e){e.setRequestHeader('Authorization','Basic '+utopiasoftware[utopiasoftware_app_namespace].accessor)},dataType:'json',timeout:24e4,processData:!0,data:a})).then(function(o){if(0<o.length){var s=(''+t).padStart(7,'0')+'products';utopiasoftware[utopiasoftware_app_namespace].databaseOperations.saveData({_id:s,docType:'PRODUCTS',products:o},utopiasoftware[utopiasoftware_app_namespace].model.appDatabase),utopiasoftware[utopiasoftware_app_namespace].controller.productsPageViewModel.currentPage=a.page,utopiasoftware[utopiasoftware_app_namespace].controller.productsPageViewModel.currentQueryParam=a}e(o)}).catch(function(e){o(e)})})),e.abrupt('return',Promise.all(s));case 5:case'end':return e.stop();}},e,this)}));return function a(){return e.apply(this,arguments)}}(),displayPageContent:function(){var e=Math.floor,a=Math.ceil,t=Math.abs,o=_asyncToGenerator(regeneratorRuntime.mark(function o(s){var i=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],n=!(2<arguments.length&&void 0!==arguments[2])||arguments[2],p;return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return p=new Promise(function(o){var p='';if(0>=s.length)o(s.length);else{for(var r=0;r<s.length;r++)s[r].regular_price&&''!=s[r].regular_price||(s[r].regular_price='0.00'),p+='<div class="col-xs-4" ',p+=0==(r+1)%3?'style="border-bottom: 1px lightgray solid">':'style="border-right: 1px lightgray solid; border-bottom: 1px lightgray solid">',p+='\n                        <ons-ripple background="rgba(63, 81, 181, 0.3)"></ons-ripple>\n                        <div class="e-card" \n                        data-product="'+r+'" \n                        data-page="'+utopiasoftware[utopiasoftware_app_namespace].controller.productsPageViewModel.currentPage+'">\n                            <div class="e-card-image" style="min-height: 100px; \n                            background-image: url(\''+s[r].images[0].src+'\');">\n                            '+(!0===s[r].on_sale?'\n                            <span class="e-badge e-badge-danger" style="float: right; clear: both; \n                                                    background-color: transparent; color: #d64113;\n                                                    border: 1px #d64113 solid; font-size: 0.6em;">\n                                                    '+a(100*(t(kendo.parseFloat(s[r].price)-kendo.parseFloat(s[r].regular_price))/kendo.parseFloat('0.00'===s[r].regular_price?s[r].price:s[r].regular_price)))+'% OFF\n                             </span>':'')+'\n                            </div>\n                            <div class="e-card-header">\n                                <div class="e-card-header-caption"  style="padding-left: 3px; padding-right: 5px">\n                                    <div class="e-card-sub-title" style="color: #000000; font-size: 14px; text-align: center; text-transform: capitalize">\n                                        '+s[r].name+'\n                                    </div>\n                        <div style="color: gold; font-size: 0.6em !important; white-space: nowrap !important; \n                        text-overflow: ellipsis; overflow: hidden;">\n                        '+(0<e(kendo.parseFloat(s[r].average_rating))?'<ons-icon icon="md-star" fixed-width></ons-icon>'.repeat(e(kendo.parseFloat(s[r].average_rating))):'<ons-icon icon="md-star-outline" style="color: lightgray" fixed-width></ons-icon>'.repeat(5))+'\n                            <span style="display: inline-block; color: gray;">\n                            '+(0<e(kendo.parseFloat(s[r].average_rating))?'('+s[r].rating_count+')':'')+'\n                           </span>\n                        </div>\n                        <div class="e-card-sub-title" style="text-align: left;">&#x20a6;'+kendo.toString(kendo.parseFloat(s[r].price),'n2')+'</div>\n                        <div class="e-card-sub-title" style="text-align: left; text-decoration: line-through; \n                        '+(!0===s[r].on_sale?'visibility: visible':'visibility: hidden')+'">&#x20a6;'+kendo.toString(kendo.parseFloat(s[r].regular_price),'n2')+'</div>\n                        </div>\n                        </div>\n                        </div>\n                        </div>';!0===n?$('#products-page #products-contents-container').html(p):!0===i?$('#products-page #products-contents-container').append(p):$('#products-page #products-contents-container').prepend(p),$('#products-page').get(0)._allowInfinitePageScroll=!0,o(s.length)}}),o.abrupt('return',p);case 2:case'end':return o.stop();}},o,this)}));return function e(){return o.apply(this,arguments)}}(),scrollPageToTop:function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:window.setTimeout(function(){$('#products-page .page__content').animate({scrollTop:0},400)},0);case 1:case'end':return e.stop();}},e,this)}));return function a(){return e.apply(this,arguments)}}(),productItemClicked:function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(a,t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:window.setTimeout(_asyncToGenerator(regeneratorRuntime.mark(function e(){var o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,utopiasoftware[utopiasoftware_app_namespace].databaseOperations.loadData((''+t).padStart(7,'0')+'products',utopiasoftware[utopiasoftware_app_namespace].model.appDatabase);case 3:o=e.sent.products,$('#app-main-navigator').get(0).pushPage('product-details-page.html',{animation:'lift',data:{product:o[a]}}),e.next=9;break;case 7:e.prev=7,e.t0=e['catch'](0);case 9:case'end':return e.stop();}},e,this,[[0,7]])})),0);case 1:case'end':return e.stop();}},e,this)}));return function a(){return e.apply(this,arguments)}}()},productDetailsPageViewModel:{currentProductDetails:null,currentProductVariationIndex:-1,productVariationsArray:[],pageInit:function o(e){var a=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){var o,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(ons.isReady()&&!1!==utopiasoftware[utopiasoftware_app_namespace].model.isAppReady){e.next=3;break}return setTimeout(a,500),e.abrupt('return');case 3:return $('#app-main-navigator').get(0).topPage.onDeviceBackButton=utopiasoftware[utopiasoftware_app_namespace].controller.productDetailsPageViewModel.backButtonClicked,$('#product-details-page-pull-hook',t).get(0).onAction=utopiasoftware[utopiasoftware_app_namespace].controller.productDetailsPageViewModel.pagePullHookAction,$('#product-details-page-pull-hook',t).on('changestate',function(e){switch(e.originalEvent.state){case'initial':$('#product-details-page-pull-hook-fab',e.originalEvent.pullHook).html('<ons-icon icon="md-long-arrow-down" size="24px" style="color: #363E7C"></ons-icon>');break;case'preaction':$('#product-details-page-pull-hook-fab',e.originalEvent.pullHook).html('<ons-icon icon="md-long-arrow-up" size="24px" style="color: #363E7C"></ons-icon>');break;case'action':$('#product-details-page-pull-hook-fab',e.originalEvent.pullHook).html('<ons-progress-circular indeterminate modifier="pull-hook"></ons-progress-circular>');}}),e.prev=6,new ej.inputs.NumericTextBox({cssClass:'product-details-quantity-class',currency:null,decimals:0,floatLabelType:'Auto',format:'n',showSpinButton:!1,min:1,max:10,placeholder:'Pick Quantity',step:1,strictMode:!0,value:1}).appendTo('#product-details-quantity'),new ej.splitbuttons.ProgressButton({cssClass:'e-hide-spinner',duration:36000000}).appendTo('#product-details-add-to-cart'),new ej.buttons.Button({}).appendTo('#product-details-customise-product'),new ej.buttons.Button({cssClass:'e-flat e-small',iconCss:'zmdi zmdi-star-outline',iconPosition:'Left'}).appendTo('#product-details-review'),new ej.buttons.Button({cssClass:'e-flat e-small',iconCss:'zmdi zmdi-share',iconPosition:'Left'}).appendTo('#product-details-share'),$('#rate-product-modal #rate-product-rater-widget').rateYo({starWidth:'20px',normalFill:'#808080',ratedFill:'#F39C12',numStars:5,precision:0,rating:0,fullStar:!0,spacing:'10px',onChange:function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:$('#rate-product-modal #rate-product-comment').removeAttr('disabled'),$('#rate-product-modal #rate-product-rate-button').removeAttr('disabled');case 2:case'end':return e.stop();}},e,this)}));return function a(){return e.apply(this,arguments)}}()}),utopiasoftware[utopiasoftware_app_namespace].controller.productDetailsPageViewModel.loadProductVariations(),e.next=16,utopiasoftware[utopiasoftware_app_namespace].controller.productDetailsPageViewModel.loadProduct();case 16:return o=e.sent,e.next=19,utopiasoftware[utopiasoftware_app_namespace].controller.productDetailsPageViewModel.displayProductDetails(o[0]);case 19:$('#product-details-page #product-details-add-to-cart').removeAttr('disabled'),e.next=30;break;case 22:e.prev=22,e.t0=e['catch'](6),$('.page-toast').get(0).ej2_instances[0].hide('All'),s=$('.page-toast').get(0).ej2_instances[0],s.cssClass='error-ej2-toast',s.content='Sorry, an error occurred.'+(navigator.connection.type===Connection.NONE?' Connect to the Internet.':'')+' Pull down to refresh and try again',s.dataBind(),s.show();case 30:return e.prev=30,$('#product-details-page .page-preloader').css('display','none'),e.finish(30);case 33:case'end':return e.stop();}},e,this,[[6,22,30,33]])}));return function(){return e.apply(this,arguments)}}(),t=$(e.target);a()},pageShow:function e(){$('#product-details-page .cart-count').html(utopiasoftware[utopiasoftware_app_namespace].model.cartCount),window.SoftInputMode.set('adjustResize')},pageHide:function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case'end':return e.stop();}},e,this)}));return function a(){return e.apply(this,arguments)}}(),pageDestroy:function e(){utopiasoftware[utopiasoftware_app_namespace].controller.productDetailsPageViewModel.currentProductDetails=null,utopiasoftware[utopiasoftware_app_namespace].controller.productDetailsPageViewModel.currentProductVariationIndex=-1,utopiasoftware[utopiasoftware_app_namespace].controller.productDetailsPageViewModel.productVariationsArray=[],$('#product-details-quantity').get(0).ej2_instances[0].destroy(),$('#product-details-review').get(0).ej2_instances[0].destroy(),$('#product-details-share').get(0).ej2_instances[0].destroy(),$('#product-details-add-to-cart').get(0).ej2_instances[0].destroy(),$('#product-details-customise-product').get(0).ej2_instances[0].destroy(),$('#product-details-page .product-details-variation-option').each(function(e,a){a.ej2_instances[0].destroy()}),$('#rate-product-modal #rate-product-rater-widget').rateYo('destroy'),$('#rate-product-modal #rate-product-comment').val(''),$('#rate-product-modal #rate-product-comment').attr('disabled',!0)},backButtonClicked:function a(){var e=$('#app-main-navigator').get(0).pages;if(1<e.length){var t=$(e[e.length-2]).get(0);switch(t.id){case'app-main-page':4===$('#app-main-tabbar').get(0).getActiveTabIndex()?($('#app-main-navigator').get(0)._resetPageDisplay=!1,$('#products-page').get(0)._allowInfinitePageScroll=!0,$('#app-main-navigator').get(0).popPage()):$('#app-main-navigator').get(0).popPage();break;default:$('#app-main-navigator').get(0).popPage();}}else;},shareButtonClicked:function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){var a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a={},a.message='check out this #ShopOakExclusive product',a.chooserTitle='share product with...',window.setTimeout(function(){if(-1!==utopiasoftware[utopiasoftware_app_namespace].controller.productDetailsPageViewModel.currentProductVariationIndex){var e=utopiasoftware[utopiasoftware_app_namespace].controller.productDetailsPageViewModel.currentProductVariationIndex,t=utopiasoftware[utopiasoftware_app_namespace].controller.productDetailsPageViewModel.productVariationsArray[e];a.url=t.permalink,a.files=[t.image&&''!==t.image?t.image.src:utopiasoftware[utopiasoftware_app_namespace].controller.productDetailsPageViewModel.currentProductDetails.images[0].src]}else a.url=utopiasoftware[utopiasoftware_app_namespace].controller.productDetailsPageViewModel.currentProductDetails.permalink,a.files=[utopiasoftware[utopiasoftware_app_namespace].controller.productDetailsPageViewModel.currentProductDetails.images[0].src];cordova.plugins.clipboard.copy(a.message+' | '+a.url,function(){window.plugins.toast.showWithOptions({message:'shared message copied to clipboard',duration:3e3,position:'center',styling:{cornerRadius:0,opacity:1,backgroundColor:'#3F51B5',textColor:'#FFFFFF',textSize:14}})},function(){}),window.plugins.socialsharing.shareWithOptions(a,function(){},function(){})},0);case 4:case'end':return e.stop();}},e,this)}));return function a(){return e.apply(this,arguments)}}(),rateButtonClicked:function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){var a,t,o,s,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=null,$('#product-details-page .page-preloader').css('display','block'),e.prev=2,e.next=5,utopiasoftware[utopiasoftware_app_namespace].databaseOperations.loadData('user-details',utopiasoftware[utopiasoftware_app_namespace].model.encryptedAppDatabase);case 5:a=e.sent.userDetails,e.next=20;break;case 8:return e.prev=8,e.t0=e['catch'](2),$('.page-toast').get(0).ej2_instances[0].hide('All'),$('.timed-page-toast').get(0).ej2_instances[0].hide('All'),t=$('.timed-page-toast').get(0).ej2_instances[0],t.cssClass='error-ej2-toast',t.timeOut=3500,t.content='Please sign in to rate this product',t.dataBind(),t.show(),$('#product-details-page .page-preloader').css('display','none'),e.abrupt('return');case 20:if(navigator.connection.type!==Connection.NONE){e.next=31;break}return $('.page-toast').get(0).ej2_instances[0].hide('All'),$('.timed-page-toast').get(0).ej2_instances[0].hide('All'),o=$('.timed-page-toast').get(0).ej2_instances[0],o.cssClass='error-ej2-toast',o.timeOut=3e3,o.content='Connect to the Internet to rate this product',o.dataBind(),o.show(),$('#product-details-page .page-preloader').css('display','none'),e.abrupt('return');case 31:return e.prev=31,$('#product-details-page .modal').css('display','table'),e.next=35,Promise.resolve($.ajax({url:utopiasoftware[utopiasoftware_app_namespace].model.appBaseUrl+'/wp-json/wc/v3/orders',type:'get',beforeSend:function a(e){e.setRequestHeader('Authorization','Basic '+utopiasoftware[utopiasoftware_app_namespace].accessor)},dataType:'json',timeout:24e4,processData:!0,data:{status:'completed',customer:a.id,product:utopiasoftware[utopiasoftware_app_namespace].controller.productDetailsPageViewModel.currentProductDetails.id}}));case 35:if(s=e.sent,0!==s.length){e.next=38;break}throw'error';case 38:e.next=51;break;case 40:return e.prev=40,e.t1=e['catch'](31),$('.page-toast').get(0).ej2_instances[0].hide('All'),$('.timed-page-toast').get(0).ej2_instances[0].hide('All'),i=$('.timed-page-toast').get(0).ej2_instances[0],i.cssClass='error-ej2-toast',i.timeOut=3500,i.content='Sorry, you need to have purchased this product before it can be rated',i.dataBind(),i.show(),e.abrupt('return');case 51:return e.prev=51,$('#product-details-page .page-preloader').css('display','none'),$('#product-details-page .modal').css('display','none'),e.finish(51);case 55:return $('#rate-product-modal #rate-product-cancel-button').get(0).onclick=_asyncToGenerator(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$('#rate-product-modal').get(0).hide();case 2:case'end':return e.stop();}},e,this)})),$('#rate-product-modal #rate-product-rate-button').get(0).onclick=_asyncToGenerator(regeneratorRuntime.mark(function e(){var t,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,$('#rate-product-modal').get(0).hide();case 3:return $('#loader-modal-message').html('Sending User Review...'),e.next=6,$('#loader-modal').get(0).show();case 6:return e.next=8,Promise.resolve($.ajax({url:utopiasoftware[utopiasoftware_app_namespace].model.appBaseUrl+'/wp-json/wc/v3/products/reviews',type:'post',contentType:'application/json',beforeSend:function a(e){e.setRequestHeader('Authorization','Basic '+utopiasoftware[utopiasoftware_app_namespace].accessor)},dataType:'json',timeout:24e4,processData:!1,data:JSON.stringify({product_id:utopiasoftware[utopiasoftware_app_namespace].controller.productDetailsPageViewModel.currentProductDetails.id,status:'hold',reviewer:a.first_name,reviewer_email:a.email,review:$('#rate-product-modal #rate-product-comment').val().trim(),rating:$('#rate-product-modal #rate-product-rater-widget').rateYo('rating'),verified:!0})}));case 8:return $('#rate-product-modal #rate-product-rater-widget').rateYo('rating',0),$('#rate-product-modal #rate-product-comment').val(''),$('#rate-product-modal #rate-product-comment').attr('disabled',!0),e.next=13,$('#loader-modal').get(0).hide();case 13:$('.page-toast').get(0).ej2_instances[0].hide('All'),$('.timed-page-toast').get(0).ej2_instances[0].hide('All'),t=$('.timed-page-toast').get(0).ej2_instances[0],t.cssClass='success-ej2-toast',t.timeOut=3500,t.content='Thank you. Your product review has been received',t.dataBind(),t.show(),e.next=37;break;case 23:return e.prev=23,e.t0=e['catch'](0),e.next=27,$('#loader-modal').get(0).hide();case 27:return e.next=29,$('#rate-product-modal').get(0).show();case 29:$('.page-toast').get(0).ej2_instances[0].hide('All'),$('.timed-page-toast').get(0).ej2_instances[0].hide('All'),o=$('.timed-page-toast').get(0).ej2_instances[0],o.cssClass='error-ej2-toast',o.timeOut=3500,o.content='Error. Your product review could not be sent. Please retry',o.dataBind(),o.show();case 37:return e.prev=37,e.finish(37);case 39:return e.next=41,$('#rate-product-modal').get(0).hide();case 41:case'end':return e.stop();}},e,this,[[0,23,37,39]])})),e.next=59,$('#rate-product-modal').get(0).show();case 59:case'end':return e.stop();}},e,this,[[2,8],[31,40,51,55]])}));return function a(){return e.apply(this,arguments)}}(),pagePullHookAction:function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){var a=0<arguments.length&&arguments[0]!==void 0?arguments[0]:function(){},t,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return $('#product-details-page #product-details-page-pull-hook').attr('disabled',!0),$('.page-toast').get(0).ej2_instances[0].hide('All'),$('#product-details-page #product-details-add-to-cart').attr('disabled',!0),$('#product-details-page #product-details-add-to-cart').get(0).ej2_instances[0].cssClass='e-hide-spinner',$('#product-details-page #product-details-add-to-cart').get(0).ej2_instances[0].dataBind(),$('#product-details-page #product-details-add-to-cart').get(0).ej2_instances[0].stop(),e.prev=6,utopiasoftware[utopiasoftware_app_namespace].controller.productDetailsPageViewModel.loadProductVariations(),e.next=10,utopiasoftware[utopiasoftware_app_namespace].controller.productDetailsPageViewModel.loadProduct();case 10:return t=e.sent,e.next=13,utopiasoftware[utopiasoftware_app_namespace].controller.productDetailsPageViewModel.displayProductDetails(t[0]);case 13:e.next=22;break;case 15:e.prev=15,e.t0=e['catch'](6),o=$('.page-toast').get(0).ej2_instances[0],o.cssClass='error-ej2-toast',o.content='Sorry, an error occurred. Refresh to try again',o.dataBind(),o.show();case 22:return e.prev=22,$('#product-details-page #product-details-page-pull-hook').removeAttr('disabled'),$('#product-details-page #product-details-add-to-cart').removeAttr('disabled'),a(),e.finish(22);case 27:case'end':return e.stop();}},e,this,[[6,15,22,27]])}));return function a(){return e.apply(this,arguments)}}(),loadProduct:function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){var a,t,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=[],navigator.connection.type===Connection.NONE&&($('.page-toast').get(0).ej2_instances[0].hide('All'),$('.timed-page-toast').get(0).ej2_instances[0].hide('All'),t=$('.timed-page-toast').get(0).ej2_instances[0],t.cssClass='default-ej2-toast',t.timeOut=3e3,t.content='Connect to the Internet to see updated product details',t.dataBind(),t.show()),$('#app-main-navigator').get(0).topPage.data.product?(o=$('#app-main-navigator').get(0).topPage.data.product,(!o.regular_price||''==o.regular_price)&&(o.regular_price='0.00'),utopiasoftware[utopiasoftware_app_namespace].controller.productDetailsPageViewModel.currentProductDetails=o,a.push(Promise.resolve(o))):a.push(new Promise(function(e,a){Promise.resolve($.ajax({url:utopiasoftware[utopiasoftware_app_namespace].model.appBaseUrl+('/wp-json/wc/v3/products/'+jQuery('#app-main-navigator').get(0).topPage.data.productId),type:'get',beforeSend:function a(e){e.setRequestHeader('Authorization','Basic '+utopiasoftware[utopiasoftware_app_namespace].accessor)},dataType:'json',timeout:24e4,processData:!0})).then(function(a){a.regular_price&&''!=a.regular_price||(a.regular_price='0.00'),utopiasoftware[utopiasoftware_app_namespace].controller.productDetailsPageViewModel.currentProductDetails=a,e(a)}).catch(function(e){a(e)})})),e.abrupt('return',Promise.all(a));case 4:case'end':return e.stop();}},e,this)}));return function a(){return e.apply(this,arguments)}}(),loadProductVariations:function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){var a,t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=[],t=null,t=$('#app-main-navigator').get(0).topPage.data.product?$('#app-main-navigator').get(0).topPage.data.product.id:jQuery('#app-main-navigator').get(0).topPage.data.productId,a.push(new Promise(function(e,a){Promise.resolve($.ajax({url:utopiasoftware[utopiasoftware_app_namespace].model.appBaseUrl+('/wp-json/wc/v3/products/'+t+'/variations'),type:'get',beforeSend:function a(e){e.setRequestHeader('Authorization','Basic '+utopiasoftware[utopiasoftware_app_namespace].accessor)},dataType:'json',timeout:24e4,processData:!0,data:{page:1,per_page:99,status:'publish'}})).then(function(a){a=a.map(function(e){return e._variationValue=e.attributes.map(function(e){return e.option}).join(''),e}),utopiasoftware[utopiasoftware_app_namespace].controller.productDetailsPageViewModel.productVariationsArray=a,e(a)}).catch(function(e){a(e)})})),e.abrupt('return',Promise.all(a));case 5:case'end':return e.stop();}},e,this)}));return function a(){return e.apply(this,arguments)}}(),displayProductDetails:function(){var e=Math.floor,a=Math.ceil,t=Math.abs,o=_asyncToGenerator(regeneratorRuntime.mark(function o(s){var i,n;return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:for($('#product-details-page .e-card-image').css('background-image','url("'+s.images[0].src+'")'),!0===s.on_sale&&$('#product-details-page .e-card-image').html('\n                <span class="e-badge e-badge-danger" style="float: right; clear: both; \n                                                    background-color: transparent; color: #d64113;\n                                                    border: 1px #d64113 solid; font-size: 0.6em;">\n                                                    '+a(100*(t(kendo.parseFloat(s.price)-kendo.parseFloat(s.regular_price))/kendo.parseFloat('0.00'===s.regular_price?s.price:s.regular_price)))+'% OFF\n                 </span>'),$('#product-details-page .e-card-title').html(''+s.name),$('#product-details-page .product-details-price').html('&#x20a6;'+kendo.toString(kendo.parseFloat(s.price),'n2')),!0===s.on_sale?($('#product-details-page .product-details-regular-price').html('&#x20a6;'+kendo.toString(kendo.parseFloat(s.regular_price),'n2')),$('#product-details-page .product-details-regular-price').css('visibility','visible'),$('#product-details-quantity').get(0).ej2_instances[0].cssClass='product-details-quantity-class sales',$('#product-details-quantity').get(0).ej2_instances[0].dataBind()):($('#product-details-page .product-details-regular-price').css('visibility','collapse'),$('#product-details-quantity').get(0).ej2_instances[0].cssClass='product-details-quantity-class',$('#product-details-quantity').get(0).ej2_instances[0].dataBind()),$('#product-details-quantity').get(0).ej2_instances[0].value=1,$('#product-details-quantity').get(0).ej2_instances[0].dataBind(),$('#product-details-page .product-details-description').html(''+s.short_description),$('#product-details-page .product-details-variation-option').each(function(e,a){a.ej2_instances[0].destroy()}),$('#product-details-page .product-details-variations').removeClass('expandable-content'),i='',n=0;n<s.attributes.length;n++)i+='<div class="col-xs-4" style="padding-right: 5px; padding-left: 5px;">\n                    <select name="'+s.attributes[n].name+'" class="product-details-variation-option">\n                        '+s.attributes[n].options.map(function(e){return'<option value="'+e+'">'+e+'</option>'}).join('')+'\n                    </select>\n                </div>';$('#product-details-page .product-details-variations').html(i),$('#product-details-page .product-details-variation-option').each(function(e,a){0<s.default_attributes.length&&$('option[value="'+s.default_attributes[e].option+'"]',a).attr('selected',!0),new ej.dropdowns.DropDownList({cssClass:'product-details-variation-class',placeholder:s.attributes[e].name,floatLabelType:'Always',change:function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt('return',new Promise(function(e){window.setTimeout(_asyncToGenerator(regeneratorRuntime.mark(function a(){var t,o,s;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:t='',$('#product-details-page .product-details-variation-option').each(function(e,a){t+=a.ej2_instances[0].value}),o=utopiasoftware[utopiasoftware_app_namespace].controller.productDetailsPageViewModel.productVariationsArray.findIndex(function(e){return t===e._variationValue}),utopiasoftware[utopiasoftware_app_namespace].controller.productDetailsPageViewModel.currentProductVariationIndex=o,-1!==utopiasoftware[utopiasoftware_app_namespace].controller.productDetailsPageViewModel.currentProductVariationIndex&&(s=utopiasoftware[utopiasoftware_app_namespace].controller.productDetailsPageViewModel.productVariationsArray[o],s.image&&''!==s.image&&$('#product-details-page .e-card-image').css('background-image','url("'+s.image.src+'")'),s.price&&''!==s.price&&$('#product-details-page .product-details-price').html('&#x20a6;'+kendo.toString(kendo.parseFloat(s.price),'n2'))),e();case 6:case'end':return a.stop();}},a,this)})),0)}));case 1:case'end':return e.stop();}},e,this)}));return function a(){return e.apply(this,arguments)}}()}).appendTo(a)}),$('#product-details-page .product-details-variations').addClass('expandable-content'),$('#product-details-page .product-details-rating').html('\n            '+(0<e(kendo.parseFloat(s.average_rating))?'<ons-icon icon="md-star" fixed-width></ons-icon>'.repeat(e(kendo.parseFloat(s.average_rating))):'<ons-icon icon="md-star-outline" style="color: lightgray" fixed-width></ons-icon>'.repeat(5))+'\n                <span style="display: inline-block; color: gray;">\n                '+(0<e(kendo.parseFloat(s.average_rating))?'('+s.rating_count+')':'')+'\n                </span>\n            '),$('#product-details-page .product-details-more-description').html('\n            '+s.description),$('#product-details-page .product-details-dimensions').html('\n            <span class="list-item__subtitle" style="display: block">length - '+(s.dimensions.length&&''!=s.dimensions.length?''+s.dimensions.length:'(Not Available)')+'</span>\n            <span class="list-item__subtitle" style="display: block">width - '+(s.dimensions.width&&''!=s.dimensions.width?''+s.dimensions.width:'(Not Available)')+'</span>\n            <span class="list-item__subtitle" style="display: block">height - '+(s.dimensions.height&&''!=s.dimensions.height?''+s.dimensions.height:'(Not Available)')+'</span>'),$('#product-details-page .product-details-weight').html(''+(s.weight&&''!=s.weight?''+s.weight:'(Not Available)'));case 19:case'end':return o.stop();}},o,this)}));return function e(){return o.apply(this,arguments)}}(),customiseButtonClicked:function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){var a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(navigator.connection.type!==Connection.NONE){e.next=10;break}return $('.page-toast').get(0).ej2_instances[0].hide('All'),$('.timed-page-toast').get(0).ej2_instances[0].hide('All'),a=$('.timed-page-toast').get(0).ej2_instances[0],a.cssClass='error-ej2-toast',a.timeOut=3500,a.content='Please connect to the Internet to customise product',a.dataBind(),a.show(),e.abrupt('return');case 10:window.setTimeout(_asyncToGenerator(regeneratorRuntime.mark(function e(){var a,t,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a='',-1===utopiasoftware[utopiasoftware_app_namespace].controller.productDetailsPageViewModel.currentProductVariationIndex?a=utopiasoftware[utopiasoftware_app_namespace].controller.productDetailsPageViewModel.currentProductDetails.permalink:(t=utopiasoftware[utopiasoftware_app_namespace].controller.productDetailsPageViewModel.currentProductVariationIndex,o=utopiasoftware[utopiasoftware_app_namespace].controller.productDetailsPageViewModel.productVariationsArray[t],a=o.permalink),e.next=4,$('#app-main-navigator').get(0).pushPage('customise-product-page.html');case 4:return e.next=6,utopiasoftware[utopiasoftware_app_namespace].controller.customiseProductPageViewModel.loadProductCustomisation(a);case 6:case'end':return e.stop();}},e,this)})),0);case 11:case'end':return e.stop();}},e,this)}));return function a(){return e.apply(this,arguments)}}(),addToCartButtonClicked:function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:$('#product-details-page #product-details-add-to-cart').attr('disabled',!0),$('#product-details-page #product-details-add-to-cart').get(0).ej2_instances[0].cssClass='',$('#product-details-page #product-details-add-to-cart').get(0).ej2_instances[0].dataBind(),$('#product-details-page #product-details-add-to-cart').get(0).ej2_instances[0].start(),window.setTimeout(_asyncToGenerator(regeneratorRuntime.mark(function e(){var a,t,o,s,i,n,p,r,c,l,d,g,u,m,h,_;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=[],t={cartData:{}},e.prev=2,e.next=5,utopiasoftware[utopiasoftware_app_namespace].databaseOperations.loadData('user-cart',utopiasoftware[utopiasoftware_app_namespace].model.appDatabase);case 5:a=e.sent.cart,e.next=10;break;case 8:e.prev=8,e.t0=e['catch'](2);case 10:if(-1===utopiasoftware[utopiasoftware_app_namespace].controller.productDetailsPageViewModel.currentProductVariationIndex){e.next=36;break}for(o=utopiasoftware[utopiasoftware_app_namespace].controller.productDetailsPageViewModel.currentProductVariationIndex,s=utopiasoftware[utopiasoftware_app_namespace].controller.productDetailsPageViewModel.productVariationsArray[o],t.cartData.variation_id=s.id,i=new URLSearchParams(s.permalink.split('?')[1]),t.cartData.variation={},n=!0,p=!1,r=void 0,e.prev=19,c=i[Symbol.iterator]();!(n=(l=c.next()).done);n=!0)d=l.value,g=_slicedToArray(d,2),u=g[0],m=g[1],t.cartData.variation[u]=m;e.next=27;break;case 23:e.prev=23,e.t1=e['catch'](19),p=!0,r=e.t1;case 27:e.prev=27,e.prev=28,!n&&c.return&&c.return();case 30:if(e.prev=30,!p){e.next=33;break}throw r;case 33:return e.finish(30);case 34:return e.finish(27);case 35:t.productVariation=s;case 36:return t.cartData.product_id=utopiasoftware[utopiasoftware_app_namespace].controller.productDetailsPageViewModel.currentProductDetails.id,t.cartData.quantity=$('#product-details-quantity').get(0).ej2_instances[0].value,t.product=utopiasoftware[utopiasoftware_app_namespace].controller.productDetailsPageViewModel.currentProductDetails,t.uid=Random.uuid4(utopiasoftware[utopiasoftware_app_namespace].randomisationEngine),e.prev=40,a.push(t),e.next=44,utopiasoftware[utopiasoftware_app_namespace].databaseOperations.saveData({_id:'user-cart',docType:'USER_CART',cart:a},utopiasoftware[utopiasoftware_app_namespace].model.appDatabase);case 44:$('.page-toast').get(0).ej2_instances[0].hide('All'),$('.timed-page-toast').get(0).ej2_instances[0].hide('All'),h=$('.timed-page-toast').get(0).ej2_instances[0],h.cssClass='success-ej2-toast',h.timeOut=2e3,h.content='Product has been added to your cart',h.dataBind(),h.show(),console.log('USER CART OBJECT',t),e.next=66;break;case 55:e.prev=55,e.t2=e['catch'](40),console.log('PRODUCT DETAILS ERROR',e.t2),$('.page-toast').get(0).ej2_instances[0].hide('All'),$('.timed-page-toast').get(0).ej2_instances[0].hide('All'),_=$('.timed-page-toast').get(0).ej2_instances[0],_.cssClass='error-ej2-toast',_.timeOut=3500,_.content='Error adding product to your cart. Try again',_.dataBind(),_.show();case 66:return e.prev=66,$('#product-details-page #product-details-add-to-cart').removeAttr('disabled'),$('#product-details-page #product-details-add-to-cart').get(0).ej2_instances[0].cssClass='e-hide-spinner',$('#product-details-page #product-details-add-to-cart').get(0).ej2_instances[0].dataBind(),$('#product-details-page #product-details-add-to-cart').get(0).ej2_instances[0].stop(),e.finish(66);case 72:case'end':return e.stop();}},e,this,[[2,8],[19,23,27,35],[28,,30,34],[40,55,66,72]])})),0);case 5:case'end':return e.stop();}},e,this)}));return function a(){return e.apply(this,arguments)}}()},customiseProductPageViewModel:{currentCustomisationUrl:'',currentCustomisationCartKey:null,customisationPageLoadCount:0,cartsQueue:[],pageInit:function o(e){var a=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(ons.isReady()&&!1!==utopiasoftware[utopiasoftware_app_namespace].model.isAppReady){e.next=3;break}return setTimeout(a,500),e.abrupt('return');case 3:$('#app-main-navigator').get(0).topPage.onDeviceBackButton=utopiasoftware[utopiasoftware_app_namespace].controller.customiseProductPageViewModel.backButtonClicked,$('#customise-product-page-pull-hook',t).get(0).onAction=utopiasoftware[utopiasoftware_app_namespace].controller.customiseProductPageViewModel.pagePullHookAction,window.addEventListener('message',utopiasoftware[utopiasoftware_app_namespace].controller.customiseProductPageViewModel.receiveMessageListener,!1),$('#customise-product-page-pull-hook',t).on('changestate',function(e){switch(e.originalEvent.state){case'initial':$('#customise-product-page-pull-hook-fab',e.originalEvent.pullHook).html('<ons-icon icon="md-long-arrow-down" size="24px" style="color: #363E7C"></ons-icon>');break;case'preaction':$('#customise-product-page-pull-hook-fab',e.originalEvent.pullHook).html('<ons-icon icon="md-long-arrow-up" size="24px" style="color: #363E7C"></ons-icon>');break;case'action':$('#customise-product-page-pull-hook-fab',e.originalEvent.pullHook).html('<ons-progress-circular indeterminate modifier="pull-hook"></ons-progress-circular>');}});try{new ej.buttons.Button({}).appendTo('#customise-product-cancel'),new ej.splitbuttons.ProgressButton({cssClass:'e-hide-spinner',duration:36000000}).appendTo('#customise-product-add-to-cart')}catch(e){console.log('CUSTOMISATION ERROR',e)}finally{}case 8:case'end':return e.stop();}},e,this)}));return function(){return e.apply(this,arguments)}}(),t=$(e.target);a()},pageShow:function e(){window.SoftInputMode.set('adjustResize'),$('#customise-product-page .cart-count').html(utopiasoftware[utopiasoftware_app_namespace].model.cartCount),document.addEventListener('offline',utopiasoftware[utopiasoftware_app_namespace].controller.customiseProductPageViewModel.deviceOfflineListener,!1),document.addEventListener('online',utopiasoftware[utopiasoftware_app_namespace].controller.customiseProductPageViewModel.deviceOnlineListener,!1)},pageHide:function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:document.removeEventListener('offline',utopiasoftware[utopiasoftware_app_namespace].controller.customiseProductPageViewModel.deviceOfflineListener,!1),document.removeEventListener('online',utopiasoftware[utopiasoftware_app_namespace].controller.customiseProductPageViewModel.deviceOnlineListener,!1);case 2:case'end':return e.stop();}},e,this)}));return function a(){return e.apply(this,arguments)}}(),pageDestroy:function e(){utopiasoftware[utopiasoftware_app_namespace].controller.customiseProductPageViewModel.currentCustomisationUrl='',utopiasoftware[utopiasoftware_app_namespace].controller.customiseProductPageViewModel.currentCustomisationCartKey=null,utopiasoftware[utopiasoftware_app_namespace].controller.customiseProductPageViewModel.customisationPageLoadCount=0,utopiasoftware[utopiasoftware_app_namespace].controller.customiseProductPageViewModel.cartsQueue=[],window.removeEventListener('message',utopiasoftware[utopiasoftware_app_namespace].controller.customiseProductPageViewModel.receiveMessageListener,!1),$('#customise-product-cancel').get(0).ej2_instances[0].destroy(),$('#customise-product-add-to-cart').get(0).ej2_instances[0].destroy()},backButtonClicked:function e(){$('#app-main-navigator').get(0).popPage()},deviceOfflineListener:function a(){$('.page-toast').get(0).ej2_instances[0].hide('All'),$('.timed-page-toast').get(0).ej2_instances[0].hide('All');var e=$('.page-toast').get(0).ej2_instances[0];e.cssClass='default-ej2-toast',e.content='No Internet connection. Connect to the Internet to customise product',e.dataBind(),e.show()},deviceOnlineListener:function e(){$('.page-toast').get(0).ej2_instances[0].hide('All')},receiveMessageListener:function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(a){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if('https://shopoakexclusive.com'===a.origin){e.next=2;break}return e.abrupt('return');case 2:if('page ready'!==a.data){e.next=8;break}return utopiasoftware[utopiasoftware_app_namespace].controller.customiseProductPageViewModel.customisationPageLoadCount+=1,$('#customise-product-page .page-preloader').css('display','none'),e.abrupt('return');case 8:t=JSON.parse(a.data),Array.isArray(t)?utopiasoftware[utopiasoftware_app_namespace].controller.customiseProductPageViewModel.cartsQueue.push({}):utopiasoftware[utopiasoftware_app_namespace].controller.customiseProductPageViewModel.cartsQueue.push(t),2<utopiasoftware[utopiasoftware_app_namespace].controller.customiseProductPageViewModel.cartsQueue.length&&utopiasoftware[utopiasoftware_app_namespace].controller.customiseProductPageViewModel.cartsQueue.shift(),window.setTimeout(utopiasoftware[utopiasoftware_app_namespace].controller.customiseProductPageViewModel.saveCustomisedProductToCart,0),$('#customise-product-page #customise-product-add-to-cart').removeAttr('disabled'),$('#customise-product-page #customise-product-add-to-cart').get(0).ej2_instances[0].cssClass='e-hide-spinner',$('#customise-product-page #customise-product-add-to-cart').get(0).ej2_instances[0].dataBind(),$('#customise-product-page #customise-product-add-to-cart').get(0).ej2_instances[0].stop();case 16:case'end':return e.stop();}},e,this)}));return function a(){return e.apply(this,arguments)}}(),pagePullHookAction:function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){var a=0<arguments.length&&arguments[0]!==void 0?arguments[0]:function(){},t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return $('#customise-product-page .page-preloader').css('display','block'),$('#customise-product-page #customise-product-add-to-cart').attr('disabled',!0),$('#customise-product-page #customise-product-add-to-cart').get(0).ej2_instances[0].cssClass='e-hide-spinner',$('#customise-product-page #customise-product-add-to-cart').get(0).ej2_instances[0].dataBind(),$('#customise-product-page #customise-product-add-to-cart').get(0).ej2_instances[0].stop(),$('#customise-product-page #customise-product-page-iframe-container .modal').css('display','none'),$('#customise-product-page #customise-product-page-pull-hook').attr('disabled',!0),$('.page-toast').get(0).ej2_instances[0].hide('All'),e.prev=8,e.next=11,utopiasoftware[utopiasoftware_app_namespace].controller.customiseProductPageViewModel.loadProductCustomisation(utopiasoftware[utopiasoftware_app_namespace].controller.customiseProductPageViewModel.currentCustomisationUrl,utopiasoftware[utopiasoftware_app_namespace].controller.customiseProductPageViewModel.currentCustomisationCartKey);case 11:e.next=20;break;case 13:e.prev=13,e.t0=e['catch'](8),t=$('.page-toast').get(0).ej2_instances[0],t.cssClass='error-ej2-toast',t.content='Sorry, an error occurred. Refresh to try again',t.dataBind(),t.show();case 20:return e.prev=20,window.setTimeout(function(){$('#customise-product-page #customise-product-page-pull-hook').removeAttr('disabled'),a()},2e3),e.finish(20);case 23:case'end':return e.stop();}},e,this,[[8,13,20,23]])}));return function a(){return e.apply(this,arguments)}}(),loadProductCustomisation:function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){var a=0<arguments.length&&arguments[0]!==void 0?arguments[0]:utopiasoftware[utopiasoftware_app_namespace].controller.customiseProductPageViewModel.currentCustomisationUrl,t=arguments[1],o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(navigator.connection.type!==Connection.NONE){e.next=10;break}return $('.page-toast').get(0).ej2_instances[0].hide('All'),$('.timed-page-toast').get(0).ej2_instances[0].hide('All'),o=$('.timed-page-toast').get(0).ej2_instances[0],o.cssClass='default-ej2-toast',o.timeOut=3500,o.content='Please connect to the Internet to customise product and Pull Down to refresh',o.dataBind(),o.show(),e.abrupt('return');case 10:return t?0>a.indexOf('?')?$('#customise-product-page #customise-product-page-iframe').attr('src',a+('?cart_item_key='+window.encodeURIComponent(t))):$('#customise-product-page #customise-product-page-iframe').attr('src',a+('&cart_item_key='+window.encodeURIComponent(t))):$('#customise-product-page #customise-product-page-iframe').attr('src',a),utopiasoftware[utopiasoftware_app_namespace].controller.customiseProductPageViewModel.currentCustomisationUrl=a,utopiasoftware[utopiasoftware_app_namespace].controller.customiseProductPageViewModel.currentCustomisationCartKey=t,utopiasoftware[utopiasoftware_app_namespace].controller.customiseProductPageViewModel.customisationPageLoadCount=0,utopiasoftware[utopiasoftware_app_namespace].controller.customiseProductPageViewModel.cartsQueue=[],e.abrupt('return',!0);case 16:case'end':return e.stop();}},e,this)}));return function a(){return e.apply(this,arguments)}}(),saveCustomisedProductToCart:function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){var a,t,o,s,i,n,p,r,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a=utopiasoftware[utopiasoftware_app_namespace].controller.customiseProductPageViewModel.cartsQueue[0],t=utopiasoftware[utopiasoftware_app_namespace].controller.customiseProductPageViewModel.cartsQueue[1],e.t0=regeneratorRuntime.keys(t);case 3:if((e.t1=e.t0()).done){e.next=60;break}if(o=e.t1.value,a[o]){e.next=58;break}return s=t[o],console.log('CUSTOMISED PRODUCT',s),i=[],n={cartData:{}},e.prev=10,e.next=13,utopiasoftware[utopiasoftware_app_namespace].databaseOperations.loadData('user-cart',utopiasoftware[utopiasoftware_app_namespace].model.appDatabase);case 13:i=e.sent.cart,utopiasoftware[utopiasoftware_app_namespace].controller.customiseProductPageViewModel.currentCustomisationCartKey&&(p=i.findIndex(function(e){return e.anon_cart_key===utopiasoftware[utopiasoftware_app_namespace].controller.customiseProductPageViewModel.currentCustomisationCartKey}),i.splice(p,1)),e.next=19;break;case 17:e.prev=17,e.t2=e['catch'](10);case 19:return n.cartData.product_id=s.product_id,n.cartData.quantity=s.quantity,n.cartData.variation_id=s.variation_id,n.cartData.variation=s.variation,n.cartData.cart_item_data={fpd_data:s.fpd_data},n.anon_cart_key=s.key,n.product_name=s.product_name,n.customisationUrl=utopiasoftware[utopiasoftware_app_namespace].controller.customiseProductPageViewModel.currentCustomisationUrl,n.uid=Random.uuid4(utopiasoftware[utopiasoftware_app_namespace].randomisationEngine),e.prev=28,i.push(n),e.next=32,utopiasoftware[utopiasoftware_app_namespace].databaseOperations.saveData({_id:'user-cart',docType:'USER_CART',cart:i},utopiasoftware[utopiasoftware_app_namespace].model.appDatabase);case 32:$('.page-toast').get(0).ej2_instances[0].hide('All'),$('.timed-page-toast').get(0).ej2_instances[0].hide('All'),r=$('.timed-page-toast').get(0).ej2_instances[0],r.cssClass='success-ej2-toast',r.timeOut=2e3,r.content='Customised product has been added to your cart',r.dataBind(),r.show(),e.next=53;break;case 42:e.prev=42,e.t3=e['catch'](28),console.log('CUSTOMISE PRODUCT ERROR',e.t3),$('.page-toast').get(0).ej2_instances[0].hide('All'),$('.timed-page-toast').get(0).ej2_instances[0].hide('All'),c=$('.timed-page-toast').get(0).ej2_instances[0],c.cssClass='error-ej2-toast',c.timeOut=3500,c.content='Error adding customised product to your cart. Try again',c.dataBind(),c.show();case 53:return e.prev=53,utopiasoftware[utopiasoftware_app_namespace].controller.customiseProductPageViewModel.currentCustomisationCartKey&&(utopiasoftware[utopiasoftware_app_namespace].controller.customiseProductPageViewModel.currentCustomisationCartKey=s.key),$('#customise-product-page #customise-product-page-iframe-container .modal').css('display','none'),e.finish(53);case 57:return e.abrupt('break',60);case 58:e.next=3;break;case 60:case'end':return e.stop();}},e,this,[[10,17],[28,42,53,57]])}));return function a(){return e.apply(this,arguments)}}(),addToCartButtonClicked:function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){var a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(navigator.connection.type!==Connection.NONE){e.next=10;break}return $('.page-toast').get(0).ej2_instances[0].hide('All'),$('.timed-page-toast').get(0).ej2_instances[0].hide('All'),a=$('.timed-page-toast').get(0).ej2_instances[0],a.cssClass='default-ej2-toast',a.timeOut=3500,a.content='Please connect to the Internet to add customised product to cart',a.dataBind(),a.show(),e.abrupt('return');case 10:$('#customise-product-page #customise-product-add-to-cart').get(0).ej2_instances[0].cssClass='',$('#customise-product-page #customise-product-add-to-cart').get(0).ej2_instances[0].dataBind(),$('#customise-product-page #customise-product-add-to-cart').get(0).ej2_instances[0].start(),$('#customise-product-page #customise-product-page-iframe-container .modal').css('display','table'),$('#customise-product-page #customise-product-page-iframe').get(0).contentWindow.utopiasoftware_addUsage();case 15:case'end':return e.stop();}},e,this)}));return function a(){return e.apply(this,arguments)}}()},viewCartPageViewModel:{pageInit:function o(e){var a=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){var o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(ons.isReady()&&!1!==utopiasoftware[utopiasoftware_app_namespace].model.isAppReady){e.next=3;break}return setTimeout(a,500),e.abrupt('return');case 3:$('#app-main-navigator').get(0).topPage.onDeviceBackButton=utopiasoftware[utopiasoftware_app_namespace].controller.viewCartPageViewModel.backButtonClicked,$('#view-cart-page-pull-hook',t).get(0).onAction=utopiasoftware[utopiasoftware_app_namespace].controller.viewCartPageViewModel.pagePullHookAction,$('#view-cart-page-pull-hook',t).on('changestate',function(e){switch(e.originalEvent.state){case'initial':$('#view-cart-page-pull-hook-fab',e.originalEvent.pullHook).html('<ons-icon icon="md-long-arrow-down" size="24px" style="color: #363E7C"></ons-icon>');break;case'preaction':$('#view-cart-page-pull-hook-fab',e.originalEvent.pullHook).html('<ons-icon icon="md-long-arrow-up" size="24px" style="color: #363E7C"></ons-icon>');break;case'action':$('#view-cart-page-pull-hook-fab',e.originalEvent.pullHook).html('<ons-progress-circular indeterminate modifier="pull-hook"></ons-progress-circular>');}});try{new ej.splitbuttons.ProgressButton({cssClass:'e-hide-spinner',duration:36000000}).appendTo('#view-cart-checkout')}catch(e){console.log('VIEW-CART PAGE',e),$('.page-toast').get(0).ej2_instances[0].hide('All'),o=$('.page-toast').get(0).ej2_instances[0],o.cssClass='error-ej2-toast',o.content='Sorry, an error occurred. Pull down to refresh',o.dataBind(),o.show()}case 7:case'end':return e.stop();}},e,this)}));return function(){return e.apply(this,arguments)}}(),t=$(e.target);a()},pageShow:function e(){$('#view-cart-page .cart-count').html(utopiasoftware[utopiasoftware_app_namespace].model.cartCount),window.SoftInputMode.set('adjustResize')},pageHide:function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case'end':return e.stop();}},e,this)}));return function a(){return e.apply(this,arguments)}}(),pageDestroy:function e(){$('#view-cart-checkout').get(0).ej2_instances[0].destroy(),$('#view-cart-page .view-cart-edit-button').each(function(e,a){a.ej2_instances[0].destroy()}),$('#view-cart-page .view-cart-remove-button').each(function(e,a){a.ej2_instances[0].destroy()}),$('#view-cart-page .view-cart-quantity-input').each(function(e,a){a.ej2_instances[0].destroy()})},backButtonClicked:function e(){$('#app-main-navigator').get(0).popPage()},pagePullHookAction:function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){var a=0<arguments.length&&arguments[0]!==void 0?arguments[0]:function(){},t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return $('#view-cart-page #view-cart-page-pull-hook').attr('disabled',!0),$('.page-toast').get(0).ej2_instances[0].hide('All'),$('#view-cart-page #view-cart-checkout').attr('disabled',!0),$('#view-cart-page #view-cart-checkout').get(0).ej2_instances[0].cssClass='e-hide-spinner',$('#view-cart-page #view-cart-checkout').get(0).ej2_instances[0].dataBind(),$('#view-cart-page #view-cart-checkout').get(0).ej2_instances[0].stop(),e.prev=6,e.next=9,utopiasoftware[utopiasoftware_app_namespace].controller.viewCartPageViewModel.displayUserCart();case 9:e.next=18;break;case 11:e.prev=11,e.t0=e['catch'](6),t=$('.page-toast').get(0).ej2_instances[0],t.cssClass='error-ej2-toast',t.content='Sorry, an error occurred. Refresh to try again',t.dataBind(),t.show();case 18:return e.prev=18,$('#view-cart-page #view-cart-page-pull-hook').removeAttr('disabled'),$('#view-cart-page #view-cart-checkout').removeAttr('disabled'),$('#view-cart-page .page-preloader').css('display','none'),a(),e.finish(18);case 24:case'end':return e.stop();}},e,this,[[6,11,18,24]])}));return function a(){return e.apply(this,arguments)}}(),displayUserCart:function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(a){var t,o,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t='',e.prev=1,e.prev=2,e.t0=a,e.t0){e.next=8;break}return e.next=7,utopiasoftware[utopiasoftware_app_namespace].databaseOperations.loadData('user-cart',utopiasoftware[utopiasoftware_app_namespace].model.appDatabase);case 7:e.t0=e.sent.cart;case 8:a=e.t0,e.next=14;break;case 11:e.prev=11,e.t1=e['catch'](2),a=[];case 14:if(0!==a.length){e.next=24;break}return $('.page-toast').get(0).ej2_instances[0].hide('All'),$('.timed-page-toast').get(0).ej2_instances[0].hide('All'),o=$('.timed-page-toast').get(0).ej2_instances[0],o.cssClass='default-ej2-toast',o.timeOut=3e3,o.content='Your cart is empty. Go order some products!',o.dataBind(),o.show(),e.abrupt('return');case 24:for($('#view-cart-page .view-cart-edit-button').each(function(e,a){a.ej2_instances[0].destroy()}),$('#view-cart-page .view-cart-remove-button').each(function(e,a){a.ej2_instances[0].destroy()}),$('#view-cart-page .view-cart-quantity-input').each(function(e,a){a.ej2_instances[0].destroy()}),s=0;s<a.length;s++)t+='<div class="col-xs-12" style="border-bottom: 1px lightgray solid" \n                            data-utopiasoftware-product-uid="'+a[s].uid+'">\n                        <div class="e-card e-card-horizontal">',a[s].anon_cart_key?t+='<div class="e-card-image" style="-webkit-flex-basis: auto; flex-basis: auto; width: 30%;\n                            min-height: 100%; \n                            background-image: url(\''+a[s].cartData.cart_item_data.fpd_data.fpd_product_thumbnail+'\');">\n                            </div>\n                            <div class="e-card-stacked" style="-webkit-flex-basis: auto; flex-basis: auto; width: 70%">\n                            <div class="e-card-header" style="padding: 0">\n                            <div class="e-card-header-caption"  style="padding-left: 3px; padding-right: 5px">\n                            <div class="e-card-sub-title" style="font-size: 14px; text-align: center; text-transform: capitalize">\n                                '+a[s].product_name+'\n                            </div>\n                            <div class="e-card-sub-title" style="font-size: 11px; text-align: center; text-transform: capitalize">\n                                &#x20a6;'+kendo.toString(a[s].cartData.quantity*kendo.parseFloat(a[s].cartData.cart_item_data.fpd_data.fpd_product_price),'n2')+'\n                            </div>\n                            </div>\n                            </div>\n                            <div class="e-card-content row" style="padding: 0;">\n                            <div class="col-xs-3">\n                                <button type="button" class="view-cart-edit-button"\n                                        style="background-color: #ffffff; color: #3f51b5; height: 10px;" \n                                        onclick="utopiasoftware[utopiasoftware_app_namespace].controller.\n                                        viewCartPageViewModel.\n                                        editCartItemButtonClicked(\''+a[s].customisationUrl+'\', \n                                        \''+a[s].anon_cart_key+'\')"></button>\n                            </div>\n                            <div class="col-xs-4">\n                                <button type="button" class="view-cart-remove-button"\n                                        style="background-color: #ffffff; color: #3f51b5; height: 10px;" \n                                        onclick="utopiasoftware[utopiasoftware_app_namespace].controller.\n                                        viewCartPageViewModel.deleteCartItemButtonClicked(\''+a[s].uid+'\')"></button>\n                            </div>\n                            <div class="col-xs-5">\n                                <input class="view-cart-quantity-input" type="number" style="padding-top: 2px;" \n                                value="'+a[s].cartData.quantity+'" \n                                data-utopiasoftware-product-uid="'+a[s].uid+'">\n                            </div>\n                            </div>\n                            </div>':a[s].productVariation?t+='<div class="e-card-image" style="-webkit-flex-basis: auto; flex-basis: auto; width: 30%;\n                            min-height: 100%; \n                            background-image: \n                            url(\''+(a[s].productVariation.image&&''!==a[s].productVariation.image?a[s].productVariation.image.src:a[s].product.images[0].src)+'\');">\n                            </div>\n                            <div class="e-card-stacked" style="-webkit-flex-basis: auto; flex-basis: auto; width: 70%">\n                            <div class="e-card-header" style="padding: 0">\n                            <div class="e-card-header-caption"  style="padding-left: 3px; padding-right: 5px">\n                            <div class="e-card-sub-title" style="font-size: 14px; text-align: center; text-transform: capitalize">\n                                '+a[s].product.name+'\n                            </div>\n                            <div class="e-card-sub-title" style="font-size: 11px; text-align: center; text-transform: capitalize">\n                                &#x20a6;'+kendo.toString(a[s].cartData.quantity*kendo.parseFloat(a[s].productVariation.price&&''!==a[s].productVariation.price?a[s].productVariation.price:a[s].product.price),'n2')+'\n                            </div>\n                            </div>\n                            </div>\n                            <div class="e-card-content row" style="padding: 0;">\n                            <div class="col-xs-3">\n                            </div>\n                            <div class="col-xs-4">\n                                <button type="button" class="view-cart-remove-button"\n                                        style="background-color: #ffffff; color: #3f51b5; height: 10px;" \n                                        onclick="utopiasoftware[utopiasoftware_app_namespace].controller.\n                                        viewCartPageViewModel.deleteCartItemButtonClicked(\''+a[s].uid+'\')"></button>\n                            </div>\n                            <div class="col-xs-5">\n                                <input class="view-cart-quantity-input" type="number" style="padding-top: 2px;" \n                                value="'+a[s].cartData.quantity+'" \n                                data-utopiasoftware-product-uid="'+a[s].uid+'">\n                            </div>\n                            </div>\n                            </div>':!a[s].productVariation&&(t+='<div class="e-card-image" style="-webkit-flex-basis: auto; flex-basis: auto; width: 30%;\n                            min-height: 100%; \n                            background-image: url(\''+a[s].product.images[0].src+'\');">\n                            </div>\n                            <div class="e-card-stacked" style="-webkit-flex-basis: auto; flex-basis: auto; width: 70%">\n                            <div class="e-card-header" style="padding: 0">\n                            <div class="e-card-header-caption"  style="padding-left: 3px; padding-right: 5px">\n                            <div class="e-card-sub-title" style="font-size: 14px; text-align: center; text-transform: capitalize">\n                                '+a[s].product.name+'\n                            </div>\n                            <div class="e-card-sub-title" style="font-size: 11px; text-align: center; text-transform: capitalize">\n                                &#x20a6;'+kendo.toString(a[s].cartData.quantity*kendo.parseFloat(a[s].product.price),'n2')+'\n                            </div>\n                            </div>\n                            </div>\n                            <div class="e-card-content row" style="padding: 0;">\n                            <div class="col-xs-3">                          \n                            </div>\n                            <div class="col-xs-4">\n                                <button type="button" class="view-cart-remove-button"\n                                        style="background-color: #ffffff; color: #3f51b5; height: 10px;" \n                                        onclick="utopiasoftware[utopiasoftware_app_namespace].controller.\n                                        viewCartPageViewModel.deleteCartItemButtonClicked(\''+a[s].uid+'\')"></button>\n                            </div>\n                            <div class="col-xs-5">\n                                <input class="view-cart-quantity-input" type="number" style="padding-top: 2px;" \n                                value="'+a[s].cartData.quantity+'" \n                                data-utopiasoftware-product-uid="'+a[s].uid+'">\n                            </div>\n                            </div>\n                            </div>'),t+='</div>\n                         </div>';$('#view-cart-page #view-cart-contents-container').html(t),$('#view-cart-page .view-cart-edit-button').each(function(e,a){new ej.buttons.Button({cssClass:'e-flat e-round',iconCss:'zmdi zmdi-edit utopiasoftware-icon-zoom-one-point-two',iconPosition:'Left'}).appendTo(a)}),$('#view-cart-page .view-cart-remove-button').each(function(e,a){new ej.buttons.Button({cssClass:'e-flat e-round',iconCss:'zmdi zmdi-delete utopiasoftware-icon-zoom-one-point-two'}).appendTo(a)}),$('#view-cart-page .view-cart-quantity-input').each(function(e,t){var o;new ej.inputs.NumericTextBox((o={value:t.value,cssClass:'view-cart-quantity-input-class',currency:null,decimals:0,floatLabelType:'Auto',format:'n',showSpinButton:!0,min:1,max:10,placeholder:' ',step:1,strictMode:!0,width:'60%'},_defineProperty(o,'value',1),_defineProperty(o,'change',function s(){var e=this.value,o=$(t).attr('data-utopiasoftware-product-uid');$('#view-cart-page .page-preloader').css('display','block'),window.setTimeout(_asyncToGenerator(regeneratorRuntime.mark(function t(){var s,i,n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,s=a.find(function(e){return e.uid===o}),s.cartData.quantity=e,t.next=5,utopiasoftware[utopiasoftware_app_namespace].databaseOperations.saveData({_id:'user-cart',docType:'USER_CART',cart:a},utopiasoftware[utopiasoftware_app_namespace].model.appDatabase);case 5:return t.next=7,utopiasoftware[utopiasoftware_app_namespace].controller.viewCartPageViewModel.displayUserCart(a);case 7:$('.page-toast').get(0).ej2_instances[0].hide('All'),$('.timed-page-toast').get(0).ej2_instances[0].hide('All'),i=$('.timed-page-toast').get(0).ej2_instances[0],i.cssClass='success-ej2-toast',i.timeOut=2e3,i.content='Product quantity updated',i.dataBind(),i.show(),t.next=28;break;case 17:t.prev=17,t.t0=t['catch'](0),console.log('UPDATE PRODUCT QUANTITY',t.t0),$('.page-toast').get(0).ej2_instances[0].hide('All'),$('.timed-page-toast').get(0).ej2_instances[0].hide('All'),n=$('.timed-page-toast').get(0).ej2_instances[0],n.cssClass='error-ej2-toast',n.timeOut=3500,n.content='Product quantity not updated. Try again',n.dataBind(),n.show();case 28:return t.prev=28,$('#view-cart-page .page-preloader').css('display','none'),t.finish(28);case 31:case'end':return t.stop();}},t,this,[[0,17,28,31]])})),0)}),o)).appendTo(t)}),$('#view-cart-page #view-cart-total-price').html('&#x20a6;'+kendo.toString(utopiasoftware[utopiasoftware_app_namespace].controller.viewCartPageViewModel.calculateCartTotalPrice(a),'n2'));case 33:return e.prev=33,e.finish(33);case 35:case'end':return e.stop();}},e,this,[[1,,33,35],[2,11]])}));return function a(){return e.apply(this,arguments)}}(),viewCartPage:function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){var a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,$('#app-main-navigator').get(0).bringPageTop('view-cart-page.html');case 3:return e.next=5,utopiasoftware[utopiasoftware_app_namespace].controller.viewCartPageViewModel.displayUserCart();case 5:$('#view-cart-page #view-cart-checkout').removeAttr('disabled'),e.next=17;break;case 8:e.prev=8,e.t0=e['catch'](0),console.log('VIEW-CART PAGE',e.t0),$('.page-toast').get(0).ej2_instances[0].hide('All'),a=$('.page-toast').get(0).ej2_instances[0],a.cssClass='error-ej2-toast',a.content='Sorry, an error occurred. Pull down to refresh',a.dataBind(),a.show();case 17:return e.prev=17,$('#view-cart-page .page-preloader').css('display','none'),e.finish(17);case 20:case'end':return e.stop();}},e,this,[[0,8,17,20]])}));return function a(){return e.apply(this,arguments)}}(),calculateCartTotalPrice:function a(){var e=0<arguments.length&&arguments[0]!==void 0?arguments[0]:[];return 0===e.length?0:e.reduce(function(e,a,t){return(console.log('ACCUMULATOR',e),console.log('CURRENT INDEX',t),a.anon_cart_key)?e+a.cartData.quantity*kendo.parseFloat(a.cartData.cart_item_data.fpd_data.fpd_product_price):a.productVariation?e+a.cartData.quantity*kendo.parseFloat(a.productVariation.price&&''!==a.productVariation.price?a.productVariation.price:a.product.price):a.productVariation?void 0:e+a.cartData.quantity*kendo.parseFloat(a.product.price)},0)},deleteCartItemButtonClicked:function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){var a=0<arguments.length&&arguments[0]!==void 0?arguments[0]:'';return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return $('#view-cart-page-delete-cart-item-action-sheet #view-cart-page-delete-cart-item-no').get(0).onclick=_asyncToGenerator(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,document.getElementById('view-cart-page-delete-cart-item-action-sheet').hide();case 2:case'end':return e.stop();}},e,this)})),$('#view-cart-page-delete-cart-item-action-sheet #view-cart-page-delete-cart-item-yes').get(0).onclick=_asyncToGenerator(regeneratorRuntime.mark(function e(){var t,o,s,i,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],e.prev=1,$('#view-cart-page .page-preloader').css('display','block'),e.next=5,document.getElementById('view-cart-page-delete-cart-item-action-sheet').hide();case 5:return e.prev=5,e.next=8,utopiasoftware[utopiasoftware_app_namespace].databaseOperations.loadData('user-cart',utopiasoftware[utopiasoftware_app_namespace].model.appDatabase);case 8:t=e.sent.cart,e.next=13;break;case 11:e.prev=11,e.t0=e['catch'](5);case 13:return o=t.findIndex(function(e){return a===e.uid}),-1!==o&&t.splice(o,1),e.next=17,utopiasoftware[utopiasoftware_app_namespace].databaseOperations.saveData({_id:'user-cart',docType:'USER_CART',cart:t},utopiasoftware[utopiasoftware_app_namespace].model.appDatabase);case 17:return s=$('#view-cart-page .col-xs-12[data-utopiasoftware-product-uid="'+a+'"]'),e.next=20,kendo.fx(s).expand('vertical').duration(250).reverse();case 20:$('#view-cart-page #view-cart-total-price').html('&#x20a6;'+kendo.toString(utopiasoftware[utopiasoftware_app_namespace].controller.viewCartPageViewModel.calculateCartTotalPrice(t),'n2')),$('.page-toast').get(0).ej2_instances[0].hide('All'),$('.timed-page-toast').get(0).ej2_instances[0].hide('All'),i=$('.timed-page-toast').get(0).ej2_instances[0],i.cssClass='default-ej2-toast',i.timeOut=2e3,i.content='Product has been deleted from your cart',i.dataBind(),i.show(),e.next=42;break;case 31:e.prev=31,e.t1=e['catch'](1),console.log('DELETE CART ERROR',e.t1),$('.page-toast').get(0).ej2_instances[0].hide('All'),$('.timed-page-toast').get(0).ej2_instances[0].hide('All'),n=$('.timed-page-toast').get(0).ej2_instances[0],n.cssClass='error-ej2-toast',n.timeOut=3500,n.content='Error deleting product from your cart. Try again',n.dataBind(),n.show();case 42:return e.prev=42,$('#view-cart-page .page-preloader').css('display','none'),e.finish(42);case 45:case'end':return e.stop();}},e,this,[[1,31,42,45],[5,11]])})),e.next=4,document.getElementById('view-cart-page-delete-cart-item-action-sheet').show();case 4:case'end':return e.stop();}},e,this)}));return function a(){return e.apply(this,arguments)}}(),editCartItemButtonClicked:function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(a,t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$('#app-main-navigator').get(0).bringPageTop('customise-product-page.html');case 2:return e.next=4,utopiasoftware[utopiasoftware_app_namespace].controller.customiseProductPageViewModel.loadProductCustomisation(a,t);case 4:case'end':return e.stop();}},e,this)}));return function a(){return e.apply(this,arguments)}}(),checkoutButtonClicked:function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){var a,t,o,s,i,n,p,r,c,l,d;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=null,e.prev=1,e.next=4,utopiasoftware[utopiasoftware_app_namespace].databaseOperations.loadData('user-details',utopiasoftware[utopiasoftware_app_namespace].model.encryptedAppDatabase);case 4:a=e.sent.userDetails,e.next=19;break;case 7:return e.prev=7,e.t0=e['catch'](1),$('.page-toast').get(0).ej2_instances[0].hide('All'),$('.timed-page-toast').get(0).ej2_instances[0].hide('All'),t=$('.timed-page-toast').get(0).ej2_instances[0],t.cssClass='error-ej2-toast',t.timeOut=3500,t.content='Please sign in to checkout your cart',t.dataBind(),t.show(),$('#app-main-navigator').get(0).pushPage('login-page.html'),e.abrupt('return');case 19:return e.prev=19,e.next=22,utopiasoftware[utopiasoftware_app_namespace].databaseOperations.loadData('user-cart',utopiasoftware[utopiasoftware_app_namespace].model.appDatabase);case 22:if(o=e.sent.cart,0!==o.length){e.next=25;break}throw'error';case 25:e.next=38;break;case 27:return e.prev=27,e.t1=e['catch'](19),$('.page-toast').get(0).ej2_instances[0].hide('All'),$('.timed-page-toast').get(0).ej2_instances[0].hide('All'),s=$('.timed-page-toast').get(0).ej2_instances[0],s.cssClass='default-ej2-toast',s.timeOut=3e3,s.content='Your cart is empty. Go order some products!',s.dataBind(),s.show(),e.abrupt('return');case 38:if(''!=a.billing.address_1){e.next=49;break}return $('.page-toast').get(0).ej2_instances[0].hide('All'),$('.timed-page-toast').get(0).ej2_instances[0].hide('All'),i=$('.timed-page-toast').get(0).ej2_instances[0],i.cssClass='error-ej2-toast',i.timeOut=3500,i.content='Please update your billing address to checkout your cart',i.dataBind(),i.show(),$('#app-main-navigator').get(0).pushPage('billing-info-page.html'),e.abrupt('return');case 49:if(navigator.connection.type!==Connection.NONE){e.next=59;break}return $('.page-toast').get(0).ej2_instances[0].hide('All'),$('.timed-page-toast').get(0).ej2_instances[0].hide('All'),n=$('.timed-page-toast').get(0).ej2_instances[0],n.cssClass='error-ej2-toast',n.timeOut=3e3,n.content='Connect to the Internet to checkout your cart',n.dataBind(),n.show(),e.abrupt('return');case 59:return $('#loader-modal-message').html('Preparing Checkout...'),$('#loader-modal').get(0).show(),p={status:'pending',currency:'NGN',customer_id:a.id,billing:a.billing,shipping:a.shipping,line_items:[]},e.prev=62,e.next=65,utopiasoftware[utopiasoftware_app_namespace].databaseOperations.loadData('user-cart',utopiasoftware[utopiasoftware_app_namespace].model.appDatabase);case 65:for(r=e.sent.cart,c=0;c<r.length;c++){if(p.line_items[c]=r[c].cartData,r[c].product?(p.line_items[c].name=r[c].product.name,p.line_items[c].subtotal=''+kendo.parseFloat(r[c].product.price)*p.line_items[c].quantity,p.line_items[c].total=''+kendo.parseFloat(r[c].product.price)*p.line_items[c].quantity):p.line_items[c].name=r[c].product_name,p.line_items[c].meta_data=[],r[c].cartData.variation_id)for(l in r[c].cartData.cart_item_data||(p.line_items[c].subtotal=''+kendo.parseFloat(r[c].productVariation.price)*p.line_items[c].quantity,p.line_items[c].total=''+kendo.parseFloat(r[c].productVariation.price)*p.line_items[c].quantity),r[c].cartData.variation)p.line_items[c].meta_data.push({key:l.split('_')[1],value:r[c].cartData.variation[l]});r[c].cartData.cart_item_data&&(console.log('ORDER ITEM',r[c].cartData),p.line_items[c].subtotal=''+kendo.parseFloat(r[c].cartData.cart_item_data.fpd_data.fpd_product_price)*p.line_items[c].quantity,p.line_items[c].total=''+kendo.parseFloat(r[c].cartData.cart_item_data.fpd_data.fpd_product_price)*p.line_items[c].quantity,p.line_items[c].meta_data.push({key:'_fpd_data',value:r[c].cartData.cart_item_data.fpd_data.fpd_product},{key:'_fpd_print_order',value:r[c].cartData.cart_item_data.fpd_data.fpd_print_order}),delete p.line_items[c].cart_item_data)}return console.log('ORDER DATA',p),e.next=70,Promise.resolve($.ajax({url:utopiasoftware[utopiasoftware_app_namespace].model.appBaseUrl+'/wp-json/wc/v3/orders',type:'post',contentType:'application/json',beforeSend:function a(e){e.setRequestHeader('Authorization','Basic '+utopiasoftware[utopiasoftware_app_namespace].accessor)},dataType:'json',timeout:24e4,processData:!1,data:JSON.stringify(p)}));case 70:return p=e.sent,e.next=73,$('#app-main-navigator').get(0).pushPage('checkout-page.html',{data:{orderData:p}});case 73:e.next=86;break;case 75:e.prev=75,e.t2=e['catch'](62),e.t2=JSON.parse(e.t2.responseText),$('.page-toast').get(0).ej2_instances[0].hide('All'),$('.timed-page-toast').get(0).ej2_instances[0].hide('All'),d=$('.timed-page-toast').get(0).ej2_instances[0],d.cssClass='error-ej2-toast',d.timeOut=3e3,d.content='Checkout failed. '+(e.t2.message||''),d.dataBind(),d.show();case 86:return e.prev=86,$('#loader-modal').get(0).hide(),e.finish(86);case 89:case'end':return e.stop();}},e,this,[[1,7],[19,27],[62,75,86,89]])}));return function a(){return e.apply(this,arguments)}}()},profilePageViewModel:{profileFormValidator:null,pageInit:function o(e){var a=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(ons.isReady()&&!1!==utopiasoftware[utopiasoftware_app_namespace].model.isAppReady){e.next=3;break}return setTimeout(a,500),e.abrupt('return');case 3:return $('#app-main-navigator').get(0).topPage.onDeviceBackButton=utopiasoftware[utopiasoftware_app_namespace].controller.profilePageViewModel.backButtonClicked,utopiasoftware[utopiasoftware_app_namespace].controller.profilePageViewModel.profileFormValidator=$('#profile-page #profile-form').parsley(),utopiasoftware[utopiasoftware_app_namespace].controller.profilePageViewModel.profileFormValidator.on('field:error',function(e){var a=$('#profile-page #profile-form').get(0).ej2_instances[e.$element.get(0)._utopiasoftware_validator_index];a.content=e.getErrorsMessages()[0],a.dataBind(),a.open(e.$element.get(0))}),utopiasoftware[utopiasoftware_app_namespace].controller.profilePageViewModel.profileFormValidator.on('field:success',function(e){var a=$('#profile-page #profile-form').get(0).ej2_instances[e.$element.get(0)._utopiasoftware_validator_index];a.close()}),utopiasoftware[utopiasoftware_app_namespace].controller.profilePageViewModel.profileFormValidator.on('form:success',utopiasoftware[utopiasoftware_app_namespace].controller.profilePageViewModel.profileFormValidated),$('#profile-page .content').on('scroll',utopiasoftware[utopiasoftware_app_namespace].controller.profilePageViewModel.scrollAndResizeEventListener),e.prev=9,$('#profile-form ons-input',t).each(function(e,a){a._utopiasoftware_validator_index=e,new ej.popups.Tooltip({cssClass:'utopiasoftware-ej2-validation-tooltip',position:'TopLeft',opensOn:'Custom'}).appendTo($('#profile-page #profile-form').get(0))}),new ej.buttons.Button({}).appendTo('#profile-cancel'),new ej.splitbuttons.ProgressButton({cssClass:'e-hide-spinner',duration:36000000}).appendTo('#profile-update'),e.next=15,utopiasoftware[utopiasoftware_app_namespace].controller.profilePageViewModel.displayProfileContent();case 15:e.next=20;break;case 17:e.prev=17,e.t0=e['catch'](9),console.log('PROFILE ERROR',e.t0);case 20:return e.prev=20,e.finish(20);case 22:case'end':return e.stop();}},e,this,[[9,17,20,22]])}));return function(){return e.apply(this,arguments)}}(),t=$(e.target);a()},pageShow:function e(){window.SoftInputMode.set('adjustResize'),$('#profile-page .cart-count').html(utopiasoftware[utopiasoftware_app_namespace].model.cartCount),window.addEventListener('resize',utopiasoftware[utopiasoftware_app_namespace].controller.profilePageViewModel.scrollAndResizeEventListener,!1)},pageHide:function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:$('#profile-page #profile-form').get(0).ej2_instances.forEach(function(e){e.close()}),utopiasoftware[utopiasoftware_app_namespace].controller.profilePageViewModel.profileFormValidator.reset(),window.removeEventListener('resize',utopiasoftware[utopiasoftware_app_namespace].controller.profilePageViewModel.scrollAndResizeEventListener,!1);case 3:case'end':return e.stop();}},e,this)}));return function a(){return e.apply(this,arguments)}}(),pageDestroy:function e(){$('#profile-page #profile-form').get(0).ej2_instances.forEach(function(e){e.destroy()}),$('#profile-page #profile-cancel').get(0).ej2_instances[0].destroy(),$('#profile-page #profile-update').get(0).ej2_instances[0].destroy(),utopiasoftware[utopiasoftware_app_namespace].controller.profilePageViewModel.profileFormValidator.destroy()},backButtonClicked:function e(){$('#app-main-navigator').get(0).popPage()},scrollAndResizeEventListener:function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:window.setTimeout(function(){$('#profile-page #profile-form ons-input').each(function(e,a){document.getElementById('profile-form').ej2_instances[e].refresh(a)})},0);case 1:case'end':return e.stop();}},e,this)}));return function a(){return e.apply(this,arguments)}}(),updateButtonClicked:function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:utopiasoftware[utopiasoftware_app_namespace].controller.profilePageViewModel.profileFormValidator.whenValidate();case 1:case'end':return e.stop();}},e,this)}));return function a(){return e.apply(this,arguments)}}(),profileFormValidated:function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){var a,t,o,s,i,n,p,r,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(navigator.connection.type!==Connection.NONE){e.next=10;break}return $('.page-toast').get(0).ej2_instances[0].hide('All'),$('.timed-page-toast').get(0).ej2_instances[0].hide('All'),a=$('.timed-page-toast').get(0).ej2_instances[0],a.cssClass='error-ej2-toast',a.timeOut=3e3,a.content='Connect to the Internet to update your profile',a.dataBind(),a.show(),e.abrupt('return');case 10:return $('#profile-page #profile-update').attr('disabled',!0),$('#profile-page #profile-update').get(0).ej2_instances[0].cssClass='',$('#profile-page #profile-update').get(0).ej2_instances[0].dataBind(),$('#profile-page #profile-update').get(0).ej2_instances[0].start(),$('#profile-page .modal').css('display','table'),t=[],o=null,e.prev=17,e.next=20,utopiasoftware[utopiasoftware_app_namespace].databaseOperations.loadData('user-details',utopiasoftware[utopiasoftware_app_namespace].model.encryptedAppDatabase);case 20:return s=e.sent.userDetails,console.log('USER DETAILS BEFORE PROFILE UPDATE',s),i=s.id,n=s.password,s.first_name=$('#profile-page #profile-form #profile-first-name').val().trim(),s.last_name=$('#profile-page #profile-form #profile-last-name').val().trim(),s.billing||(s.billing={}),s.billing.email=$('#profile-page #profile-form #profile-email').val().trim(),s.billing.first_name=s.first_name,s.billing.last_name=s.last_name,s.billing.phone=$('#profile-page #profile-form #profile-phone-number').val().trim(),s.billing.phone.startsWith('0')&&(s.billing.phone=s.billing.phone.replace(/0/i,'+234')),delete s.id,delete s.password,t.push(Promise.resolve($.ajax({url:utopiasoftware[utopiasoftware_app_namespace].model.appBaseUrl+('/wp-json/wc/v3/customers/'+i),type:'put',contentType:'application/json',beforeSend:function a(e){e.setRequestHeader('Authorization','Basic '+utopiasoftware[utopiasoftware_app_namespace].accessor)},dataType:'json',timeout:24e4,processData:!1,data:JSON.stringify(s)}))),o=Promise.all(t),e.next=38,o;case 38:return p=e.sent,p[0].password=n,e.next=42,utopiasoftware[utopiasoftware_app_namespace].databaseOperations.saveData({_id:'user-details',docType:'USER_DETAILS',userDetails:p[0]},utopiasoftware[utopiasoftware_app_namespace].model.encryptedAppDatabase);case 42:$('.page-toast').get(0).ej2_instances[0].hide('All'),$('.timed-page-toast').get(0).ej2_instances[0].hide('All'),r=$('.timed-page-toast').get(0).ej2_instances[0],r.cssClass='success-ej2-toast',r.timeOut=3e3,r.content='User profile updated',r.dataBind(),r.show(),e.next=63;break;case 52:e.prev=52,e.t0=e['catch'](17),e.t0=JSON.parse(e.t0.responseText),$('.page-toast').get(0).ej2_instances[0].hide('All'),$('.timed-page-toast').get(0).ej2_instances[0].hide('All'),c=$('.timed-page-toast').get(0).ej2_instances[0],c.cssClass='error-ej2-toast',c.timeOut=3e3,c.content='User profile update failed. '+(e.t0.message||''),c.dataBind(),c.show();case 63:return e.prev=63,$('#profile-page #profile-update').removeAttr('disabled'),$('#profile-page #profile-update').get(0).ej2_instances[0].cssClass='e-hide-spinner',$('#profile-page #profile-update').get(0).ej2_instances[0].dataBind(),$('#profile-page #profile-update').get(0).ej2_instances[0].stop(),$('#profile-page .modal').css('display','none'),e.finish(63);case 70:return e.abrupt('return',o);case 71:case'end':return e.stop();}},e,this,[[17,52,63,70]])}));return function a(){return e.apply(this,arguments)}}(),displayProfileContent:function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){var a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,utopiasoftware[utopiasoftware_app_namespace].databaseOperations.loadData('user-details',utopiasoftware[utopiasoftware_app_namespace].model.encryptedAppDatabase);case 3:a=e.sent.userDetails,console.log('USER DETAILS',a),$('#profile-page #profile-form #profile-email').val(a.email),$('#profile-page #profile-form #profile-first-name').val(a.first_name||''),$('#profile-page #profile-form #profile-last-name').val(a.last_name||''),$('#profile-page #profile-form #profile-phone-number').val(a.billing&&a.billing.phone?a.billing.phone:'');case 9:return e.prev=9,$('#profile-page .page-preloader').css('display','none'),$('#profile-page .modal').css('display','none'),$('#profile-page #profile-update').removeAttr('disabled'),e.finish(9);case 14:case'end':return e.stop();}},e,this,[[0,,9,14]])}));return function a(){return e.apply(this,arguments)}}()},changePasswordPageViewModel:{changePasswordFormValidator:null,pageInit:function o(e){var a=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(ons.isReady()&&!1!==utopiasoftware[utopiasoftware_app_namespace].model.isAppReady){e.next=3;break}return setTimeout(a,500),e.abrupt('return');case 3:$('#app-main-navigator').get(0).topPage.onDeviceBackButton=utopiasoftware[utopiasoftware_app_namespace].controller.changePasswordPageViewModel.backButtonClicked,utopiasoftware[utopiasoftware_app_namespace].controller.changePasswordPageViewModel.changePasswordFormValidator=$('#change-password-page #change-password-form').parsley(),utopiasoftware[utopiasoftware_app_namespace].controller.changePasswordPageViewModel.changePasswordFormValidator.on('field:error',function(e){var a=$('#change-password-page #change-password-form').get(0).ej2_instances[e.$element.get(0)._utopiasoftware_validator_index];a.content=e.getErrorsMessages()[0],a.dataBind(),a.open(e.$element.get(0))}),utopiasoftware[utopiasoftware_app_namespace].controller.changePasswordPageViewModel.changePasswordFormValidator.on('field:success',function(e){var a=$('#change-password-page #change-password-form').get(0).ej2_instances[e.$element.get(0)._utopiasoftware_validator_index];a.close()}),utopiasoftware[utopiasoftware_app_namespace].controller.changePasswordPageViewModel.changePasswordFormValidator.on('form:success',utopiasoftware[utopiasoftware_app_namespace].controller.changePasswordPageViewModel.changePasswordFormValidated),$('#change-password-page .content').on('scroll',utopiasoftware[utopiasoftware_app_namespace].controller.changePasswordPageViewModel.scrollAndResizeEventListener);try{$('#change-password-form ons-input',t).each(function(e,a){a._utopiasoftware_validator_index=e,new ej.popups.Tooltip({cssClass:'utopiasoftware-ej2-validation-tooltip',position:'TopLeft',opensOn:'Custom'}).appendTo($('#change-password-page #change-password-form').get(0))}),new ej.buttons.Button({isToggle:!0,cssClass:'e-flat e-small e-round',iconCss:'zmdi zmdi-eye',iconPosition:'Left'}).appendTo($('#change-password-view-button',t).get(0)),new ej.buttons.Button({}).appendTo('#change-password-cancel'),new ej.splitbuttons.ProgressButton({cssClass:'e-hide-spinner',duration:36000000}).appendTo('#change-password-update')}catch(e){console.log('CHANGE PASSWORD ERROR',e)}finally{$('#change-password-page .page-preloader').css('display','none'),$('#change-password-page .modal').css('display','none'),$('#change-password-page #change-password-update').removeAttr('disabled')}case 10:case'end':return e.stop();}},e,this)}));return function(){return e.apply(this,arguments)}}(),t=$(e.target);a()},pageShow:function e(){window.SoftInputMode.set('adjustResize'),$('#change-password-page .cart-count').html(utopiasoftware[utopiasoftware_app_namespace].model.cartCount),window.addEventListener('resize',utopiasoftware[utopiasoftware_app_namespace].controller.changePasswordPageViewModel.scrollAndResizeEventListener,!1)},pageHide:function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:$('#change-password-page #change-password-form').get(0).ej2_instances.forEach(function(e){e.close()}),utopiasoftware[utopiasoftware_app_namespace].controller.changePasswordPageViewModel.changePasswordFormValidator.reset(),window.removeEventListener('resize',utopiasoftware[utopiasoftware_app_namespace].controller.changePasswordPageViewModel.scrollAndResizeEventListener,!1);case 3:case'end':return e.stop();}},e,this)}));return function a(){return e.apply(this,arguments)}}(),pageDestroy:function e(){$('#change-password-page #change-password-form').get(0).ej2_instances.forEach(function(e){e.destroy()}),$('#change-password-page #change-password-cancel').get(0).ej2_instances[0].destroy(),$('#change-password-page #change-password-update').get(0).ej2_instances[0].destroy(),$('#change-password-page #change-password-view-button').get(0).ej2_instances[0].destroy(),utopiasoftware[utopiasoftware_app_namespace].controller.changePasswordPageViewModel.changePasswordFormValidator.destroy()},backButtonClicked:function e(){$('#app-main-navigator').get(0).popPage()},passwordVisibilityButtonClicked:function t(e,a){if(!$(e).hasClass('e-active')){$(document.getElementById(a)).attr('type','text');var o=e.ej2_instances[0];o.iconCss='zmdi zmdi-eye-off',o.dataBind()}else{$(document.getElementById(a)).attr('type','password');var s=e.ej2_instances[0];s.iconCss='zmdi zmdi-eye',s.dataBind()}},scrollAndResizeEventListener:function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:window.setTimeout(function(){$('#change-password-page #change-password-form ons-input').each(function(e,a){document.getElementById('change-password-form').ej2_instances[e].refresh(a)})},0);case 1:case'end':return e.stop();}},e,this)}));return function a(){return e.apply(this,arguments)}}(),updateButtonClicked:function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:utopiasoftware[utopiasoftware_app_namespace].controller.changePasswordPageViewModel.changePasswordFormValidator.whenValidate();case 1:case'end':return e.stop();}},e,this)}));return function a(){return e.apply(this,arguments)}}(),changePasswordFormValidated:function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){var a,t,o,s,i,n,p,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(navigator.connection.type!==Connection.NONE){e.next=10;break}return $('.page-toast').get(0).ej2_instances[0].hide('All'),$('.timed-page-toast').get(0).ej2_instances[0].hide('All'),a=$('.timed-page-toast').get(0).ej2_instances[0],a.cssClass='error-ej2-toast',a.timeOut=3e3,a.content='Connect to the Internet to change password',a.dataBind(),a.show(),e.abrupt('return');case 10:return $('#change-password-page #change-password-update').attr('disabled',!0),$('#change-password-page #change-password-update').get(0).ej2_instances[0].cssClass='',$('#change-password-page #change-password-update').get(0).ej2_instances[0].dataBind(),$('#change-password-page #change-password-update').get(0).ej2_instances[0].start(),$('#change-password-page .modal').css('display','table'),t=[],o=null,e.prev=17,e.next=20,utopiasoftware[utopiasoftware_app_namespace].databaseOperations.loadData('user-details',utopiasoftware[utopiasoftware_app_namespace].model.encryptedAppDatabase);case 20:return s=e.sent.userDetails,console.log('USER DETAILS BEFORE PASSWORD CHANGE',s),e.prev=22,e.next=25,Promise.resolve($.ajax({url:utopiasoftware[utopiasoftware_app_namespace].model.appBaseUrl+'/wp-json',type:'get',beforeSend:function a(e){e.setRequestHeader('Authorization','Basic '+Base64.encode(s.email+':'+jQuery('#change-password-current-password').val().trim()))},dataType:'json',timeout:24e4,processData:!1}));case 25:e.next=30;break;case 27:throw e.prev=27,e.t0=e['catch'](22),{responseText:JSON.stringify({message:'current password is incorrect.'})};case 30:return i=s.id,delete s.billing,delete s.shipping,s.password=$('#change-password-page #change-password-form #change-password-new-password').val().trim(),t.push(Promise.resolve($.ajax({url:utopiasoftware[utopiasoftware_app_namespace].model.appBaseUrl+('/wp-json/wc/v3/customers/'+i),type:'put',contentType:'application/json',beforeSend:function a(e){e.setRequestHeader('Authorization','Basic '+utopiasoftware[utopiasoftware_app_namespace].accessor)},dataType:'json',timeout:24e4,processData:!1,data:JSON.stringify(s)}))),o=Promise.all(t),e.next=38,o;case 38:return n=e.sent,n[0].password=$('#change-password-page #change-password-form #change-password-new-password').val().trim(),console.log('PASSWORD CHANGED',n[0]),e.next=43,utopiasoftware[utopiasoftware_app_namespace].databaseOperations.saveData({_id:'user-details',docType:'USER_DETAILS',userDetails:n[0]},utopiasoftware[utopiasoftware_app_namespace].model.encryptedAppDatabase);case 43:$('.page-toast').get(0).ej2_instances[0].hide('All'),$('.timed-page-toast').get(0).ej2_instances[0].hide('All'),p=$('.timed-page-toast').get(0).ej2_instances[0],p.cssClass='success-ej2-toast',p.timeOut=3e3,p.content='User password changed',p.dataBind(),p.show(),e.next=64;break;case 53:e.prev=53,e.t1=e['catch'](17),e.t1=JSON.parse(e.t1.responseText),$('.page-toast').get(0).ej2_instances[0].hide('All'),$('.timed-page-toast').get(0).ej2_instances[0].hide('All'),r=$('.timed-page-toast').get(0).ej2_instances[0],r.cssClass='error-ej2-toast',r.timeOut=3e3,r.content='User password change failed. '+(e.t1.message||''),r.dataBind(),r.show();case 64:return e.prev=64,$('#change-password-page #change-password-update').removeAttr('disabled'),$('#change-password-page #change-password-update').get(0).ej2_instances[0].cssClass='e-hide-spinner',$('#change-password-page #change-password-update').get(0).ej2_instances[0].dataBind(),$('#change-password-page #change-password-update').get(0).ej2_instances[0].stop(),$('#change-password-page .modal').css('display','none'),e.finish(64);case 71:return e.abrupt('return',o);case 72:case'end':return e.stop();}},e,this,[[17,53,64,71],[22,27]])}));return function a(){return e.apply(this,arguments)}}()},billingInfoPageViewModel:{billingInfoFormValidator:null,pageInit:function o(e){var a=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){var o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(ons.isReady()&&!1!==utopiasoftware[utopiasoftware_app_namespace].model.isAppReady){e.next=3;break}return setTimeout(a,500),e.abrupt('return');case 3:return $('#app-main-navigator').get(0).topPage.onDeviceBackButton=utopiasoftware[utopiasoftware_app_namespace].controller.billingInfoPageViewModel.backButtonClicked,utopiasoftware[utopiasoftware_app_namespace].controller.billingInfoPageViewModel.billingInfoFormValidator=$('#billing-info-page #billing-info-form').parsley(),$('#billing-info-page #billing-info-form #billing-info-country').parsley({value:function e(){return $('#billing-info-country').get(0).ej2_instances[0].value}}),$('#billing-info-page #billing-info-form #billing-info-state').parsley({value:function a(){var e=$('#billing-info-state').get(0).ej2_instances[0];return!0===e.enabled?e.value:' '}}),utopiasoftware[utopiasoftware_app_namespace].controller.billingInfoPageViewModel.billingInfoFormValidator.on('field:error',function(e){var a=$('#billing-info-page #billing-info-form').get(0).ej2_instances[e.$element.get(0)._utopiasoftware_validator_index];a.content=e.getErrorsMessages()[0],a.dataBind(),a.open(e.$element.get(0))}),utopiasoftware[utopiasoftware_app_namespace].controller.billingInfoPageViewModel.billingInfoFormValidator.on('field:success',function(e){var a=$('#billing-info-page #billing-info-form').get(0).ej2_instances[e.$element.get(0)._utopiasoftware_validator_index];a.close()}),utopiasoftware[utopiasoftware_app_namespace].controller.billingInfoPageViewModel.billingInfoFormValidator.on('form:success',utopiasoftware[utopiasoftware_app_namespace].controller.billingInfoPageViewModel.billingInfoFormValidated),$('#billing-info-page .content').on('scroll',utopiasoftware[utopiasoftware_app_namespace].controller.billingInfoPageViewModel.scrollAndResizeEventListener),e.prev=11,new ej.buttons.Button({}).appendTo('#billing-info-cancel'),new ej.splitbuttons.ProgressButton({cssClass:'e-hide-spinner',duration:36000000}).appendTo('#billing-info-update'),o=[],e.next=17,Promise.resolve($.ajax({url:'country-list.json',type:'get',beforeSend:function a(e){e.setRequestHeader('Authorization','Basic '+utopiasoftware[utopiasoftware_app_namespace].accessor)},dataType:'json',timeout:24e4,processData:!0,data:{}}));case 17:return o=e.sent,$('#billing-info-form textarea, #billing-info-form ons-input, #billing-info-form #billing-info-country, #billing-info-form #billing-info-state',t).each(function(e,a){a._utopiasoftware_validator_index=e,new ej.popups.Tooltip({cssClass:'utopiasoftware-ej2-validation-tooltip',position:'TopLeft',opensOn:'Custom'}).appendTo($('#billing-info-page #billing-info-form').get(0))}),new ej.dropdowns.DropDownList({cssClass:'billing-info-dropdownlist',dataSource:o,fields:{value:'code',text:'name'},placeholder:'Country',floatLabelType:'Auto',value:'NG',itemTemplate:'<span>${name}</span>',valueTemplate:'<span>${name}</span>'}).appendTo('#billing-info-country'),new ej.dropdowns.DropDownList({cssClass:'billing-info-dropdownlist',dataSource:o.find(function(e){return'NG'===e.code}).states,fields:{value:'code',text:'name'},placeholder:'State',floatLabelType:'Auto',itemTemplate:'<span>${name}</span>',valueTemplate:'<span>${name}</span>',select:function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:window.setTimeout(function(){$('#billing-info-page #billing-info-form').get(0).ej2_instances[$('#billing-info-state').get(0)._utopiasoftware_validator_index].close()},0);case 1:case'end':return e.stop();}},e,this)}));return function a(){return e.apply(this,arguments)}}()}).appendTo('#billing-info-state'),e.next=23,utopiasoftware[utopiasoftware_app_namespace].controller.billingInfoPageViewModel.displayContent();case 23:e.next=28;break;case 25:e.prev=25,e.t0=e['catch'](11),console.log('BILLING ADDRESS ERROR',e.t0);case 28:return e.prev=28,e.finish(28);case 30:case'end':return e.stop();}},e,this,[[11,25,28,30]])}));return function(){return e.apply(this,arguments)}}(),t=$(e.target);a()},pageShow:function e(){window.SoftInputMode.set('adjustResize'),$('#billing-info-page .cart-count').html(utopiasoftware[utopiasoftware_app_namespace].model.cartCount),window.addEventListener('resize',utopiasoftware[utopiasoftware_app_namespace].controller.billingInfoPageViewModel.scrollAndResizeEventListener,!1)},pageHide:function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:$('#billing-info-page #billing-info-form').get(0).ej2_instances.forEach(function(e){e.close()}),utopiasoftware[utopiasoftware_app_namespace].controller.billingInfoPageViewModel.billingInfoFormValidator.reset(),window.removeEventListener('resize',utopiasoftware[utopiasoftware_app_namespace].controller.billingInfoPageViewModel.scrollAndResizeEventListener,!1);case 3:case'end':return e.stop();}},e,this)}));return function a(){return e.apply(this,arguments)}}(),pageDestroy:function e(){$('#billing-info-page #billing-info-form').get(0).ej2_instances.forEach(function(e){e.destroy()}),$('#billing-info-page #billing-info-country').get(0).ej2_instances[0].destroy(),$('#billing-info-page #billing-info-state').get(0).ej2_instances[0].destroy(),$('#billing-info-page #billing-info-cancel').get(0).ej2_instances[0].destroy(),$('#billing-info-page #billing-info-update').get(0).ej2_instances[0].destroy(),utopiasoftware[utopiasoftware_app_namespace].controller.billingInfoPageViewModel.billingInfoFormValidator.destroy()},backButtonClicked:function e(){$('#app-main-navigator').get(0).popPage()},scrollAndResizeEventListener:function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:window.setTimeout(function(){$('#billing-info-form textarea, #billing-info-form ons-input, #billing-info-form #billing-info-country, #billing-info-form #billing-info-state').each(function(e,a){document.getElementById('billing-info-form').ej2_instances[e].refresh(a)})},0);case 1:case'end':return e.stop();}},e,this)}));return function a(){return e.apply(this,arguments)}}(),updateButtonClicked:function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:utopiasoftware[utopiasoftware_app_namespace].controller.billingInfoPageViewModel.billingInfoFormValidator.whenValidate();case 1:case'end':return e.stop();}},e,this)}));return function a(){return e.apply(this,arguments)}}(),billingInfoFormValidated:function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){var a,t,o,s,i,n,p,r,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(navigator.connection.type!==Connection.NONE){e.next=10;break}return $('.page-toast').get(0).ej2_instances[0].hide('All'),$('.timed-page-toast').get(0).ej2_instances[0].hide('All'),a=$('.timed-page-toast').get(0).ej2_instances[0],a.cssClass='error-ej2-toast',a.timeOut=3e3,a.content='Connect to the Internet to update your billing address',a.dataBind(),a.show(),e.abrupt('return');case 10:return $('#billing-info-page #billing-info-update').attr('disabled',!0),$('#billing-info-page #billing-info-update').get(0).ej2_instances[0].cssClass='',$('#billing-info-page #billing-info-update').get(0).ej2_instances[0].dataBind(),$('#billing-info-page #billing-info-update').get(0).ej2_instances[0].start(),$('#billing-info-page .modal').css('display','table'),t=[],o=null,e.prev=17,e.next=20,utopiasoftware[utopiasoftware_app_namespace].databaseOperations.loadData('user-details',utopiasoftware[utopiasoftware_app_namespace].model.encryptedAppDatabase);case 20:return s=e.sent.userDetails,console.log('USER DETAILS BEFORE BILLING INFO UPDATE',s),i=s.id,n=s.password,s.billing||(s.billing={}),s.billing.email=s.email,s.billing.company=$('#billing-info-page #billing-info-company').val().trim(),s.billing.address_1=$('#billing-info-page #billing-info-address-1').val().trim(),s.billing.address_2=$('#billing-info-page #billing-info-address-2').val().trim(),s.billing.postcode=$('#billing-info-page #billing-info-postcode').val().trim(),s.billing.city=$('#billing-info-page #billing-info-city').val().trim(),s.billing.country=$('#billing-info-page #billing-info-country').get(0).ej2_instances[0].value,s.billing.state=$('#billing-info-page #billing-info-state').get(0).ej2_instances[0].value?$('#billing-info-page #billing-info-state').get(0).ej2_instances[0].value:'',delete s.id,delete s.password,t.push(Promise.resolve($.ajax({url:utopiasoftware[utopiasoftware_app_namespace].model.appBaseUrl+('/wp-json/wc/v3/customers/'+i),type:'put',contentType:'application/json',beforeSend:function a(e){e.setRequestHeader('Authorization','Basic '+utopiasoftware[utopiasoftware_app_namespace].accessor)},dataType:'json',timeout:24e4,processData:!1,data:JSON.stringify(s)}))),o=Promise.all(t),e.next=39,o;case 39:return p=e.sent,p[0].password=n,e.next=43,utopiasoftware[utopiasoftware_app_namespace].databaseOperations.saveData({_id:'user-details',docType:'USER_DETAILS',userDetails:p[0]},utopiasoftware[utopiasoftware_app_namespace].model.encryptedAppDatabase);case 43:$('.page-toast').get(0).ej2_instances[0].hide('All'),$('.timed-page-toast').get(0).ej2_instances[0].hide('All'),r=$('.timed-page-toast').get(0).ej2_instances[0],r.cssClass='success-ej2-toast',r.timeOut=3e3,r.content='User billing address updated',r.dataBind(),r.show(),e.next=64;break;case 53:e.prev=53,e.t0=e['catch'](17),e.t0=JSON.parse(e.t0.responseText),$('.page-toast').get(0).ej2_instances[0].hide('All'),$('.timed-page-toast').get(0).ej2_instances[0].hide('All'),c=$('.timed-page-toast').get(0).ej2_instances[0],c.cssClass='error-ej2-toast',c.timeOut=3e3,c.content='User billing address update failed. '+(e.t0.message||''),c.dataBind(),c.show();case 64:return e.prev=64,$('#billing-info-page #billing-info-update').removeAttr('disabled'),$('#billing-info-page #billing-info-update').get(0).ej2_instances[0].cssClass='e-hide-spinner',$('#billing-info-page #billing-info-update').get(0).ej2_instances[0].dataBind(),$('#billing-info-page #billing-info-update').get(0).ej2_instances[0].stop(),$('#billing-info-page .modal').css('display','none'),e.finish(64);case 71:return e.abrupt('return',o);case 72:case'end':return e.stop();}},e,this,[[17,53,64,71]])}));return function a(){return e.apply(this,arguments)}}(),displayContent:function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){var a,t,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,utopiasoftware[utopiasoftware_app_namespace].databaseOperations.loadData('user-details',utopiasoftware[utopiasoftware_app_namespace].model.encryptedAppDatabase);case 3:a=e.sent.userDetails,console.log('USER DETAILS',a),$('#billing-info-page #billing-info-form #billing-info-company').val(a.billing&&a.billing.company?a.billing.company:''),$('#billing-info-page #billing-info-form #billing-info-address-1').val(a.billing&&a.billing.address_1?a.billing.address_1:''),$('#billing-info-page #billing-info-form #billing-info-address-2').val(a.billing&&a.billing.address_2?a.billing.address_2:''),$('#billing-info-page #billing-info-form #billing-info-postcode').val(a.billing&&a.billing.postcode?a.billing.postcode:''),$('#billing-info-page #billing-info-form #billing-info-city').val(a.billing&&a.billing.city?a.billing.city:''),t=$('#billing-info-page #billing-info-form #billing-info-country').get(0).ej2_instances[0],t.removeEventListener('select'),t.value=a.billing&&a.billing.country&&''!==a.billing.country?a.billing.country:'NG',t.dataBind(),o=$('#billing-info-page #billing-info-form #billing-info-state').get(0).ej2_instances[0],o.dataSource=t.dataSource.find(function(e){return e.code===t.value}).states,o.dataBind(),o.value=a.billing&&a.billing.state&&''!==a.billing.state?a.billing.state:null,o.dataBind(),o.value?(o.enabled=!0,o.dataBind()):'NG'===t.value?(o.enabled=!0,o.dataBind()):(o.enabled=!1,o.dataBind()),console.log('STATE VALUE',o.value);case 21:return e.prev=21,$('#billing-info-page .page-preloader').css('display','none'),$('#billing-info-page .modal').css('display','none'),$('#billing-info-page #billing-info-update').removeAttr('disabled'),window.setTimeout(_asyncToGenerator(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.addEventListener('select',_asyncToGenerator(regeneratorRuntime.mark(function e(){var a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a=this,window.setTimeout(_asyncToGenerator(regeneratorRuntime.mark(function e(){var t,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=a.getDataByValue(a.value).states,o=$('#billing-info-page #billing-info-form #billing-info-state').get(0).ej2_instances[0],o.value=null,o.dataSource=t,0<t.length?o.enabled=!0:(o.enabled=!1,$('#billing-info-page #billing-info-form').get(0).ej2_instances[$('#billing-info-state').get(0)._utopiasoftware_validator_index].close()),o.dataBind();case 6:case'end':return e.stop();}},e,this)})),0);case 2:case'end':return e.stop();}},e,this)})));case 1:case'end':return e.stop();}},e,this)})),0),e.finish(21);case 27:case'end':return e.stop();}},e,this,[[0,,21,27]])}));return function a(){return e.apply(this,arguments)}}()},shippingInfoPageViewModel:{shippingInfoFormValidator:null,pageInit:function o(e){var a=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){var o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(ons.isReady()&&!1!==utopiasoftware[utopiasoftware_app_namespace].model.isAppReady){e.next=3;break}return setTimeout(a,500),e.abrupt('return');case 3:return $('#app-main-navigator').get(0).topPage.onDeviceBackButton=utopiasoftware[utopiasoftware_app_namespace].controller.shippingInfoPageViewModel.backButtonClicked,utopiasoftware[utopiasoftware_app_namespace].controller.shippingInfoPageViewModel.shippingInfoFormValidator=$('#shipping-info-page #shipping-info-form').parsley(),$('#shipping-info-page #shipping-info-form #shipping-info-country').parsley({value:function e(){return $('#shipping-info-country').get(0).ej2_instances[0].value}}),$('#shipping-info-page #shipping-info-form #shipping-info-state').parsley({value:function a(){var e=$('#shipping-info-state').get(0).ej2_instances[0];return!0===e.enabled?e.value:' '}}),utopiasoftware[utopiasoftware_app_namespace].controller.shippingInfoPageViewModel.shippingInfoFormValidator.on('field:error',function(e){var a=$('#shipping-info-page #shipping-info-form').get(0).ej2_instances[e.$element.get(0)._utopiasoftware_validator_index];a.content=e.getErrorsMessages()[0],a.dataBind(),a.open(e.$element.get(0))}),utopiasoftware[utopiasoftware_app_namespace].controller.shippingInfoPageViewModel.shippingInfoFormValidator.on('field:success',function(e){var a=$('#shipping-info-page #shipping-info-form').get(0).ej2_instances[e.$element.get(0)._utopiasoftware_validator_index];a.close()}),utopiasoftware[utopiasoftware_app_namespace].controller.shippingInfoPageViewModel.shippingInfoFormValidator.on('form:success',utopiasoftware[utopiasoftware_app_namespace].controller.shippingInfoPageViewModel.shippingInfoFormValidated),$('#shipping-info-page .content').on('scroll',utopiasoftware[utopiasoftware_app_namespace].controller.shippingInfoPageViewModel.scrollAndResizeEventListener),e.prev=11,new ej.buttons.Button({}).appendTo('#shipping-info-cancel'),new ej.splitbuttons.ProgressButton({cssClass:'e-hide-spinner',duration:36000000}).appendTo('#shipping-info-update'),o=[],e.next=17,Promise.resolve($.ajax({url:'country-list.json',type:'get',beforeSend:function a(e){e.setRequestHeader('Authorization','Basic '+utopiasoftware[utopiasoftware_app_namespace].accessor)},dataType:'json',timeout:24e4,processData:!0,data:{}}));case 17:return o=e.sent,$('#shipping-info-form textarea, #shipping-info-form ons-input, #shipping-info-form #shipping-info-country, #shipping-info-form #shipping-info-state',t).each(function(e,a){a._utopiasoftware_validator_index=e,new ej.popups.Tooltip({cssClass:'utopiasoftware-ej2-validation-tooltip',position:'TopLeft',opensOn:'Custom'}).appendTo($('#shipping-info-page #shipping-info-form').get(0))}),new ej.dropdowns.DropDownList({cssClass:'shipping-info-dropdownlist',dataSource:o,fields:{value:'code',text:'name'},placeholder:'Country',floatLabelType:'Auto',value:'NG',itemTemplate:'<span>${name}</span>',valueTemplate:'<span>${name}</span>'}).appendTo('#shipping-info-country'),new ej.dropdowns.DropDownList({cssClass:'shipping-info-dropdownlist',dataSource:o.find(function(e){return'NG'===e.code}).states,fields:{value:'code',text:'name'},placeholder:'State',floatLabelType:'Auto',itemTemplate:'<span>${name}</span>',valueTemplate:'<span>${name}</span>',select:function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:window.setTimeout(function(){$('#shipping-info-page #shipping-info-form').get(0).ej2_instances[$('#shipping-info-state').get(0)._utopiasoftware_validator_index].close()},0);case 1:case'end':return e.stop();}},e,this)}));return function a(){return e.apply(this,arguments)}}()}).appendTo('#shipping-info-state'),e.next=23,utopiasoftware[utopiasoftware_app_namespace].controller.shippingInfoPageViewModel.displayContent();case 23:e.next=28;break;case 25:e.prev=25,e.t0=e['catch'](11),console.log('SHIPPING INFO ERROR',e.t0);case 28:return e.prev=28,e.finish(28);case 30:case'end':return e.stop();}},e,this,[[11,25,28,30]])}));return function(){return e.apply(this,arguments)}}(),t=$(e.target);a()},pageShow:function e(){window.SoftInputMode.set('adjustResize'),$('#shipping-info-page .cart-count').html(utopiasoftware[utopiasoftware_app_namespace].model.cartCount),window.addEventListener('resize',utopiasoftware[utopiasoftware_app_namespace].controller.shippingInfoPageViewModel.scrollAndResizeEventListener,!1)},pageHide:function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:$('#shipping-info-page #shipping-info-form').get(0).ej2_instances.forEach(function(e){e.close()}),utopiasoftware[utopiasoftware_app_namespace].controller.shippingInfoPageViewModel.shippingInfoFormValidator.reset(),window.removeEventListener('resize',utopiasoftware[utopiasoftware_app_namespace].controller.shippingInfoPageViewModel.scrollAndResizeEventListener,!1);case 3:case'end':return e.stop();}},e,this)}));return function a(){return e.apply(this,arguments)}}(),pageDestroy:function e(){$('#shipping-info-page #shipping-info-form').get(0).ej2_instances.forEach(function(e){e.destroy()}),$('#shipping-info-page #shipping-info-country').get(0).ej2_instances[0].destroy(),$('#shipping-info-page #shipping-info-state').get(0).ej2_instances[0].destroy(),$('#shipping-info-page #shipping-info-cancel').get(0).ej2_instances[0].destroy(),$('#shipping-info-page #shipping-info-update').get(0).ej2_instances[0].destroy(),utopiasoftware[utopiasoftware_app_namespace].controller.shippingInfoPageViewModel.shippingInfoFormValidator.destroy()},backButtonClicked:function e(){$('#app-main-navigator').get(0).popPage()},scrollAndResizeEventListener:function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:window.setTimeout(function(){$('#shipping-info-form textarea, #shipping-info-form ons-input, #shipping-info-form #shipping-info-country, #shipping-info-form #shipping-info-state').each(function(e,a){document.getElementById('shipping-info-form').ej2_instances[e].refresh(a)})},0);case 1:case'end':return e.stop();}},e,this)}));return function a(){return e.apply(this,arguments)}}(),updateButtonClicked:function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:utopiasoftware[utopiasoftware_app_namespace].controller.shippingInfoPageViewModel.shippingInfoFormValidator.whenValidate();case 1:case'end':return e.stop();}},e,this)}));return function a(){return e.apply(this,arguments)}}(),shippingInfoFormValidated:function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){var a,t,o,s,i,n,p,r,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(navigator.connection.type!==Connection.NONE){e.next=10;break}return $('.page-toast').get(0).ej2_instances[0].hide('All'),$('.timed-page-toast').get(0).ej2_instances[0].hide('All'),a=$('.timed-page-toast').get(0).ej2_instances[0],a.cssClass='error-ej2-toast',a.timeOut=3e3,a.content='Connect to the Internet to update shipping information',a.dataBind(),a.show(),e.abrupt('return');case 10:return $('#shipping-info-page #shipping-info-update').attr('disabled',!0),$('#shipping-info-page #shipping-info-update').get(0).ej2_instances[0].cssClass='',$('#shipping-info-page #shipping-info-update').get(0).ej2_instances[0].dataBind(),$('#shipping-info-page #shipping-info-update').get(0).ej2_instances[0].start(),$('#shipping-info-page .modal').css('display','table'),t=[],o=null,e.prev=17,e.next=20,utopiasoftware[utopiasoftware_app_namespace].databaseOperations.loadData('user-details',utopiasoftware[utopiasoftware_app_namespace].model.encryptedAppDatabase);case 20:return s=e.sent.userDetails,console.log('USER DETAILS BEFORE SHIPPING INFO UPDATE',s),i=s.id,n=s.password,s.shipping||(s.shipping={}),s.shipping.first_name=$('#shipping-info-page #shipping-info-first-name').val().trim(),s.shipping.last_name=$('#shipping-info-page #shipping-info-last-name').val().trim(),s.shipping.company=$('#shipping-info-page #shipping-info-company').val().trim(),s.shipping.address_1=$('#shipping-info-page #shipping-info-address-1').val().trim(),s.shipping.address_2=$('#shipping-info-page #shipping-info-address-2').val().trim(),s.shipping.postcode=$('#shipping-info-page #shipping-info-postcode').val().trim(),s.shipping.city=$('#shipping-info-page #shipping-info-city').val().trim(),s.shipping.country=$('#shipping-info-page #shipping-info-country').get(0).ej2_instances[0].value,s.shipping.state=$('#shipping-info-page #shipping-info-state').get(0).ej2_instances[0].value?$('#shipping-info-page #shipping-info-state').get(0).ej2_instances[0].value:'',delete s.id,delete s.password,t.push(Promise.resolve($.ajax({url:utopiasoftware[utopiasoftware_app_namespace].model.appBaseUrl+('/wp-json/wc/v3/customers/'+i),type:'put',contentType:'application/json',beforeSend:function a(e){e.setRequestHeader('Authorization','Basic '+utopiasoftware[utopiasoftware_app_namespace].accessor)},dataType:'json',timeout:24e4,processData:!1,data:JSON.stringify(s)}))),o=Promise.all(t),e.next=40,o;case 40:return p=e.sent,p[0].password=n,e.next=44,utopiasoftware[utopiasoftware_app_namespace].databaseOperations.saveData({_id:'user-details',docType:'USER_DETAILS',userDetails:p[0]},utopiasoftware[utopiasoftware_app_namespace].model.encryptedAppDatabase);case 44:$('.page-toast').get(0).ej2_instances[0].hide('All'),$('.timed-page-toast').get(0).ej2_instances[0].hide('All'),r=$('.timed-page-toast').get(0).ej2_instances[0],r.cssClass='success-ej2-toast',r.timeOut=3e3,r.content='Shipping information updated',r.dataBind(),r.show(),e.next=65;break;case 54:e.prev=54,e.t0=e['catch'](17),e.t0=JSON.parse(e.t0.responseText),$('.page-toast').get(0).ej2_instances[0].hide('All'),$('.timed-page-toast').get(0).ej2_instances[0].hide('All'),c=$('.timed-page-toast').get(0).ej2_instances[0],c.cssClass='error-ej2-toast',c.timeOut=3e3,c.content='Shipping information update failed. '+(e.t0.message||''),c.dataBind(),c.show();case 65:return e.prev=65,$('#shipping-info-page #shipping-info-update').removeAttr('disabled'),$('#shipping-info-page #shipping-info-update').get(0).ej2_instances[0].cssClass='e-hide-spinner',$('#shipping-info-page #shipping-info-update').get(0).ej2_instances[0].dataBind(),$('#shipping-info-page #shipping-info-update').get(0).ej2_instances[0].stop(),$('#shipping-info-page .modal').css('display','none'),e.finish(65);case 72:return e.abrupt('return',o);case 73:case'end':return e.stop();}},e,this,[[17,54,65,72]])}));return function a(){return e.apply(this,arguments)}}(),displayContent:function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){var a,t,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,utopiasoftware[utopiasoftware_app_namespace].databaseOperations.loadData('user-details',utopiasoftware[utopiasoftware_app_namespace].model.encryptedAppDatabase);case 3:a=e.sent.userDetails,console.log('USER DETAILS',a),$('#shipping-info-page #shipping-info-form #shipping-info-first-name').val(a.shipping&&a.shipping.first_name?a.shipping.first_name:''),$('#shipping-info-page #shipping-info-form #shipping-info-last-name').val(a.shipping&&a.shipping.last_name?a.shipping.last_name:''),$('#shipping-info-page #shipping-info-form #shipping-info-company').val(a.shipping&&a.shipping.company?a.shipping.company:''),$('#shipping-info-page #shipping-info-form #shipping-info-address-1').val(a.shipping&&a.shipping.address_1?a.shipping.address_1:''),$('#shipping-info-page #shipping-info-form #shipping-info-address-2').val(a.shipping&&a.shipping.address_2?a.shipping.address_2:''),$('#shipping-info-page #shipping-info-form #shipping-info-postcode').val(a.shipping&&a.shipping.postcode?a.shipping.postcode:''),$('#shipping-info-page #shipping-info-form #shipping-info-city').val(a.shipping&&a.shipping.city?a.shipping.city:''),t=$('#shipping-info-page #shipping-info-form #shipping-info-country').get(0).ej2_instances[0],t.removeEventListener('select'),t.value=a.shipping&&a.shipping.country&&''!==a.shipping.country?a.shipping.country:'NG',t.dataBind(),o=$('#shipping-info-page #shipping-info-form #shipping-info-state').get(0).ej2_instances[0],o.dataSource=t.dataSource.find(function(e){return e.code===t.value}).states,o.dataBind(),o.value=a.shipping&&a.shipping.state&&''!==a.shipping.state?a.shipping.state:null,o.dataBind(),o.value?(o.enabled=!0,o.dataBind()):'NG'===t.value?(o.enabled=!0,o.dataBind()):(o.enabled=!1,o.dataBind()),console.log('STATE VALUE',o.value);case 23:return e.prev=23,$('#shipping-info-page .page-preloader').css('display','none'),$('#shipping-info-page .modal').css('display','none'),$('#shipping-info-page #shipping-info-update').removeAttr('disabled'),window.setTimeout(_asyncToGenerator(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.addEventListener('select',_asyncToGenerator(regeneratorRuntime.mark(function e(){var a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a=this,window.setTimeout(_asyncToGenerator(regeneratorRuntime.mark(function e(){var t,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=a.getDataByValue(a.value).states,o=$('#shipping-info-page #shipping-info-form #shipping-info-state').get(0).ej2_instances[0],o.value=null,o.dataSource=t,0<t.length?o.enabled=!0:(o.enabled=!1,$('#shipping-info-page #shipping-info-form').get(0).ej2_instances[$('#shipping-info-state').get(0)._utopiasoftware_validator_index].close()),o.dataBind();case 6:case'end':return e.stop();}},e,this)})),0);case 2:case'end':return e.stop();}},e,this)})));case 1:case'end':return e.stop();}},e,this)})),0),e.finish(23);case 29:case'end':return e.stop();}},e,this,[[0,,23,29]])}));return function a(){return e.apply(this,arguments)}}()},checkoutPageViewModel:{chekoutOrder:null,countryArray:[],shoppingZonesArray:[],updateOrderBillingDetails:!1,updateOrderShippingDetails:!1,pageInit:function o(e){var a=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){var o,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(ons.isReady()&&!1!==utopiasoftware[utopiasoftware_app_namespace].model.isAppReady){e.next=3;break}return setTimeout(a,500),e.abrupt('return');case 3:return $('#app-main-navigator').get(0).topPage.onDeviceBackButton=utopiasoftware[utopiasoftware_app_namespace].controller.checkoutPageViewModel.backButtonClicked,$('#checkout-page .content').on('scroll',utopiasoftware[utopiasoftware_app_namespace].controller.checkoutPageViewModel.scrollAndResizeEventListener),utopiasoftware[utopiasoftware_app_namespace].controller.checkoutPageViewModel.chekoutOrder=$('#app-main-navigator').get(0).topPage.data.orderData,e.prev=6,new ej.navigations.Accordion({expandMode:'Single',expanded:utopiasoftware[utopiasoftware_app_namespace].controller.checkoutPageViewModel.scrollAndResizeEventListener}).appendTo('#checkout-accordion'),new ej.dropdowns.DropDownList({cssClass:'shipping-method-dropdownlist',dataSource:[],fields:{value:'method_id',text:'title'},placeholder:'Shipping Method',floatLabelType:'Auto',enabled:!1,itemTemplate:'<span>${title}</span>',valueTemplate:'<span>${title}</span>'}).appendTo('#checkout-shipping-method-type'),new ej.dropdowns.DropDownList({cssClass:'payment-method-dropdownlist',dataSource:[],fields:{value:'id',text:'title'},placeholder:'Payment Method',floatLabelType:'Auto',enabled:!1,itemTemplate:'<span>${title}</span>',valueTemplate:'<span>${title}</span>'}).appendTo('#checkout-payment-method-type'),new ej.dropdowns.MultiSelect({cssClass:'payment-voucher-dropdownlist',dataSource:[],placeholder:'Payment Coupons',floatLabelType:'Auto',mode:'Box',showClearButton:!1,showDropDownIcon:!1,enabled:!1}).appendTo('#checkout-payment-vouchers'),new ej.splitbuttons.ProgressButton({cssClass:'e-hide-spinner',duration:36000000}).appendTo('#checkout-make-payment'),$('.utopiasoftware-checkout-failure',t).each(function(e,a){a._utopiasoftware_validator_index=e,new ej.popups.Tooltip({cssClass:'utopiasoftware-ej2-validation-tooltip',position:'TopCenter',opensOn:'Custom'}).appendTo(t.get(0))}),o=[],o.push(Promise.resolve($.ajax({url:utopiasoftware[utopiasoftware_app_namespace].model.appBaseUrl+'/wp-json/wc/v3/payment_gateways',type:'get',beforeSend:function a(e){e.setRequestHeader('Authorization','Basic '+utopiasoftware[utopiasoftware_app_namespace].accessor)},dataType:'json',timeout:24e4,processData:!0,data:{}}))),o.push(Promise.resolve($.ajax({url:utopiasoftware[utopiasoftware_app_namespace].model.appBaseUrl+'/wp-json/wc/v3/shipping/zones',type:'get',beforeSend:function a(e){e.setRequestHeader('Authorization','Basic '+utopiasoftware[utopiasoftware_app_namespace].accessor)},dataType:'json',timeout:24e4,processData:!0,data:{}}))),o.push(Promise.resolve($.ajax({url:'country-list.json',type:'get',beforeSend:function a(e){e.setRequestHeader('Authorization','Basic '+utopiasoftware[utopiasoftware_app_namespace].accessor)},dataType:'json',timeout:24e4,processData:!0,data:{}}))),o.push(utopiasoftware[utopiasoftware_app_namespace].controller.checkoutPageViewModel.createRemoteCartFromOrder()),e.next=20,Promise.all(o);case 20:o=e.sent,o[0]=o[0].filter(function(e){return!0===e.enabled}),$('#checkout-payment-method-type').get(0).ej2_instances[0].dataSource=o[0],$('#checkout-payment-method-type').get(0).ej2_instances[0].dataBind(),utopiasoftware[utopiasoftware_app_namespace].controller.checkoutPageViewModel.shoppingZonesArray=o[1],utopiasoftware[utopiasoftware_app_namespace].controller.checkoutPageViewModel.countryArray=o[2],e.next=41;break;case 28:return e.prev=28,e.t0=e['catch'](6),e.next=32,$('#app-main-navigator').get(0).popPage();case 32:console.log('CHECKOUT ERROR',e.t0),$('.page-toast').get(0).ej2_instances[0].hide('All'),$('.timed-page-toast').get(0).ej2_instances[0].hide('All'),s=$('.timed-page-toast').get(0).ej2_instances[0],s.cssClass='error-ej2-toast',s.timeOut=3e3,s.content='Error preparing checkout. Please retry',s.dataBind(),s.show();case 41:return e.prev=41,$('#checkout-page .page-preloader').css('display','none'),$('#checkout-page .modal').css('display','none'),e.finish(41);case 45:case'end':return e.stop();}},e,this,[[6,28,41,45]])}));return function(){return e.apply(this,arguments)}}(),t=$(e.target);a()},pageShow:function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){var a,t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(0!=$('#checkout-page #checkout-payment-method-type').length){e.next=2;break}return e.abrupt('return');case 2:if(a=$('#checkout-payment-method-type').get(0).ej2_instances[0],console.log('CHECKOUT DATASOURCE',a.dataSource),0!=a.dataSource.length){e.next=7;break}return window.setTimeout(utopiasoftware[utopiasoftware_app_namespace].controller.checkoutPageViewModel.pageShow,500),e.abrupt('return');case 7:return window.SoftInputMode.set('adjustResize'),window.addEventListener('resize',utopiasoftware[utopiasoftware_app_namespace].controller.checkoutPageViewModel.scrollAndResizeEventListener,!1),$('#checkout-page .page-preloader').css('display','block'),$('#checkout-page .modal').css('display','table'),e.prev=11,e.next=14,utopiasoftware[utopiasoftware_app_namespace].controller.checkoutPageViewModel.displayContent();case 14:e.next=30;break;case 16:return e.prev=16,e.t0=e['catch'](11),console.log('CHECKOUT SHOW ERROR',e.t0),$('#checkout-page .page-preloader').css('display','none'),$('#checkout-page .modal').css('display','none'),$('.page-toast').get(0).ej2_instances[0].hide('All'),$('.timed-page-toast').get(0).ej2_instances[0].hide('All'),t=$('.timed-page-toast').get(0).ej2_instances[0],t.cssClass='error-ej2-toast',t.timeOut=3e3,t.content='Checkout error. Please retry or Pull Down to refresh',t.dataBind(),t.show(),e.abrupt('return');case 30:return e.prev=30,e.next=33,utopiasoftware[utopiasoftware_app_namespace].controller.checkoutPageViewModel.validateOrderCheckout();case 33:e.next=37;break;case 35:e.prev=35,e.t1=e['catch'](30);case 37:return e.prev=37,$('#checkout-page .page-preloader').css('display','none'),$('#checkout-page .modal').css('display','none'),e.finish(37);case 41:console.log('END OF CHECKOUT SHOW');case 42:case'end':return e.stop();}},e,this,[[11,16],[30,35,37,41]])}));return function a(){return e.apply(this,arguments)}}(),pageHide:function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:window.removeEventListener('resize',utopiasoftware[utopiasoftware_app_namespace].controller.checkoutPageViewModel.scrollAndResizeEventListener,!1),$('#checkout-page').get(0).ej2_instances.forEach(function(e){e.close()}),console.log('END OF CHECKOUT HIDE');case 3:case'end':return e.stop();}},e,this)}));return function a(){return e.apply(this,arguments)}}(),pageDestroy:function e(){$('#checkout-page #checkout-shipping-method-type').get(0).ej2_instances[0].destroy(),$('#checkout-page #checkout-payment-method-type').get(0).ej2_instances[0].destroy(),$('#checkout-page #checkout-payment-vouchers').get(0).ej2_instances[0].destroy(),$('#checkout-page #checkout-make-payment').get(0).ej2_instances[0].destroy(),$('#checkout-page #checkout-accordion').get(0).ej2_instances[0].destroy(),$('#checkout-page').get(0).ej2_instances.forEach(function(e){e.destroy()}),utopiasoftware[utopiasoftware_app_namespace].controller.checkoutPageViewModel.chekoutOrder=null,utopiasoftware[utopiasoftware_app_namespace].controller.checkoutPageViewModel.countryArray=[],utopiasoftware[utopiasoftware_app_namespace].controller.checkoutPageViewModel.shoppingZonesArray=[],utopiasoftware[utopiasoftware_app_namespace].controller.checkoutPageViewModel.updateOrderBillingDetails=!1,utopiasoftware[utopiasoftware_app_namespace].controller.checkoutPageViewModel.updateOrderShippingDetails=!1},backButtonClicked:function e(){$('#app-main-navigator').get(0).popPage()},scrollAndResizeEventListener:function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:window.setTimeout(function(){$('#checkout-page .utopiasoftware-checkout-failure').each(function(e,a){document.getElementById('checkout-page').ej2_instances[e].refresh(a)})},0);case 1:case'end':return e.stop();}},e,this)}));return function a(){return e.apply(this,arguments)}}(),editBillingDetailsButtonClicked:function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:utopiasoftware[utopiasoftware_app_namespace].controller.checkoutPageViewModel.updateOrderBillingDetails=!0,$('#app-main-navigator').get(0).pushPage('billing-info-page.html');case 2:case'end':return e.stop();}},e,this)}));return function a(){return e.apply(this,arguments)}}(),editShippingDetailsButtonClicked:function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:utopiasoftware[utopiasoftware_app_namespace].controller.checkoutPageViewModel.updateOrderShippingDetails=!0,$('#app-main-navigator').get(0).pushPage('shipping-info-page.html');case 2:case'end':return e.stop();}},e,this)}));return function a(){return e.apply(this,arguments)}}(),editShippingMethodButtonClicked:function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:window.setTimeout(function(){var e=$('#checkout-page #checkout-shipping-method-type').get(0).ej2_instances[0];e.enabled=!0,e.dataBind()},0);case 1:case'end':return e.stop();}},e,this)}));return function a(){return e.apply(this,arguments)}}(),editPaymentMethodButtonClicked:function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:window.setTimeout(function(){var e=$('#checkout-page #checkout-payment-method-type').get(0).ej2_instances[0];e.enabled=!0,e.dataBind()},0);case 1:case'end':return e.stop();}},e,this)}));return function a(){return e.apply(this,arguments)}}(),applyCouponButtonClicked:function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){var a,t,o,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(navigator.connection.type!==Connection.NONE){e.next=10;break}return $('.page-toast').get(0).ej2_instances[0].hide('All'),$('.timed-page-toast').get(0).ej2_instances[0].hide('All'),a=$('.timed-page-toast').get(0).ej2_instances[0],a.cssClass='error-ej2-toast',a.timeOut=3e3,a.content='Connect to the Internet to apply coupon',a.dataBind(),a.show(),e.abrupt('return');case 10:return e.prev=10,$('#checkout-page .modal').css('display','table'),e.next=14,Promise.resolve($.ajax({url:utopiasoftware[utopiasoftware_app_namespace].model.appBaseUrl+'/wp-json/wc/v3/coupons',type:'get',beforeSend:function a(e){e.setRequestHeader('Authorization','Basic '+utopiasoftware[utopiasoftware_app_namespace].accessor)},dataType:'json',timeout:24e4,processData:!0,data:{code:$('#checkout-page #checkout-payment-voucher-code').val().trim()}}));case 14:if(t=e.sent,0!=t.length){e.next=17;break}throw'error - no coupon found';case 17:return o=JSON.parse(JSON.stringify(utopiasoftware[utopiasoftware_app_namespace].controller.checkoutPageViewModel.chekoutOrder)),o.coupon_lines=o.coupon_lines.map(function(e){return{code:e.code}}),o.coupon_lines.push({code:t[0].code}),e.next=22,Promise.resolve($.ajax({url:utopiasoftware[utopiasoftware_app_namespace].model.appBaseUrl+('/wp-json/wc/v3/orders/'+o.id),type:'put',contentType:'application/json',beforeSend:function a(e){e.setRequestHeader('Authorization','Basic '+utopiasoftware[utopiasoftware_app_namespace].accessor)},dataType:'json',timeout:24e4,processData:!1,data:JSON.stringify(o)}));case 22:return o=e.sent,utopiasoftware[utopiasoftware_app_namespace].controller.checkoutPageViewModel.chekoutOrder=o,$('#checkout-page #checkout-payment-voucher-code').val(''),e.next=27,utopiasoftware[utopiasoftware_app_namespace].controller.checkoutPageViewModel.pageShow();case 27:e.next=40;break;case 29:e.prev=29,e.t0=e['catch'](10),$('#checkout-page .modal').css('display','none'),$('.page-toast').get(0).ej2_instances[0].hide('All'),$('.timed-page-toast').get(0).ej2_instances[0].hide('All'),s=$('.timed-page-toast').get(0).ej2_instances[0],s.cssClass='error-ej2-toast',s.timeOut=3e3,s.content='Coupon not applied. Invalid coupon code',s.dataBind(),s.show();case 40:case'end':return e.stop();}},e,this,[[10,29]])}));return function a(){return e.apply(this,arguments)}}(),addNoteButtonClicked:function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){var a,t,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(navigator.connection.type!==Connection.NONE){e.next=10;break}return $('.page-toast').get(0).ej2_instances[0].hide('All'),$('.timed-page-toast').get(0).ej2_instances[0].hide('All'),a=$('.timed-page-toast').get(0).ej2_instances[0],a.cssClass='error-ej2-toast',a.timeOut=3e3,a.content='Connect to the Internet to add shipping notes to the order',a.dataBind(),a.show(),e.abrupt('return');case 10:return e.prev=10,$('#checkout-page .modal').css('display','table'),t=JSON.parse(JSON.stringify(utopiasoftware[utopiasoftware_app_namespace].controller.checkoutPageViewModel.chekoutOrder)),t.customer_note=$('#checkout-page #checkout-payment-order-note-text').val().trim(),t.coupon_lines=t.coupon_lines.map(function(e){return{code:e.code}}),e.next=17,Promise.resolve($.ajax({url:utopiasoftware[utopiasoftware_app_namespace].model.appBaseUrl+('/wp-json/wc/v3/orders/'+t.id),type:'put',contentType:'application/json',beforeSend:function a(e){e.setRequestHeader('Authorization','Basic '+utopiasoftware[utopiasoftware_app_namespace].accessor)},dataType:'json',timeout:24e4,processData:!1,data:JSON.stringify(t)}));case 17:return t=e.sent,utopiasoftware[utopiasoftware_app_namespace].controller.checkoutPageViewModel.chekoutOrder=t,$('#checkout-page #checkout-payment-order-note-text').val(''),e.next=22,utopiasoftware[utopiasoftware_app_namespace].controller.checkoutPageViewModel.pageShow();case 22:e.next=35;break;case 24:e.prev=24,e.t0=e['catch'](10),$('#checkout-page .modal').css('display','none'),$('.page-toast').get(0).ej2_instances[0].hide('All'),$('.timed-page-toast').get(0).ej2_instances[0].hide('All'),o=$('.timed-page-toast').get(0).ej2_instances[0],o.cssClass='error-ej2-toast',o.timeOut=3e3,o.content='Shipping note could not added. Please retry',o.dataBind(),o.show();case 35:case'end':return e.stop();}},e,this,[[10,24]])}));return function a(){return e.apply(this,arguments)}}(),makePaymentButtonClicked:function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){var a,t,o,s,i,n,p,r,c,l;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(navigator.connection.type!==Connection.NONE){e.next=14;break}return $('.page-toast').get(0).ej2_instances[0].hide('All'),$('.timed-page-toast').get(0).ej2_instances[0].hide('All'),a=$('.timed-page-toast').get(0).ej2_instances[0],a.cssClass='error-ej2-toast',a.timeOut=3e3,a.content='Connect to the Internet to make payment',a.dataBind(),a.show(),$('#checkout-page #checkout-make-payment').removeAttr('disabled'),$('#checkout-page #checkout-make-payment').get(0).ej2_instances[0].cssClass='e-hide-spinner',$('#checkout-page #checkout-make-payment').get(0).ej2_instances[0].dataBind(),$('#checkout-page #checkout-make-payment').get(0).ej2_instances[0].stop(),e.abrupt('return');case 14:if('paystack'!==utopiasoftware[utopiasoftware_app_namespace].controller.checkoutPageViewModel.chekoutOrder.payment_method){e.next=74;break}return $('#checkout-page #checkout-make-payment').attr('disabled',!0),$('#loader-modal-message').html('Preparing Payment Channel...'),$('#loader-modal').get(0).show(),e.prev=18,e.next=21,utopiasoftware[utopiasoftware_app_namespace].databaseOperations.loadData('user-details',utopiasoftware[utopiasoftware_app_namespace].model.encryptedAppDatabase);case 21:return t=e.sent.userDetails,e.next=24,Promise.resolve($.ajax({url:'https://api.paystack.co/transaction/initialize',type:'post',contentType:'application/json',beforeSend:function a(e){e.setRequestHeader('Authorization','Bearer '+Base64.decode(utopiasoftware[utopiasoftware_app_namespace].paystackAccessor))},dataType:'json',timeout:24e4,processData:!1,data:JSON.stringify({email:t.email,amount:''+100*kendo.parseFloat(utopiasoftware[utopiasoftware_app_namespace].controller.checkoutPageViewModel.chekoutOrder.total),callback_url:'https://shopoakexclusive.com/'})}));case 24:if(o=e.sent,!0!==o.status){e.next=52;break}return e.next=28,new Promise(function(e,a){var t=cordova.InAppBrowser.open(window.encodeURI(o.data.authorization_url),'_blank','location=yes,clearcache=yes,clearsessioncache=yes,closebuttoncolor=#ffffff,hardwareback=no,hidenavigationbuttons=yes,hideurlbar=yes,zoom=no,toolbarcolor=#3f51b5');t.addEventListener('loadstart',function(e){e.url.startsWith('https://shopoakexclusive.com/')&&(t._utopiasoftware_transaction_completed=!0,t._utopiasoftware_transaction_completed_url=e.url,t.close())}),t.addEventListener('loaderror',function(){t.close()}),t.addEventListener('exit',function(){!0===t._utopiasoftware_transaction_completed?e(t._utopiasoftware_transaction_completed_url):a()})});case 28:return s=e.sent,i=new URLSearchParams(s.split('?')[1]),n=i.get('reference'),$('#loader-modal-message').html('Completing Order Placement...'),p=JSON.parse(JSON.stringify(utopiasoftware[utopiasoftware_app_namespace].controller.checkoutPageViewModel.chekoutOrder)),p.transaction_id=n,p.set_paid=!0,p.coupon_lines=p.coupon_lines.map(function(e){return{code:e.code}}),e.next=38,Promise.resolve($.ajax({url:utopiasoftware[utopiasoftware_app_namespace].model.appBaseUrl+('/wp-json/wc/v3/orders/'+p.id),type:'put',contentType:'application/json',beforeSend:function a(e){e.setRequestHeader('Authorization','Basic '+utopiasoftware[utopiasoftware_app_namespace].accessor)},dataType:'json',timeout:24e4,processData:!1,data:JSON.stringify(p)}));case 38:return p=e.sent,e.prev=39,e.next=42,utopiasoftware[utopiasoftware_app_namespace].databaseOperations.removeData('user-cart',utopiasoftware[utopiasoftware_app_namespace].model.appDatabase);case 42:e.next=46;break;case 44:e.prev=44,e.t0=e['catch'](39);case 46:return $('#checkout-order-placement-modal .order-number').html(p.number),$('#checkout-order-placement-modal #checkout-order-placement-modal-ok-button').get(0).onclick=_asyncToGenerator(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$('ons-splitter').get(0).content.load('app-main-template');case 2:return e.next=4,$('#checkout-order-placement-modal').get(0).hide();case 4:case'end':return e.stop();}},e,this)})),e.next=50,$('#checkout-order-placement-modal').get(0).show();case 50:e.next=53;break;case 52:throw'error';case 53:e.next=66;break;case 55:e.prev=55,e.t1=e['catch'](18),console.log('PAYMENT ERROR',e.t1),$('.page-toast').get(0).ej2_instances[0].hide('All'),$('.timed-page-toast').get(0).ej2_instances[0].hide('All'),r=$('.timed-page-toast').get(0).ej2_instances[0],r.cssClass='error-ej2-toast',r.timeOut=3500,r.content='Error making payment for this order. Try again',r.dataBind(),r.show();case 66:return e.prev=66,$('#checkout-page #checkout-make-payment').removeAttr('disabled'),$('#checkout-page #checkout-make-payment').get(0).ej2_instances[0].cssClass='e-hide-spinner',$('#checkout-page #checkout-make-payment').get(0).ej2_instances[0].dataBind(),$('#checkout-page #checkout-make-payment').get(0).ej2_instances[0].stop(),$('#loader-modal').get(0).hide(),e.finish(66);case 73:return e.abrupt('return');case 74:if('cod'!==utopiasoftware[utopiasoftware_app_namespace].controller.checkoutPageViewModel.chekoutOrder.payment_method){e.next=118;break}return $('#checkout-page #checkout-make-payment').attr('disabled',!0),$('#loader-modal-message').html('Completing Order Placement...'),e.next=79,$('#loader-modal').get(0).show();case 79:return e.prev=79,c=JSON.parse(JSON.stringify(utopiasoftware[utopiasoftware_app_namespace].controller.checkoutPageViewModel.chekoutOrder)),c.status='processing',c.coupon_lines=c.coupon_lines.map(function(e){return{code:e.code}}),e.next=85,Promise.resolve($.ajax({url:utopiasoftware[utopiasoftware_app_namespace].model.appBaseUrl+('/wp-json/wc/v3/orders/'+c.id),type:'put',contentType:'application/json',beforeSend:function a(e){e.setRequestHeader('Authorization','Basic '+utopiasoftware[utopiasoftware_app_namespace].accessor)},dataType:'json',timeout:24e4,processData:!1,data:JSON.stringify(c)}));case 85:return c=e.sent,e.prev=86,e.next=89,utopiasoftware[utopiasoftware_app_namespace].databaseOperations.removeData('user-cart',utopiasoftware[utopiasoftware_app_namespace].model.appDatabase);case 89:e.next=93;break;case 91:e.prev=91,e.t2=e['catch'](86);case 93:return $('#checkout-order-placement-modal .order-number').html(c.number),$('#checkout-order-placement-modal #checkout-order-placement-modal-ok-button').get(0).onclick=_asyncToGenerator(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$('ons-splitter').get(0).content.load('app-main-template');case 2:return e.next=4,$('#checkout-order-placement-modal').get(0).hide();case 4:case'end':return e.stop();}},e,this)})),e.next=97,$('#checkout-order-placement-modal').get(0).show();case 97:e.next=110;break;case 99:e.prev=99,e.t3=e['catch'](79),console.log('PAYMENT ERROR',e.t3),$('.page-toast').get(0).ej2_instances[0].hide('All'),$('.timed-page-toast').get(0).ej2_instances[0].hide('All'),l=$('.timed-page-toast').get(0).ej2_instances[0],l.cssClass='error-ej2-toast',l.timeOut=3500,l.content='Error placing this order. Try again',l.dataBind(),l.show();case 110:return e.prev=110,$('#checkout-page #checkout-make-payment').removeAttr('disabled'),$('#checkout-page #checkout-make-payment').get(0).ej2_instances[0].cssClass='e-hide-spinner',$('#checkout-page #checkout-make-payment').get(0).ej2_instances[0].dataBind(),$('#checkout-page #checkout-make-payment').get(0).ej2_instances[0].stop(),$('#loader-modal').get(0).hide(),e.finish(110);case 117:return e.abrupt('return');case 118:case'end':return e.stop();}},e,this,[[18,55,66,73],[39,44],[79,99,110,117],[86,91]])}));return function a(){return e.apply(this,arguments)}}(),displayContent:function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){var a,t,o,s,i,n,p,r,c,l,d,g,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,utopiasoftware[utopiasoftware_app_namespace].databaseOperations.loadData('user-details',utopiasoftware[utopiasoftware_app_namespace].model.encryptedAppDatabase);case 3:return a=e.sent.userDetails,!0===utopiasoftware[utopiasoftware_app_namespace].controller.checkoutPageViewModel.updateOrderBillingDetails&&(utopiasoftware[utopiasoftware_app_namespace].controller.checkoutPageViewModel.chekoutOrder.billing=a.billing,utopiasoftware[utopiasoftware_app_namespace].controller.checkoutPageViewModel.updateOrderBillingDetails=!1),!0===utopiasoftware[utopiasoftware_app_namespace].controller.checkoutPageViewModel.updateOrderShippingDetails&&(utopiasoftware[utopiasoftware_app_namespace].controller.checkoutPageViewModel.chekoutOrder.shipping=a.shipping,utopiasoftware[utopiasoftware_app_namespace].controller.checkoutPageViewModel.chekoutOrder.shipping_lines[0]=utopiasoftware[utopiasoftware_app_namespace].controller.checkoutPageViewModel.chekoutOrder.shipping_lines[0]||{},Object.assign(utopiasoftware[utopiasoftware_app_namespace].controller.checkoutPageViewModel.chekoutOrder.shipping_lines[0],{method_id:'',method_title:'',instance_id:''}),utopiasoftware[utopiasoftware_app_namespace].controller.checkoutPageViewModel.chekoutOrder.shipping_lines[0].total='',utopiasoftware[utopiasoftware_app_namespace].controller.checkoutPageViewModel.updateOrderShippingDetails=!1),t=utopiasoftware[utopiasoftware_app_namespace].controller.checkoutPageViewModel.chekoutOrder,console.log('CHECK OUT USER DETAILS',a),$('#checkout-page #checkout-personal-details-email').html(a.email),$('#checkout-page #checkout-personal-details-first-name').html(a.first_name),$('#checkout-page #checkout-personal-details-last-name').html(a.last_name),$('#checkout-page #checkout-billing-information-address').html(t.billing.address_1),$('#checkout-page #checkout-billing-information-city').html(t.billing.city),$('#checkout-page #checkout-shipping-information-first-name').html(t.shipping.first_name),$('#checkout-page #checkout-shipping-information-last-name').html(t.shipping.last_name),$('#checkout-page #checkout-shipping-information-address').html(t.shipping.address_1),$('#checkout-page #checkout-shipping-information-city').html(t.shipping.city),o=''==t.shipping.country?'NG':t.shipping.country,s=0,i=utopiasoftware[utopiasoftware_app_namespace].controller.checkoutPageViewModel.countryArray.find(function(e){return e.code===o}),i&&(n=utopiasoftware[utopiasoftware_app_namespace].controller.checkoutPageViewModel.shoppingZonesArray.find(function(e){return e.name===i.name}),n&&(s=n.id)),e.next=23,Promise.resolve($.ajax({url:utopiasoftware[utopiasoftware_app_namespace].model.appBaseUrl+('/wp-json/wc/v3/shipping/zones/'+s+'/methods'),type:'get',beforeSend:function a(e){e.setRequestHeader('Authorization','Basic '+utopiasoftware[utopiasoftware_app_namespace].accessor)},dataType:'json',timeout:24e4,processData:!0,data:{}}));case 23:for(p=e.sent,p=p.filter(function(e){return!0===e.enabled}),r=$('#checkout-shipping-method-type').get(0).ej2_instances[0],r.removeEventListener('select'),r.dataSource=p,0<t.shipping_lines.length&&(r.value=t.shipping_lines[0].method_id,''===r.value&&(r.value=null)),r.dataBind(),r.addEventListener('select',function(){window.setTimeout(_asyncToGenerator(regeneratorRuntime.mark(function e(){var t,o,s,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(navigator.connection.type!==Connection.NONE){e.next=10;break}return $('.page-toast').get(0).ej2_instances[0].hide('All'),$('.timed-page-toast').get(0).ej2_instances[0].hide('All'),t=$('.timed-page-toast').get(0).ej2_instances[0],t.cssClass='error-ej2-toast',t.timeOut=3e3,t.content='Connect to the Internet to change shipping method',t.dataBind(),t.show(),e.abrupt('return');case 10:return $('#checkout-page .modal').css('display','table'),o=JSON.parse(JSON.stringify(utopiasoftware[utopiasoftware_app_namespace].controller.checkoutPageViewModel.chekoutOrder)),o.shipping_lines[0]=o.shipping_lines[0]||{},Object.assign(o.shipping_lines[0],{method_id:r.value,method_title:r.text,instance_id:''+r.getDataByValue(r.value).instance_id}),o.coupon_lines=o.coupon_lines.map(function(e){return{code:e.code}}),e.prev=15,e.next=18,Promise.resolve($.ajax({url:utopiasoftware[utopiasoftware_app_namespace].model.appBaseUrl+'/oakscripts/setshipping.php',type:'post',beforeSend:function t(e){e.setRequestHeader('Authorization','Basic '+Base64.encode(a.email+':'+a.password))},crossDomain:!0,xhrFields:{withCredentials:!0},dataType:'text',timeout:24e4,processData:!0,data:{id:r.getDataByValue(r.value).instance_id,method_id:r.getDataByValue(r.value).method_id}}));case 18:return e.next=20,Promise.resolve($.ajax({url:utopiasoftware[utopiasoftware_app_namespace].model.appBaseUrl+'/wp-json/wc/v2/cart/calculate',type:'post',contentType:'application/json',beforeSend:function t(e){e.setRequestHeader('Authorization','Basic '+Base64.encode(a.email+':'+a.password))},crossDomain:!0,xhrFields:{withCredentials:!0},dataType:'text',timeout:24e4,processData:!0,data:{}}));case 20:return e.next=22,Promise.resolve($.ajax({url:utopiasoftware[utopiasoftware_app_namespace].model.appBaseUrl+'/wp-json/wc/v2/cart/totals',type:'get',contentType:'application/json',beforeSend:function t(e){e.setRequestHeader('Authorization','Basic '+Base64.encode(a.email+':'+a.password))},crossDomain:!0,xhrFields:{withCredentials:!0},dataType:'json',timeout:24e4,processData:!0,data:{}}));case 22:return s=e.sent,o.shipping_lines[0].total=''+s.shipping_total,e.next=26,Promise.resolve($.ajax({url:utopiasoftware[utopiasoftware_app_namespace].model.appBaseUrl+('/wp-json/wc/v3/orders/'+o.id),type:'put',contentType:'application/json',beforeSend:function a(e){e.setRequestHeader('Authorization','Basic '+utopiasoftware[utopiasoftware_app_namespace].accessor)},dataType:'json',timeout:24e4,processData:!1,data:JSON.stringify(o)}));case 26:return o=e.sent,utopiasoftware[utopiasoftware_app_namespace].controller.checkoutPageViewModel.chekoutOrder=o,r.enabled=!1,r.dataBind(),e.next=32,utopiasoftware[utopiasoftware_app_namespace].controller.checkoutPageViewModel.pageShow();case 32:e.next=47;break;case 34:e.prev=34,e.t0=e['catch'](15),console.log('CHECKOUT SHIPPING METHOD UPDATE ERROR',e.t0),e.t0=JSON.parse(e.t0.responseText.trim()),$('.page-toast').get(0).ej2_instances[0].hide('All'),$('.timed-page-toast').get(0).ej2_instances[0].hide('All'),i=$('.timed-page-toast').get(0).ej2_instances[0],i.cssClass='error-ej2-toast',i.timeOut=3e3,i.content='Shipping method not updated, retry. '+(e.t0.message||''),i.dataBind(),i.show(),$('#checkout-page .modal').css('display','none');case 47:case'end':return e.stop();}},e,this,[[15,34]])})),0)}),c=$('#checkout-payment-method-type').get(0).ej2_instances[0],c.removeEventListener('select'),c.value=t.payment_method,c.dataBind(),c.addEventListener('select',function(){window.setTimeout(_asyncToGenerator(regeneratorRuntime.mark(function e(){var a,t,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(navigator.connection.type!==Connection.NONE){e.next=10;break}return $('.page-toast').get(0).ej2_instances[0].hide('All'),$('.timed-page-toast').get(0).ej2_instances[0].hide('All'),a=$('.timed-page-toast').get(0).ej2_instances[0],a.cssClass='error-ej2-toast',a.timeOut=3e3,a.content='Connect to the Internet to change payment method',a.dataBind(),a.show(),e.abrupt('return');case 10:return $('#checkout-page .modal').css('display','table'),t=JSON.parse(JSON.stringify(utopiasoftware[utopiasoftware_app_namespace].controller.checkoutPageViewModel.chekoutOrder)),t.payment_method=c.value,t.payment_method_title=c.text,t.coupon_lines=t.coupon_lines.map(function(e){return{code:e.code}}),e.prev=15,e.next=18,Promise.resolve($.ajax({url:utopiasoftware[utopiasoftware_app_namespace].model.appBaseUrl+('/wp-json/wc/v3/orders/'+t.id),type:'put',contentType:'application/json',beforeSend:function a(e){e.setRequestHeader('Authorization','Basic '+utopiasoftware[utopiasoftware_app_namespace].accessor)},dataType:'json',timeout:24e4,processData:!1,data:JSON.stringify(t)}));case 18:return t=e.sent,utopiasoftware[utopiasoftware_app_namespace].controller.checkoutPageViewModel.chekoutOrder=t,c.enabled=!1,c.dataBind(),e.next=24,utopiasoftware[utopiasoftware_app_namespace].controller.checkoutPageViewModel.pageShow();case 24:e.next=39;break;case 26:e.prev=26,e.t0=e['catch'](15),console.log('CHECKOUT PAYMENT METHOD UPDATE ERROR',e.t0),e.t0=JSON.parse(e.t0.responseText),$('.page-toast').get(0).ej2_instances[0].hide('All'),$('.timed-page-toast').get(0).ej2_instances[0].hide('All'),o=$('.timed-page-toast').get(0).ej2_instances[0],o.cssClass='error-ej2-toast',o.timeOut=3e3,o.content='Payment method not updated, retry. '+(e.t0.message||''),o.dataBind(),o.show(),$('#checkout-page .modal').css('display','none');case 39:case'end':return e.stop();}},e,this,[[15,26]])})),0)}),l=$('#checkout-payment-vouchers').get(0).ej2_instances[0],d=t.coupon_lines.map(function(e){return e.code}),l.dataSource=d,l.value=d,l.dataBind(),$('#checkout-page #checkout-payment-order-note-text').val(t.customer_note),g='',u=0;u<t.line_items.length;u++)g+='<div class="col-xs-6" style="text-align: right; padding-right: 5px;\n                        padding-top: 10px; padding-bottom: 10px">'+t.line_items[u].name+'</div>\n                        <div class="col-xs-2" style="text-align: left;\n                        padding-top: 10px; padding-bottom: 10px">&times;'+t.line_items[u].quantity+'</div>\n                        <div class="col-xs-4" style="text-align: left; padding-left: 5px;\n                        padding-top: 10px; padding-bottom: 10px">\n                        &#x20a6;'+kendo.toString(kendo.parseFloat(t.line_items[u].subtotal),'n2')+'</div>';$('#checkout-page #checkout-order-items-container').html(g),$('#checkout-page #checkout-page-items-cost').html('&#x20a6;'+kendo.toString(kendo.parseFloat(t.total)-kendo.parseFloat(t.shipping_total)+kendo.parseFloat(t.discount_total),'n2')),$('#checkout-page #checkout-page-shipping-cost').html('&#x20a6;'+kendo.toString(kendo.parseFloat(t.shipping_total),'n2')),$('#checkout-page #checkout-page-discount-cost').html('&#x20a6;'+kendo.toString(kendo.parseFloat(t.discount_total),'n2')),$('#checkout-page #checkout-page-total-cost').html('&#x20a6;'+kendo.toString(kendo.parseFloat(t.total),'n2')),0<kendo.parseFloat(t.discount_total)?$('#checkout-page .checkout-page-discount').css('display','block'):$('#checkout-page .checkout-page-discount').css('display','none');case 50:return e.prev=50,e.finish(50);case 52:case'end':return e.stop();}},e,this,[[0,,50,52]])}));return function a(){return e.apply(this,arguments)}}(),validateOrderCheckout:function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){var a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=!0,e.abrupt('return',new Promise(function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(t,o){var s,i,n,p,r,c,l,d,g,u,m,h,_,f,w,v,y;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return $('#checkout-page #checkout-make-payment').attr('disabled',!0),s=utopiasoftware[utopiasoftware_app_namespace].controller.checkoutPageViewModel.chekoutOrder,e.prev=2,e.next=5,utopiasoftware[utopiasoftware_app_namespace].databaseOperations.loadData('user-details',utopiasoftware[utopiasoftware_app_namespace].model.encryptedAppDatabase);case 5:if(i=e.sent.userDetails,i.first_name&&''!=i.first_name){e.next=8;break}throw'validation error';case 8:$('#checkout-page .checkout-personal-details-accordion-item .utopiasoftware-checkout-success').css('display','inline-block'),$('#checkout-page .checkout-personal-details-accordion-item .utopiasoftware-checkout-failure').css('display','none'),n=$('#checkout-page .checkout-personal-details-accordion-item .utopiasoftware-checkout-failure').get(0)._utopiasoftware_validator_index,$('#checkout-page').get(0).ej2_instances[n].close(),e.next=24;break;case 14:e.prev=14,e.t0=e['catch'](2),$('#checkout-page .checkout-personal-details-accordion-item .utopiasoftware-checkout-success').css('display','none'),$('#checkout-page .checkout-personal-details-accordion-item .utopiasoftware-checkout-failure').css('display','inline-block'),p=$('#checkout-page .checkout-personal-details-accordion-item .utopiasoftware-checkout-failure').get(0)._utopiasoftware_validator_index,r=$('#checkout-page').get(0).ej2_instances[p],r.content='incomplete personal details',r.dataBind(),r.open($('#checkout-page .checkout-personal-details-accordion-item .utopiasoftware-checkout-failure').get(0)),a=!1;case 24:if(s.billing.address_1&&''!=s.billing.address_1?($('#checkout-page .checkout-billing-information-item .utopiasoftware-checkout-success').css('display','inline-block'),$('#checkout-page .checkout-billing-information-item .utopiasoftware-checkout-failure').css('display','none'),d=$('#checkout-page .checkout-billing-information-item .utopiasoftware-checkout-failure').get(0)._utopiasoftware_validator_index,$('#checkout-page').get(0).ej2_instances[d].close()):($('#checkout-page .checkout-billing-information-item .utopiasoftware-checkout-success').css('display','none'),$('#checkout-page .checkout-billing-information-item .utopiasoftware-checkout-failure').css('display','inline-block'),c=$('#checkout-page .checkout-billing-information-item .utopiasoftware-checkout-failure').get(0)._utopiasoftware_validator_index,l=$('#checkout-page').get(0).ej2_instances[c],l.content='incomplete billing details',l.dataBind(),l.open($('#checkout-page .checkout-billing-information-item .utopiasoftware-checkout-failure').get(0)),a=!1),s.shipping.address_1&&''!=s.shipping.address_1?($('#checkout-page .checkout-shipping-information-item .utopiasoftware-checkout-success').css('display','inline-block'),$('#checkout-page .checkout-shipping-information-item .utopiasoftware-checkout-failure').css('display','none'),m=$('#checkout-page .checkout-shipping-information-item .utopiasoftware-checkout-failure').get(0)._utopiasoftware_validator_index,$('#checkout-page').get(0).ej2_instances[m].close()):($('#checkout-page .checkout-shipping-information-item .utopiasoftware-checkout-success').css('display','none'),$('#checkout-page .checkout-shipping-information-item .utopiasoftware-checkout-failure').css('display','inline-block'),g=$('#checkout-page .checkout-shipping-information-item .utopiasoftware-checkout-failure').get(0)._utopiasoftware_validator_index,u=$('#checkout-page').get(0).ej2_instances[g],u.content='incomplete shipping details',u.dataBind(),u.open($('#checkout-page .checkout-shipping-information-item .utopiasoftware-checkout-failure').get(0)),a=!1),$('#checkout-page #checkout-shipping-method-type').get(0).ej2_instances[0].value?($('#checkout-page .checkout-shipping-method-item .utopiasoftware-checkout-success').css('display','inline-block'),$('#checkout-page .checkout-shipping-method-item .utopiasoftware-checkout-failure').css('display','none'),f=$('#checkout-page .checkout-shipping-method-item .utopiasoftware-checkout-failure').get(0)._utopiasoftware_validator_index,$('#checkout-page').get(0).ej2_instances[f].close()):($('#checkout-page .checkout-shipping-method-item .utopiasoftware-checkout-success').css('display','none'),$('#checkout-page .checkout-shipping-method-item .utopiasoftware-checkout-failure').css('display','inline-block'),h=$('#checkout-page .checkout-shipping-method-item .utopiasoftware-checkout-failure').get(0)._utopiasoftware_validator_index,_=$('#checkout-page').get(0).ej2_instances[h],_.content='shipping method required',_.dataBind(),_.open($('#checkout-page .checkout-shipping-method-item .utopiasoftware-checkout-failure').get(0)),a=!1),$('#checkout-page #checkout-payment-method-type').get(0).ej2_instances[0].value?($('#checkout-page .checkout-payment-method-item .utopiasoftware-checkout-success').css('display','inline-block'),$('#checkout-page .checkout-payment-method-item .utopiasoftware-checkout-failure').css('display','none'),y=$('#checkout-page .checkout-payment-method-item .utopiasoftware-checkout-failure').get(0)._utopiasoftware_validator_index,$('#checkout-page').get(0).ej2_instances[y].close()):($('#checkout-page .checkout-payment-method-item .utopiasoftware-checkout-success').css('display','none'),$('#checkout-page .checkout-payment-method-item .utopiasoftware-checkout-failure').css('display','inline-block'),w=$('#checkout-page .checkout-payment-method-item .utopiasoftware-checkout-failure').get(0)._utopiasoftware_validator_index,v=$('#checkout-page').get(0).ej2_instances[w],v.content='payment method required',v.dataBind(),v.open($('#checkout-page .checkout-payment-method-item .utopiasoftware-checkout-failure').get(0)),a=!1),!0!==a){e.next=34;break}return $('#checkout-page #checkout-make-payment').removeAttr('disabled'),t(),e.abrupt('return');case 34:return $('#checkout-page #checkout-make-payment').attr('disabled',!0),o(),e.abrupt('return');case 37:case'end':return e.stop();}},e,this,[[2,14]])}));return function(){return e.apply(this,arguments)}}()));case 2:case'end':return e.stop();}},e,this)}));return function a(){return e.apply(this,arguments)}}(),createRemoteCartFromOrder:function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){var a=0<arguments.length&&arguments[0]!==void 0?arguments[0]:utopiasoftware[utopiasoftware_app_namespace].controller.checkoutPageViewModel.chekoutOrder;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt('return',new Promise(function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(t){var o,s,i,n,p,r,c,l,d,g;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,utopiasoftware[utopiasoftware_app_namespace].databaseOperations.loadData('user-details',utopiasoftware[utopiasoftware_app_namespace].model.encryptedAppDatabase);case 3:return o=e.sent.userDetails,e.next=6,Promise.resolve($.ajax({url:utopiasoftware[utopiasoftware_app_namespace].model.appBaseUrl+'/wp-json/wc/v2/cart/clear',type:'post',contentType:'application/json',beforeSend:function a(e){e.setRequestHeader('Authorization','Basic '+Base64.encode(o.email+':'+o.password))},crossDomain:!0,xhrFields:{withCredentials:!0},dataType:'json',timeout:24e4,processData:!0,data:{}}));case 6:s=[],i=0;case 8:if(!(i<a.line_items.length)){e.next=43;break}for(console.log('1'),n={},p=!0,r=!1,c=void 0,e.prev=14,l=a.line_items[i].meta_data[Symbol.iterator]();!(p=(d=l.next()).done);p=!0)g=d.value,console.log('2'),'_fpd_data'===g.key&&(console.log('3'),!n.cart_item_data&&(n.cart_item_data={}),console.log('4'),!n.cart_item_data.fpd_data&&(n.cart_item_data.fpd_data={}),console.log('5'),n.cart_item_data.fpd_data.fpd_product=g.value,n.cart_item_data.fpd_data.fpd_product_price=''+a.line_items[i].price),'_fpd_print_order'===g.key&&(!n.cart_item_data&&(n.cart_item_data={}),!n.cart_item_data.fpd_data&&(n.cart_item_data.fpd_data={}),console.log('6'),n.cart_item_data.fpd_data.fpd_print_order=g.value);e.next=22;break;case 18:e.prev=18,e.t0=e['catch'](14),r=!0,c=e.t0;case 22:e.prev=22,e.prev=23,!p&&l.return&&l.return();case 25:if(e.prev=25,!r){e.next=28;break}throw c;case 28:return e.finish(25);case 29:return e.finish(22);case 30:return n.product_id=a.line_items[i].product_id,n.variation_id=a.line_items[i].variation_id,n.quantity=a.line_items[i].quantity,console.log('7'),e.t1=s,e.next=37,Promise.resolve($.ajax({url:utopiasoftware[utopiasoftware_app_namespace].model.appBaseUrl+'/wp-json/wc/v2/cart/add',type:'post',contentType:'application/json',beforeSend:function a(e){e.setRequestHeader('Authorization','Basic '+Base64.encode(o.email+':'+o.password))},crossDomain:!0,xhrFields:{withCredentials:!0},dataType:'json',timeout:24e4,processData:!1,data:JSON.stringify(n)}));case 37:e.t2=e.sent,e.t1.push.call(e.t1,e.t2),console.log('8');case 40:i++,e.next=8;break;case 43:return e.next=45,Promise.all(s);case 45:t();case 46:return e.prev=46,e.finish(46);case 48:case'end':return e.stop();}},e,this,[[0,,46,48],[14,18,22,30],[23,,25,29]])}));return function(){return e.apply(this,arguments)}}()));case 1:case'end':return e.stop();}},e,this)}));return function a(){return e.apply(this,arguments)}}()}};

//# sourceMappingURL=controller-compiled.js.map