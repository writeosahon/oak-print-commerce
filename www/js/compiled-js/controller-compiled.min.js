"use strict";function _toConsumableArray(arr){if(Array.isArray(arr)){for(var i=0,arr2=Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}else{return Array.from(arr)}}function _asyncToGenerator(fn){return function(){var gen=fn.apply(this,arguments);return new Promise(function(resolve,reject){function step(key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{return Promise.resolve(value).then(function(value){step("next",value)},function(err){step("throw",err)})}}return step("next")})}}utopiasoftware[utopiasoftware_app_namespace].controller={startup:function startup(){ons.ready(_asyncToGenerator(regeneratorRuntime.mark(function _callee(){var secureKey;return regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:ons.setDefaultDeviceBackButtonListener(function(){});$("#search-page-search-input-popover").get(0).onDeviceBackButton.disable();$("#loader-modal-message").html("Loading App...");$("#loader-modal").get(0).show();new ej.notifications.Toast({content:"",cssClass:"default-ej2-toast",target:document.body,position:{X:"Center",Y:"Bottom"},width:"100%",timeOut:0,extendedTimeout:0,showCloseButton:true}).appendTo($(".page-toast").get(0));new ej.notifications.Toast({content:"",cssClass:"default-ej2-toast",target:document.body,position:{X:"Center",Y:"Bottom"},width:"100%",timeOut:4e3,extendedTimeout:0,showCloseButton:true}).appendTo($(".timed-page-toast").get(0));if(true){$("ons-splitter").get(0).content.load("app-main-template")}else{$("ons-splitter").get(0).content.load("login-template")}try{screen.orientation.lock("portrait")}catch(err){}_context.prev=8;utopiasoftware[utopiasoftware_app_namespace].model.appDatabase=new PouchDB("PrintServiceEcommerce.db",{adapter:"cordova-sqlite",location:"default",androidDatabaseImplementation:2});utopiasoftware[utopiasoftware_app_namespace].model.encryptedAppDatabase=new PouchDB("PrintServiceEcommerceEncrypted.db",{adapter:"cordova-sqlite",location:"default",androidDatabaseImplementation:2});secureKey=null;_context.prev=12;_context.next=15;return new Promise(function(resolve,reject){NativeStorage.getItem("utopiasoftware-oak-print-service-secure-key",resolve,reject)});case 15:secureKey=_context.sent;_context.next=23;break;case 18:_context.prev=18;_context.t0=_context["catch"](12);_context.next=22;return new Promise(function(resolve,reject){NativeStorage.setItem("utopiasoftware-oak-print-service-secure-key",{password:Random.uuid4(utopiasoftware[utopiasoftware_app_namespace].randomisationEngine)},resolve,reject)});case 22:secureKey=_context.sent;case 23:_context.next=25;return new Promise(function(resolve,reject){utopiasoftware[utopiasoftware_app_namespace].model.encryptedAppDatabase.crypto(secureKey.password,{ignore:["_attachments","_deleted"],cb:function cb(err,key){if(err){reject(err)}else{resolve(key)}}})});case 25:_context.next=30;break;case 27:_context.prev=27;_context.t1=_context["catch"](8);console.log("APP LOADING ERROR",_context.t1);case 30:_context.prev=30;StatusBar.backgroundColorByHexString("#363E7C");navigator.splashscreen.hide();utopiasoftware[utopiasoftware_app_namespace].model.isAppReady=true;return _context.finish(30);case 35:case"end":return _context.stop()}}},_callee,this,[[8,27,30,35],[12,18]])})))},homePageViewModel:{newProductsCarousel:null,featuredProductsCarousel:null,salesProductsCarousel:null,pageInit:function pageInit(event){var loadPageOnAppReady=function(){var _ref2=_asyncToGenerator(regeneratorRuntime.mark(function _callee2(){var newProductsCarousel,featuredProductsCarousel,salesProductsCarousel,toast;return regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(!(!ons.isReady()||utopiasoftware[utopiasoftware_app_namespace].model.isAppReady===false)){_context2.next=3;break}setTimeout(loadPageOnAppReady,500);return _context2.abrupt("return");case 3:event.target.onDeviceBackButton=utopiasoftware[utopiasoftware_app_namespace].controller.homePageViewModel.backButtonClicked;$("#home-page-pull-hook",$thisPage).get(0).onAction=utopiasoftware[utopiasoftware_app_namespace].controller.homePageViewModel.pagePullHookAction;$("#home-page-pull-hook",$thisPage).on("changestate",function(event){switch(event.originalEvent.state){case"initial":$("#home-page-pull-hook-fab",event.originalEvent.pullHook).html('<ons-icon icon="md-long-arrow-down" size="24px" style="color: #363E7C"></ons-icon>');break;case"preaction":$("#home-page-pull-hook-fab",event.originalEvent.pullHook).html('<ons-icon icon="md-long-arrow-up" size="24px" style="color: #363E7C"></ons-icon>');break;case"action":$("#home-page-pull-hook-fab",event.originalEvent.pullHook).html('<ons-progress-circular indeterminate modifier="pull-hook"></ons-progress-circular>');break}});_context2.prev=6;newProductsCarousel=new Flickity($("#home-page #home-latest-design-block .row").get(0),{wrapAround:true,groupCells:1,imagesLoaded:true,cellSelector:".col-xs-12",autoPlay:5e3,pauseAutoPlayOnHover:false,dragThreshold:10,initialIndex:0,cellAlign:"left",contain:false,prevNextButtons:false,pageDots:false});newProductsCarousel.on("scroll",function(){if(newProductsCarousel._utopiasoftware_scrollTimer){window.clearTimeout(newProductsCarousel._utopiasoftware_scrollTimer);newProductsCarousel._utopiasoftware_scrollTimer=null}newProductsCarousel._utopiasoftware_scrollTimer=window.setTimeout(function(){newProductsCarousel.playPlayer()},0)});newProductsCarousel.on("staticClick",function(event,pointer,cellElement,cellIndex){if(!cellElement){return}});utopiasoftware[utopiasoftware_app_namespace].controller.homePageViewModel.newProductsCarousel=newProductsCarousel;featuredProductsCarousel=new Flickity($("#home-page #home-featured-design-block .row").get(0),{wrapAround:true,groupCells:1,cellSelector:".col-xs-7",autoPlay:4e3,pauseAutoPlayOnHover:false,dragThreshold:10,initialIndex:0,cellAlign:"center",contain:false,prevNextButtons:false,pageDots:false});featuredProductsCarousel.on("scroll",function(){if(featuredProductsCarousel._utopiasoftware_scrollTimer){window.clearTimeout(featuredProductsCarousel._utopiasoftware_scrollTimer);featuredProductsCarousel._utopiasoftware_scrollTimer=null}featuredProductsCarousel._utopiasoftware_scrollTimer=window.setTimeout(function(){featuredProductsCarousel.playPlayer()},0)});featuredProductsCarousel.on("staticClick",function(event,pointer,cellElement,cellIndex){if(!cellElement){return}utopiasoftware[utopiasoftware_app_namespace].controller.homePageViewModel.productItemClicked(window.parseInt($(cellElement).attr("data-product")),$(cellElement).attr("data-segment"))});utopiasoftware[utopiasoftware_app_namespace].controller.homePageViewModel.featuredProductsCarousel=featuredProductsCarousel;salesProductsCarousel=new Flickity($("#home-page #home-sales-design-block .row").get(0),{wrapAround:true,groupCells:1,cellSelector:".col-xs-7",autoPlay:4500,pauseAutoPlayOnHover:false,dragThreshold:10,initialIndex:0,cellAlign:"center",contain:false,prevNextButtons:false,pageDots:false});salesProductsCarousel.on("scroll",function(){if(salesProductsCarousel._utopiasoftware_scrollTimer){window.clearTimeout(salesProductsCarousel._utopiasoftware_scrollTimer);salesProductsCarousel._utopiasoftware_scrollTimer=null}salesProductsCarousel._utopiasoftware_scrollTimer=window.setTimeout(function(){salesProductsCarousel.playPlayer()},0)});salesProductsCarousel.on("staticClick",function(event,pointer,cellElement,cellIndex){if(!cellElement){return}utopiasoftware[utopiasoftware_app_namespace].controller.homePageViewModel.productItemClicked(window.parseInt($(cellElement).attr("data-product")),$(cellElement).attr("data-segment"))});utopiasoftware[utopiasoftware_app_namespace].controller.homePageViewModel.salesProductsCarousel=salesProductsCarousel;$("#loader-modal").get(0).hide();$("#home-page .page-preloader").css("display","block");_context2.next=23;return utopiasoftware[utopiasoftware_app_namespace].controller.homePageViewModel.loadProducts();case 23:$("#home-page .page-preloader").css("display","none");_context2.next=34;break;case 26:_context2.prev=26;_context2.t0=_context2["catch"](6);$(".page-toast").get(0).ej2_instances[0].hide("All");toast=$(".page-toast").get(0).ej2_instances[0];toast.cssClass="error-ej2-toast";toast.content="Sorry, an error occurred."+(navigator.connection.type===Connection.NONE?" Connect to the Internet.":"")+" Pull down to refresh and try again";toast.dataBind();toast.show();case 34:_context2.prev=34;return _context2.finish(34);case 36:case"end":return _context2.stop()}}},_callee2,this,[[6,26,34,36]])}));return function loadPageOnAppReady(){return _ref2.apply(this,arguments)}}();var $thisPage=$(event.target);loadPageOnAppReady()},pageShow:function pageShow(){$("#app-main-page ons-toolbar div.title-bar").html("OAK");window.SoftInputMode.set("adjustPan");document.addEventListener("offline",utopiasoftware[utopiasoftware_app_namespace].controller.homePageViewModel.deviceOfflineListener,false);document.addEventListener("online",utopiasoftware[utopiasoftware_app_namespace].controller.homePageViewModel.deviceOnlineListener,false);if(utopiasoftware[utopiasoftware_app_namespace].controller.homePageViewModel.newProductsCarousel){utopiasoftware[utopiasoftware_app_namespace].controller.homePageViewModel.newProductsCarousel.reloadCells()}if(utopiasoftware[utopiasoftware_app_namespace].controller.homePageViewModel.featuredProductsCarousel){utopiasoftware[utopiasoftware_app_namespace].controller.homePageViewModel.featuredProductsCarousel.reloadCells()}if(utopiasoftware[utopiasoftware_app_namespace].controller.homePageViewModel.salesProductsCarousel){utopiasoftware[utopiasoftware_app_namespace].controller.homePageViewModel.salesProductsCarousel.reloadCells()}},pageHide:function(){var _ref3=_asyncToGenerator(regeneratorRuntime.mark(function _callee3(){return regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:document.removeEventListener("offline",utopiasoftware[utopiasoftware_app_namespace].controller.homePageViewModel.deviceOfflineListener,false);document.removeEventListener("online",utopiasoftware[utopiasoftware_app_namespace].controller.homePageViewModel.deviceOnlineListener,false);case 2:case"end":return _context3.stop()}}},_callee3,this)}));function pageHide(){return _ref3.apply(this,arguments)}return pageHide}(),pageDestroy:function pageDestroy(){utopiasoftware[utopiasoftware_app_namespace].controller.homePageViewModel.newProductsCarousel.newProductsCarousel.destroy();utopiasoftware[utopiasoftware_app_namespace].controller.homePageViewModel.newProductsCarousel.newProductsCarousel=null;utopiasoftware[utopiasoftware_app_namespace].controller.homePageViewModel.newProductsCarousel.featuredProductsCarousel.destroy();utopiasoftware[utopiasoftware_app_namespace].controller.homePageViewModel.newProductsCarousel.featuredProductsCarousel=null;utopiasoftware[utopiasoftware_app_namespace].controller.homePageViewModel.newProductsCarousel.salesProductsCarousel.destroy();utopiasoftware[utopiasoftware_app_namespace].controller.homePageViewModel.newProductsCarousel.salesProductsCarousel=null},backButtonClicked:function backButtonClicked(){ons.notification.confirm("Do you want to close the app?",{title:'<img src="css/app-images/oak-design-logo.png" style="height: 1.5em; width: auto; margin-right: 0.5em">Exit App',buttonLabels:["No","Yes"],modifier:"utopiasoftware-alert-dialog utopiasoftware-oak-alert-dialog"}).then(function(index){if(index===1){navigator.app.exitApp()}})},deviceOfflineListener:function deviceOfflineListener(){var toast=$(".page-toast").get(0).ej2_instances[0];toast.hide("All");toast.cssClass="default-ej2-toast";toast.content="No Internet connection. Connect to the Internet to see live products";toast.dataBind();toast.show()},deviceOnlineListener:function deviceOnlineListener(){$(".page-toast").get(0).ej2_instances[0].hide("All")},pagePullHookAction:function(){var _ref4=_asyncToGenerator(regeneratorRuntime.mark(function _callee4(){var doneCallBack=arguments.length>0&&arguments[0]!==undefined?arguments[0]:function(){};var toast;return regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:$("#home-page #home-page-pull-hook").attr("disabled",true);$(".page-toast").get(0).ej2_instances[0].hide("All");_context4.prev=2;_context4.next=5;return utopiasoftware[utopiasoftware_app_namespace].controller.homePageViewModel.loadProducts();case 5:$("#home-page .page-preloader").css("display","none");_context4.next=16;break;case 8:_context4.prev=8;_context4.t0=_context4["catch"](2);toast=$(".page-toast").get(0).ej2_instances[0];toast.hide("All");toast.cssClass="error-ej2-toast";toast.content="Sorry, an error occurred. Refresh to try again";toast.dataBind();toast.show();case 16:_context4.prev=16;$("#home-page #home-page-pull-hook").removeAttr("disabled");doneCallBack();return _context4.finish(16);case 20:case"end":return _context4.stop()}}},_callee4,this,[[2,8,16,20]])}));function pagePullHookAction(){return _ref4.apply(this,arguments)}return pagePullHookAction}(),loadProducts:function(){var _ref5=_asyncToGenerator(regeneratorRuntime.mark(function _callee5(){var productTypesPromisesArray,toast;return regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:productTypesPromisesArray=[];if(navigator.connection.type!==Connection.NONE){productTypesPromisesArray.push(new Promise(function(resolve,reject){Promise.resolve($.ajax({url:utopiasoftware[utopiasoftware_app_namespace].model.appBaseUrl+"/wp-json/wc/v3/products",type:"get",beforeSend:function beforeSend(jqxhr){jqxhr.setRequestHeader("Authorization","Basic "+utopiasoftware[utopiasoftware_app_namespace].accessor)},dataType:"json",timeout:24e4,processData:true,data:{order:"desc",orderby:"date",status:"private",type:"external",page:1,per_page:5}})).then(function(productsArray){utopiasoftware[utopiasoftware_app_namespace].databaseOperations.saveData({_id:"banner-products",docType:"BANNER_PRODUCTS",products:productsArray},utopiasoftware[utopiasoftware_app_namespace].model.appDatabase);$("#home-page #home-latest-design-block").css("opacity","1");utopiasoftware[utopiasoftware_app_namespace].controller.homePageViewModel.newProductsCarousel.remove($("#home-page #home-latest-design-block .row .col-xs-12").get());for(var index=0;index<productsArray.length;index++){var columnContent='<div class="col-xs-12" style="padding-left: 0; padding-right: 0;">\n                                    <div class="e-card" style="min-height: 40vh; max-height: 90vh">\n                                        <div class="e-card-image" style="">\n                                        <img src="'+productsArray[index].images[0].src+'" style="width: 100%; height: auto; max-height: 90vh">\n                                        </div>\n                                    </div>\n                                </div>';utopiasoftware[utopiasoftware_app_namespace].controller.homePageViewModel.newProductsCarousel.append($(columnContent))}$("#home-page #home-latest-design-block").css("opacity","1");resolve()}).catch(function(err){$("#home-page #home-latest-design-block").css("opacity","1");reject()})}));productTypesPromisesArray.push(new Promise(function(resolve,reject){Promise.resolve($.ajax({url:utopiasoftware[utopiasoftware_app_namespace].model.appBaseUrl+"/wp-json/wc/v3/products",type:"get",beforeSend:function beforeSend(jqxhr){jqxhr.setRequestHeader("Authorization","Basic "+utopiasoftware[utopiasoftware_app_namespace].accessor)},dataType:"json",timeout:24e4,processData:true,data:{order:"desc",orderby:"date",status:"publish",type:"variable",stock_status:"instock",page:1,per_page:5,featured:true}})).then(function(productsArray){utopiasoftware[utopiasoftware_app_namespace].databaseOperations.saveData({_id:"popular-products",docType:"POPULAR_PRODUCTS",products:productsArray},utopiasoftware[utopiasoftware_app_namespace].model.appDatabase);if(productsArray.length>0){$("#home-page #home-featured-design-block").css({opacity:"1",display:"block"});utopiasoftware[utopiasoftware_app_namespace].controller.homePageViewModel.featuredProductsCarousel.remove($("#home-page #home-featured-design-block .row .col-xs-7").get())}else{$("#home-page #home-featured-design-block").css({opacity:"0",display:"none"})}for(var index=0;index<productsArray.length;index++){var columnContent='<div class="col-xs-7" style="margin-left: 20.5%; margin-right: 20.5%;" \n                                 data-product="'+index+'" data-segment="featured">\n                                    <div class="e-card" style="min-height: 34vh;">\n                                        <div class="e-card-image" style="height: 60%; \n                                        background-image: url(\''+productsArray[index].images[0].src+'\');">\n                                        </div>\n                                        <div class="e-card-header">\n                                            <div class="e-card-header-caption">\n                                                <div class="e-card-sub-title" style="color: #000000; text-align: center; font-size: 14px; text-transform: capitalize">\n                                                    '+productsArray[index].name+'\n                                                </div>\n                                                <div class="e-card-sub-title" style="text-align: center;">\n                                                &#x20a6;'+kendo.toString(kendo.parseFloat(productsArray[index].price),"n2")+"</div>\n                                            </div>\n                                        </div>\n                                    </div>\n                                </div>";utopiasoftware[utopiasoftware_app_namespace].controller.homePageViewModel.featuredProductsCarousel.append($(columnContent))}resolve()}).catch(function(err){reject()})}));productTypesPromisesArray.push(new Promise(function(resolve,reject){Promise.resolve($.ajax({url:utopiasoftware[utopiasoftware_app_namespace].model.appBaseUrl+"/wp-json/wc/v3/products",type:"get",beforeSend:function beforeSend(jqxhr){jqxhr.setRequestHeader("Authorization","Basic "+utopiasoftware[utopiasoftware_app_namespace].accessor)},dataType:"json",timeout:24e4,processData:true,data:{order:"desc",orderby:"date",status:"publish",type:"variable",stock_status:"instock",page:1,per_page:5,on_sale:true}})).then(function(productsArray){utopiasoftware[utopiasoftware_app_namespace].databaseOperations.saveData({_id:"sales-products",docType:"SALES_PRODUCTS",products:productsArray},utopiasoftware[utopiasoftware_app_namespace].model.appDatabase);if(productsArray.length>0){$("#home-page #home-sales-design-block").css({opacity:"1",display:"block"});utopiasoftware[utopiasoftware_app_namespace].controller.homePageViewModel.salesProductsCarousel.remove($("#home-page #home-sales-design-block .row .col-xs-7").get())}else{$("#home-page #home-sales-design-block").css({opacity:"0",display:"none"})}for(var index=0;index<productsArray.length;index++){if(!productsArray[index].regular_price||productsArray[index].regular_price==""){productsArray[index].regular_price="0.00"}var columnContent='<div class="col-xs-7" style="margin-left: 20.5%; margin-right: 20.5%;" \n                                    data-product="'+index+'" data-segment="sales">\n                                    <div class="e-card" style="min-height: 34vh;">\n                                        <div class="e-card-image" style="height: 60%; \n                                        background-image: url(\''+productsArray[index].images[0].src+'\');">\n                                        <span class="e-badge e-badge-danger" style="float: right; clear: both; \n                                                    background-color: transparent; color: #d64113;\n                                                    border: 1px #d64113 solid; font-size: 0.6em;">\n                                                    '+Math.ceil(Math.abs(kendo.parseFloat(productsArray[index].price)-kendo.parseFloat(productsArray[index].regular_price))/kendo.parseFloat(productsArray[index].regular_price==="0.00"?productsArray[index].price:productsArray[index].regular_price)*100)+'% OFF\n                                                    </span>\n                                        </div>\n                                        <div class="e-card-header">\n                                            <div class="e-card-header-caption">\n                                                <div class="e-card-sub-title" style="color: #000000; text-align: center; font-size: 14px; text-transform: capitalize">\n                                                    '+productsArray[index].name+'\n                                                </div>\n                                                <div class="e-card-sub-title" style="text-align: center; text-decoration: line-through">\n                                                &#x20a6;'+kendo.toString(kendo.parseFloat(productsArray[index].regular_price),"n2")+'\n                                                </div>\n                                                <div class="e-card-sub-title" style="text-align: center;">\n                                                &#x20a6;'+kendo.toString(kendo.parseFloat(productsArray[index].price),"n2")+"\n                                                </div>\n                                            </div>\n                                        </div>\n                                    </div>\n                                </div>";utopiasoftware[utopiasoftware_app_namespace].controller.homePageViewModel.salesProductsCarousel.append($(columnContent))}resolve()}).catch(function(err){reject()})}))}else{toast=$(".page-toast").get(0).ej2_instances[0];toast.hide("All");toast.cssClass="default-ej2-toast";toast.content="No Internet connection. Pull down to refresh and see live products";toast.dataBind();toast.show();productTypesPromisesArray.push(new Promise(function(resolve,reject){Promise.resolve(utopiasoftware[utopiasoftware_app_namespace].databaseOperations.loadData("banner-products",utopiasoftware[utopiasoftware_app_namespace].model.appDatabase)).then(function(cachedProductsData){return cachedProductsData.products}).then(function(productsArray){$("#home-page #home-latest-design-block").css("opacity","1");utopiasoftware[utopiasoftware_app_namespace].controller.homePageViewModel.newProductsCarousel.remove($("#home-page #home-latest-design-block .row .col-xs-12").get());for(var index=0;index<productsArray.length;index++){var columnContent='<div class="col-xs-12" style="padding-left: 0; padding-right: 0;">\n                                    <div class="e-card" style="min-height: 40vh; max-height: 90vh">\n                                        <div class="e-card-image" style="">\n                                        <img src="css/app-images/blank-img.png" style="width: 100%; height: auto; max-height: 90vh">\n                                        </div>\n                                    </div>\n                                </div>';utopiasoftware[utopiasoftware_app_namespace].controller.homePageViewModel.newProductsCarousel.append($(columnContent))}$("#home-page #home-latest-design-block").css("opacity","1");resolve()}).catch(function(err){$("#home-page #home-latest-design-block").css("opacity","1");reject()})}));productTypesPromisesArray.push(new Promise(function(resolve,reject){Promise.resolve(utopiasoftware[utopiasoftware_app_namespace].databaseOperations.loadData("popular-products",utopiasoftware[utopiasoftware_app_namespace].model.appDatabase)).then(function(cachedProductsData){return cachedProductsData.products}).then(function(productsArray){if(productsArray.length>0){$("#home-page #home-featured-design-block").css({opacity:"1",display:"block"});utopiasoftware[utopiasoftware_app_namespace].controller.homePageViewModel.featuredProductsCarousel.remove($("#home-page #home-featured-design-block .row .col-xs-7").get())}else{$("#home-page #home-featured-design-block").css({opacity:"0",display:"none"})}for(var index=0;index<productsArray.length;index++){var columnContent='<div class="col-xs-7" style="margin-left: 20.5%; margin-right: 20.5%;" \n                                    data-product="'+index+'" data-segment="featured">\n                                    <div class="e-card" style="min-height: 34vh;">\n                                        <div class="e-card-image" style="height: 60%; \n                                        background-image: url(\''+productsArray[index].images[0].src+'\');">\n                                        </div>\n                                        <div class="e-card-header">\n                                            <div class="e-card-header-caption">\n                                                <div class="e-card-sub-title" style="color: #000000; text-align: center; font-size: 14px; text-transform: capitalize">\n                                                    '+productsArray[index].name+'\n                                                </div>\n                                                <div class="e-card-sub-title" style="text-align: center;">\n                                                &#x20a6;'+kendo.toString(kendo.parseFloat(productsArray[index].price),"n2")+"</div>\n                                            </div>\n                                        </div>\n                                    </div>\n                                </div>";utopiasoftware[utopiasoftware_app_namespace].controller.homePageViewModel.featuredProductsCarousel.append($(columnContent))}resolve()}).catch(function(err){reject()})}));productTypesPromisesArray.push(new Promise(function(resolve,reject){Promise.resolve(utopiasoftware[utopiasoftware_app_namespace].databaseOperations.loadData("sales-products",utopiasoftware[utopiasoftware_app_namespace].model.appDatabase)).then(function(cachedProductsData){return cachedProductsData.products}).then(function(productsArray){if(productsArray.length>0){$("#home-page #home-sales-design-block").css({opacity:"1",display:"block"});utopiasoftware[utopiasoftware_app_namespace].controller.homePageViewModel.salesProductsCarousel.remove($("#home-page #home-sales-design-block .row .col-xs-7").get())}else{$("#home-page #home-sales-design-block").css({opacity:"0",display:"none"})}for(var index=0;index<productsArray.length;index++){if(!productsArray[index].regular_price||productsArray[index].regular_price==""){productsArray[index].regular_price="0.00"}var columnContent='<div class="col-xs-7" style="margin-left: 20.5%; margin-right: 20.5%;" \n                                  data-product="'+index+'" data-segment="sales">\n                                    <div class="e-card" style="min-height: 34vh;">\n                                        <div class="e-card-image" style="height: 60%; \n                                        background-image: url(\''+productsArray[index].images[0].src+'\');">\n                                        <span class="e-badge e-badge-danger" style="float: right; clear: both; \n                                                    background-color: transparent; color: #d64113;\n                                                    border: 1px #d64113 solid; font-size: 0.6em;">\n                                                    '+Math.ceil(Math.abs(kendo.parseFloat(productsArray[index].price)-kendo.parseFloat(productsArray[index].regular_price))/kendo.parseFloat(productsArray[index].regular_price==="0.00"?productsArray[index].price:productsArray[index].regular_price)*100)+'% OFF\n                                                    </span>\n                                        </div>\n                                        <div class="e-card-header">\n                                            <div class="e-card-header-caption">\n                                                <div class="e-card-sub-title" style="color: #000000; text-align: center; font-size: 14px; text-transform: capitalize">\n                                                    '+productsArray[index].name+'\n                                                </div>\n                                                <div class="e-card-sub-title" style="text-align: center; text-decoration: line-through">\n                                                &#x20a6;'+kendo.toString(kendo.parseFloat(productsArray[index].regular_price),"n2")+'\n                                                </div>\n                                                <div class="e-card-sub-title" style="text-align: center;">\n                                                &#x20a6;'+kendo.toString(kendo.parseFloat(productsArray[index].price),"n2")+"\n                                                </div>\n                                            </div>\n                                        </div>\n                                    </div>\n                                </div>";utopiasoftware[utopiasoftware_app_namespace].controller.homePageViewModel.salesProductsCarousel.append($(columnContent))}resolve()}).catch(function(err){reject()})}))}return _context5.abrupt("return",Promise.all(productTypesPromisesArray));case 3:case"end":return _context5.stop()}}},_callee5,this)}));function loadProducts(){return _ref5.apply(this,arguments)}return loadProducts}(),showMoreFeaturedProducts:function(){var _ref6=_asyncToGenerator(regeneratorRuntime.mark(function _callee7(){return regeneratorRuntime.wrap(function _callee7$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:window.setTimeout(_asyncToGenerator(regeneratorRuntime.mark(function _callee6(){var productArray,toast;return regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:_context6.prev=0;_context6.next=3;return $("#app-main-tabbar").get(0).setActiveTab(4,{animation:"none"});case 3:_context6.next=5;return utopiasoftware[utopiasoftware_app_namespace].controller.productsPageViewModel.loadProducts({order:"desc",orderby:"date",status:"publish",type:"variable",stock_status:"instock",page:1,per_page:20,featured:true});case 5:productArray=_context6.sent;_context6.next=8;return utopiasoftware[utopiasoftware_app_namespace].controller.productsPageViewModel.displayPageContent(productArray[0]);case 8:_context6.next=18;break;case 10:_context6.prev=10;_context6.t0=_context6["catch"](0);$(".page-toast").get(0).ej2_instances[0].hide("All");toast=$(".page-toast").get(0).ej2_instances[0];toast.cssClass="error-ej2-toast";toast.content="Sorry, an error occurred."+(navigator.connection.type===Connection.NONE?" Connect to the Internet.":"")+" Pull down to refresh and try again";toast.dataBind();toast.show();case 18:_context6.prev=18;$("#products-page .page-preloader").css("display","none");return _context6.finish(18);case 21:case"end":return _context6.stop()}}},_callee6,this,[[0,10,18,21]])})),0);case 1:case"end":return _context7.stop()}}},_callee7,this)}));function showMoreFeaturedProducts(){return _ref6.apply(this,arguments)}return showMoreFeaturedProducts}(),showMoreSalesProducts:function(){var _ref8=_asyncToGenerator(regeneratorRuntime.mark(function _callee9(){return regeneratorRuntime.wrap(function _callee9$(_context9){while(1){switch(_context9.prev=_context9.next){case 0:window.setTimeout(_asyncToGenerator(regeneratorRuntime.mark(function _callee8(){var productArray,toast;return regeneratorRuntime.wrap(function _callee8$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:_context8.prev=0;_context8.next=3;return $("#app-main-tabbar").get(0).setActiveTab(4,{animation:"none"});case 3:_context8.next=5;return utopiasoftware[utopiasoftware_app_namespace].controller.productsPageViewModel.loadProducts({order:"desc",orderby:"date",status:"publish",type:"variable",stock_status:"instock",page:1,per_page:20,on_sale:true});case 5:productArray=_context8.sent;_context8.next=8;return utopiasoftware[utopiasoftware_app_namespace].controller.productsPageViewModel.displayPageContent(productArray[0]);case 8:_context8.next=18;break;case 10:_context8.prev=10;_context8.t0=_context8["catch"](0);$(".page-toast").get(0).ej2_instances[0].hide("All");toast=$(".page-toast").get(0).ej2_instances[0];toast.cssClass="error-ej2-toast";toast.content="Sorry, an error occurred."+(navigator.connection.type===Connection.NONE?" Connect to the Internet.":"")+" Pull down to refresh and try again";toast.dataBind();toast.show();case 18:_context8.prev=18;$("#products-page .page-preloader").css("display","none");return _context8.finish(18);case 21:case"end":return _context8.stop()}}},_callee8,this,[[0,10,18,21]])})),0);case 1:case"end":return _context9.stop()}}},_callee9,this)}));function showMoreSalesProducts(){return _ref8.apply(this,arguments)}return showMoreSalesProducts}(),productItemClicked:function(){var _ref10=_asyncToGenerator(regeneratorRuntime.mark(function _callee11(productIndex,segmentType){return regeneratorRuntime.wrap(function _callee11$(_context11){while(1){switch(_context11.prev=_context11.next){case 0:window.setTimeout(_asyncToGenerator(regeneratorRuntime.mark(function _callee10(){var productItemsArray;return regeneratorRuntime.wrap(function _callee10$(_context10){while(1){switch(_context10.prev=_context10.next){case 0:productItemsArray=[];_context10.prev=1;_context10.t0=segmentType;_context10.next=_context10.t0==="featured"?5:_context10.t0==="sales"?9:13;break;case 5:_context10.next=7;return utopiasoftware[utopiasoftware_app_namespace].databaseOperations.loadData("popular-products",utopiasoftware[utopiasoftware_app_namespace].model.appDatabase);case 7:productItemsArray=_context10.sent.products;return _context10.abrupt("break",13);case 9:_context10.next=11;return utopiasoftware[utopiasoftware_app_namespace].databaseOperations.loadData("sales-products",utopiasoftware[utopiasoftware_app_namespace].model.appDatabase);case 11:productItemsArray=_context10.sent.products;return _context10.abrupt("break",13);case 13:$("#app-main-navigator").get(0).pushPage("product-details-page.html",{animation:"lift",data:{product:productItemsArray[productIndex]}});_context10.next=18;break;case 16:_context10.prev=16;_context10.t1=_context10["catch"](1);case 18:case"end":return _context10.stop()}}},_callee10,this,[[1,16]])})),0);case 1:case"end":return _context11.stop()}}},_callee11,this)}));function productItemClicked(_x2,_x3){return _ref10.apply(this,arguments)}return productItemClicked}()},categoriesPageViewModel:{currentPage:0,pageSize:100,viewContentHeight:0,pageInit:function pageInit(event){var loadPageOnAppReady=function(){var _ref12=_asyncToGenerator(regeneratorRuntime.mark(function _callee13(){var categoryArray,toast;return regeneratorRuntime.wrap(function _callee13$(_context13){while(1){switch(_context13.prev=_context13.next){case 0:if(!(!ons.isReady()||utopiasoftware[utopiasoftware_app_namespace].model.isAppReady===false)){_context13.next=3;break}setTimeout(loadPageOnAppReady,500);return _context13.abrupt("return");case 3:event.target.onDeviceBackButton=utopiasoftware[utopiasoftware_app_namespace].controller.categoriesPageViewModel.backButtonClicked;$("#categories-page-pull-hook",$thisPage).get(0).onAction=utopiasoftware[utopiasoftware_app_namespace].controller.categoriesPageViewModel.pagePullHookAction;$("#categories-page-pull-hook",$thisPage).on("changestate",function(event){switch(event.originalEvent.state){case"initial":$("#categories-page-pull-hook-fab",event.originalEvent.pullHook).html('<ons-icon icon="md-long-arrow-down" size="24px" style="color: #363E7C"></ons-icon>');break;case"preaction":$("#categories-page-pull-hook-fab",event.originalEvent.pullHook).html('<ons-icon icon="md-long-arrow-up" size="24px" style="color: #363E7C"></ons-icon>');break;case"action":$("#categories-page-pull-hook-fab",event.originalEvent.pullHook).html('<ons-progress-circular indeterminate modifier="pull-hook"></ons-progress-circular>');break}});utopiasoftware[utopiasoftware_app_namespace].controller.categoriesPageViewModel.viewContentHeight=Math.floor($("#categories-page .page__content").height());$("#categories-page .page__content").on("scroll",function(){window.setTimeout(function(){var scrollTop=Math.floor($("#categories-page .page__content").scrollTop());var percentageScroll=scrollTop/utopiasoftware[utopiasoftware_app_namespace].controller.categoriesPageViewModel.viewContentHeight*100;if(percentageScroll>=50){$("#categories-page #categories-page-scroll-top-fab").css({transform:"scale(1)",display:"inline-block"})}else{$("#categories-page #categories-page-scroll-top-fab").css({transform:"scale(0)"})}},0)});$thisPage.on("click",".e-card",function(clickEvent){window.setTimeout(_asyncToGenerator(regeneratorRuntime.mark(function _callee12(){var productArray,toast;return regeneratorRuntime.wrap(function _callee12$(_context12){while(1){switch(_context12.prev=_context12.next){case 0:_context12.prev=0;_context12.next=3;return $("#app-main-tabbar").get(0).setActiveTab(4,{animation:"none"});case 3:_context12.next=5;return utopiasoftware[utopiasoftware_app_namespace].controller.productsPageViewModel.loadProducts({order:"desc",orderby:"date",status:"publish",type:"variable",stock_status:"instock",page:1,per_page:20,category:$(clickEvent.currentTarget).attr("data-category-id")});case 5:productArray=_context12.sent;_context12.next=8;return utopiasoftware[utopiasoftware_app_namespace].controller.productsPageViewModel.displayPageContent(productArray[0]);case 8:_context12.next=18;break;case 10:_context12.prev=10;_context12.t0=_context12["catch"](0);$(".page-toast").get(0).ej2_instances[0].hide("All");toast=$(".page-toast").get(0).ej2_instances[0];toast.cssClass="error-ej2-toast";toast.content="Sorry, an error occurred."+(navigator.connection.type===Connection.NONE?" Connect to the Internet.":"")+" Pull down to refresh and try again";toast.dataBind();toast.show();case 18:_context12.prev=18;$("#products-page .page-preloader").css("display","none");return _context12.finish(18);case 21:case"end":return _context12.stop()}}},_callee12,this,[[0,10,18,21]])})),0)});_context13.prev=9;_context13.next=12;return utopiasoftware[utopiasoftware_app_namespace].controller.categoriesPageViewModel.loadCategories();case 12:categoryArray=_context13.sent;_context13.next=15;return utopiasoftware[utopiasoftware_app_namespace].controller.categoriesPageViewModel.displayPageContent(categoryArray[0]);case 15:_context13.next=25;break;case 17:_context13.prev=17;_context13.t0=_context13["catch"](9);$(".page-toast").get(0).ej2_instances[0].hide("All");toast=$(".page-toast").get(0).ej2_instances[0];toast.cssClass="error-ej2-toast";toast.content="Sorry, an error occurred."+(navigator.connection.type===Connection.NONE?" Connect to the Internet.":"")+" Pull down to refresh and try again";toast.dataBind();toast.show();case 25:_context13.prev=25;$("#categories-page .page-preloader").css("display","none");return _context13.finish(25);case 28:case"end":return _context13.stop()}}},_callee13,this,[[9,17,25,28]])}));return function loadPageOnAppReady(){return _ref12.apply(this,arguments)}}();var $thisPage=$(event.target);loadPageOnAppReady()},pageShow:function pageShow(){$("#app-main-page ons-toolbar div.title-bar").html("Products");$("#categories-page #categories-page-scroll-top-fab").css({display:"none"});window.SoftInputMode.set("adjustPan");document.addEventListener("offline",utopiasoftware[utopiasoftware_app_namespace].controller.categoriesPageViewModel.deviceOfflineListener,false);document.addEventListener("online",utopiasoftware[utopiasoftware_app_namespace].controller.categoriesPageViewModel.deviceOnlineListener,false)},pageHide:function(){var _ref14=_asyncToGenerator(regeneratorRuntime.mark(function _callee14(){return regeneratorRuntime.wrap(function _callee14$(_context14){while(1){switch(_context14.prev=_context14.next){case 0:document.removeEventListener("offline",utopiasoftware[utopiasoftware_app_namespace].controller.categoriesPageViewModel.deviceOfflineListener,false);document.removeEventListener("online",utopiasoftware[utopiasoftware_app_namespace].controller.categoriesPageViewModel.deviceOnlineListener,false);case 2:case"end":return _context14.stop()}}},_callee14,this)}));function pageHide(){return _ref14.apply(this,arguments)}return pageHide}(),pageDestroy:function pageDestroy(){},backButtonClicked:function backButtonClicked(){$("#app-main-tabbar").get(0).setActiveTab(0)},deviceOfflineListener:function deviceOfflineListener(){var toast=$(".page-toast").get(0).ej2_instances[0];toast.hide("All");toast.cssClass="default-ej2-toast";toast.content="No Internet connection. Connect to the Internet to see updated products";toast.dataBind();toast.show()},deviceOnlineListener:function deviceOnlineListener(){$(".page-toast").get(0).ej2_instances[0].hide("All")},pagePullHookAction:function(){var _ref15=_asyncToGenerator(regeneratorRuntime.mark(function _callee15(){var doneCallBack=arguments.length>0&&arguments[0]!==undefined?arguments[0]:function(){};var categoryArray,toast;return regeneratorRuntime.wrap(function _callee15$(_context15){while(1){switch(_context15.prev=_context15.next){case 0:$("#categories-page #categories-page-pull-hook").attr("disabled",true);$(".page-toast").get(0).ej2_instances[0].hide("All");_context15.prev=2;_context15.next=5;return utopiasoftware[utopiasoftware_app_namespace].controller.categoriesPageViewModel.loadCategories(1,utopiasoftware[utopiasoftware_app_namespace].controller.categoriesPageViewModel.pageSize);case 5:categoryArray=_context15.sent;_context15.next=8;return utopiasoftware[utopiasoftware_app_namespace].controller.categoriesPageViewModel.displayPageContent(categoryArray[0]);case 8:_context15.next=17;break;case 10:_context15.prev=10;_context15.t0=_context15["catch"](2);toast=$(".page-toast").get(0).ej2_instances[0];toast.cssClass="error-ej2-toast";toast.content="Sorry, an error occurred. Refresh to try again";toast.dataBind();toast.show();case 17:_context15.prev=17;$("#categories-page #categories-page-pull-hook").removeAttr("disabled");doneCallBack();return _context15.finish(17);case 21:case"end":return _context15.stop()}}},_callee15,this,[[2,10,17,21]])}));function pagePullHookAction(){return _ref15.apply(this,arguments)}return pagePullHookAction}(),loadCategories:function(){var _ref16=_asyncToGenerator(regeneratorRuntime.mark(function _callee16(){var pageToAccess=arguments.length>0&&arguments[0]!==undefined?arguments[0]:utopiasoftware[utopiasoftware_app_namespace].controller.categoriesPageViewModel.currentPage+1;var pageSize=arguments.length>1&&arguments[1]!==undefined?arguments[1]:utopiasoftware[utopiasoftware_app_namespace].controller.categoriesPageViewModel.pageSize;var categoryPromisesArray,toast;return regeneratorRuntime.wrap(function _callee16$(_context16){while(1){switch(_context16.prev=_context16.next){case 0:categoryPromisesArray=[];if(navigator.connection.type!==Connection.NONE){categoryPromisesArray.push(new Promise(function(resolve,reject){Promise.resolve($.ajax({url:utopiasoftware[utopiasoftware_app_namespace].model.appBaseUrl+"/wp-json/wc/v3/products/categories",type:"get",beforeSend:function beforeSend(jqxhr){jqxhr.setRequestHeader("Authorization","Basic "+utopiasoftware[utopiasoftware_app_namespace].accessor)},dataType:"json",timeout:24e4,processData:true,data:{order:"asc",orderby:"name",hide_empty:true,page:pageToAccess,per_page:pageSize}})).then(function(categoriesArray){if(categoriesArray.length>0){categoriesArray=categoriesArray.filter(function(element){return element.slug!=="uncategorized"});var cachedDataId=(""+pageToAccess).padStart(7,"0")+"categories";utopiasoftware[utopiasoftware_app_namespace].databaseOperations.saveData({_id:cachedDataId,docType:"PRODUCT_CATEGORIES",categories:categoriesArray},utopiasoftware[utopiasoftware_app_namespace].model.appDatabase);utopiasoftware[utopiasoftware_app_namespace].controller.categoriesPageViewModel.currentPage=pageToAccess}resolve(categoriesArray)}).catch(function(err){reject(err)})}))}else{toast=$(".page-toast").get(0).ej2_instances[0];toast.hide("All");toast.cssClass="default-ej2-toast";toast.content="No Internet connection. Pull down to refresh and see updated products";toast.dataBind();toast.show();categoryPromisesArray.push(new Promise(function(resolve,reject){var cachedDataId=(""+pageToAccess).padStart(7,"0")+"categories";Promise.resolve(utopiasoftware[utopiasoftware_app_namespace].databaseOperations.loadData(cachedDataId,utopiasoftware[utopiasoftware_app_namespace].model.appDatabase)).then(function(cachedCategoriesData){resolve(cachedCategoriesData.categories)}).catch(function(err){reject(err)})}))}return _context16.abrupt("return",Promise.all(categoryPromisesArray));case 3:case"end":return _context16.stop()}}},_callee16,this)}));function loadCategories(){return _ref16.apply(this,arguments)}return loadCategories}(),displayPageContent:function(){var _ref17=_asyncToGenerator(regeneratorRuntime.mark(function _callee17(categoriesArray){var appendContent=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;var overwriteContent=arguments.length>2&&arguments[2]!==undefined?arguments[2]:true;var displayCompletedPromise;return regeneratorRuntime.wrap(function _callee17$(_context17){while(1){switch(_context17.prev=_context17.next){case 0:displayCompletedPromise=new Promise(function(resolve,reject){var categoriesContent="";if(categoriesArray.length<=0){resolve(categoriesArray.length)}else{for(var index=0;index<categoriesArray.length;index++){categoriesContent+='<div class="col-xs-4" ';if((index+1)%3!==0){categoriesContent+='style="border-right: 1px lightgray solid; border-bottom: 1px lightgray solid">'}else{categoriesContent+='style="border-bottom: 1px lightgray solid">'}categoriesContent+='\n                        <ons-ripple background="rgba(63, 81, 181, 0.3)"></ons-ripple>\n                        <div class="e-card" data-category-id="'+categoriesArray[index].id+'">\n                            <div class="e-card-image" style="min-height: 100px; \n                            background-image: url(\''+categoriesArray[index].image.src+'\');">\n                            </div>\n                            <div class="e-card-header">\n                                <div class="e-card-header-caption"  style="padding-left: 3px; padding-right: 5px">\n                                    <div class="e-card-sub-title" style="font-size: 14px; text-align: center; text-transform: capitalize">\n                                        '+categoriesArray[index].name+"\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                      </div>"}if(overwriteContent===true){$("#categories-page #categories-contents-container").html(categoriesContent)}else{if(appendContent===true){$("#categories-page #categories-contents-container").append(categoriesContent)}else{$("#categories-page #categories-contents-container").prepend(categoriesContent)}}resolve(categoriesArray.length)}});return _context17.abrupt("return",displayCompletedPromise);case 2:case"end":return _context17.stop()}}},_callee17,this)}));function displayPageContent(_x9){return _ref17.apply(this,arguments)}return displayPageContent}(),scrollPageToTop:function(){var _ref18=_asyncToGenerator(regeneratorRuntime.mark(function _callee18(){return regeneratorRuntime.wrap(function _callee18$(_context18){while(1){switch(_context18.prev=_context18.next){case 0:window.setTimeout(function(){$("#categories-page .page__content").animate({scrollTop:0},400)},0);case 1:case"end":return _context18.stop()}}},_callee18,this)}));function scrollPageToTop(){return _ref18.apply(this,arguments)}return scrollPageToTop}()},searchPageViewModel:{currentSearchResultsArray:null,pageInit:function pageInit(event){var loadPageOnAppReady=function(){var _ref19=_asyncToGenerator(regeneratorRuntime.mark(function _callee20(){var searchAutoComplete;return regeneratorRuntime.wrap(function _callee20$(_context20){while(1){switch(_context20.prev=_context20.next){case 0:if(!(!ons.isReady()||utopiasoftware[utopiasoftware_app_namespace].model.isAppReady===false)){_context20.next=3;break}setTimeout(loadPageOnAppReady,500);return _context20.abrupt("return");case 3:event.target.onDeviceBackButton=utopiasoftware[utopiasoftware_app_namespace].controller.searchPageViewModel.backButtonClicked;try{searchAutoComplete=new ej.dropdowns.AutoComplete({floatLabelType:"Never",placeholder:"Search Products",allowCustom:true,filterType:"Contains",minLength:1e3,suggestionCount:20,dataSource:[],noRecordsTemplate:"Tap 'Search' key to begin search",blur:function blur(){this._allowRemoteSearch=false;$("#search-page-search-input-popover").get(0).hide()},change:function change(){var searchValue="";if(this._allowRemoteSearch!==true){this._allowRemoteSearch=false;return}if(!this.value||this.value.trim()===""){this._allowRemoteSearch=false;return}searchValue=this.value.trim();$("#search-page-search-input-popover #search-input-popover-list").html('\n                            <ons-list-item modifier="nodivider" lock-on-drag="true">\n                                <div class="left">\n                                    <ons-progress-circular indeterminate modifier="pull-hook" \n                                    style="transform: scale(0.6)"></ons-progress-circular>\n                                </div>\n                                <div class="center">\n                                    <div style="text-align: center;">\n                                        Searching for products\n                                    </div>\n                                </div>\n                            </ons-list-item>');$("#search-page-search-input-popover").get(0).show(document.getElementById("search-page-input"));window.setTimeout(_asyncToGenerator(regeneratorRuntime.mark(function _callee19(){var searchResultsArray,toast;return regeneratorRuntime.wrap(function _callee19$(_context19){while(1){switch(_context19.prev=_context19.next){case 0:searchResultsArray=[];_context19.prev=1;_context19.next=4;return utopiasoftware[utopiasoftware_app_namespace].controller.searchPageViewModel.loadProducts({order:"desc",orderby:"date",status:"publish",type:"variable",stock_status:"instock",page:1,per_page:3,search:searchValue});case 4:searchResultsArray=_context19.sent;_context19.next=7;return utopiasoftware[utopiasoftware_app_namespace].controller.searchPageViewModel.displayPageContent(searchResultsArray[0]);case 7:_context19.next=20;break;case 9:_context19.prev=9;_context19.t0=_context19["catch"](1);$("#search-page #search-page-input").get(0).ej2_instances[0].focusOut();$(".page-toast").get(0).ej2_instances[0].hide("All");$(".timed-page-toast").get(0).ej2_instances[0].hide("All");toast=$(".timed-page-toast").get(0).ej2_instances[0];toast.cssClass="error-ej2-toast";toast.timeOut=3e3;toast.content="Sorry, a search error occurred."+(navigator.connection.type===Connection.NONE?" Connect to the Internet.":"");toast.dataBind();toast.show();case 20:case"end":return _context19.stop()}}},_callee19,this,[[1,9]])})),0)}}).appendTo("#search-page-input")}catch(err){}case 5:case"end":return _context20.stop()}}},_callee20,this)}));return function loadPageOnAppReady(){return _ref19.apply(this,arguments)}}();var $thisPage=$(event.target);loadPageOnAppReady()},pageShow:function pageShow(){$("#app-main-page ons-toolbar div.title-bar").html("Search");window.SoftInputMode.set("adjustPan");document.addEventListener("offline",utopiasoftware[utopiasoftware_app_namespace].controller.searchPageViewModel.deviceOfflineListener,false);document.addEventListener("online",utopiasoftware[utopiasoftware_app_namespace].controller.searchPageViewModel.deviceOnlineListener,false);utopiasoftware[utopiasoftware_app_namespace].controller.searchPageViewModel.displayRecentSearches()},pageHide:function(){var _ref21=_asyncToGenerator(regeneratorRuntime.mark(function _callee21(){return regeneratorRuntime.wrap(function _callee21$(_context21){while(1){switch(_context21.prev=_context21.next){case 0:document.removeEventListener("offline",utopiasoftware[utopiasoftware_app_namespace].controller.searchPageViewModel.deviceOfflineListener,false);document.removeEventListener("online",utopiasoftware[utopiasoftware_app_namespace].controller.searchPageViewModel.deviceOnlineListener,false);utopiasoftware[utopiasoftware_app_namespace].controller.searchPageViewModel.currentSearchResultsArray=null;case 3:case"end":return _context21.stop()}}},_callee21,this)}));function pageHide(){return _ref21.apply(this,arguments)}return pageHide}(),pageDestroy:function pageDestroy(){$("#search-page #search-page-input").get(0).ej2_instances[0].destroy()},backButtonClicked:function backButtonClicked(){$("#search-page-search-input-popover").get(0).hide();$("#app-main-tabbar").get(0).setActiveTab(1)},deviceOfflineListener:function deviceOfflineListener(){var toast=$(".page-toast").get(0).ej2_instances[0];toast.hide("All");toast.cssClass="default-ej2-toast";toast.content="No Internet connection. Connect to the Internet to see search results";toast.dataBind();toast.show()},deviceOnlineListener:function deviceOnlineListener(){$(".page-toast").get(0).ej2_instances[0].hide("All")},displayRecentSearches:function(){var _ref22=_asyncToGenerator(regeneratorRuntime.mark(function _callee22(){var recentSearchData,displayContent,index;return regeneratorRuntime.wrap(function _callee22$(_context22){while(1){switch(_context22.prev=_context22.next){case 0:_context22.prev=0;_context22.next=3;return utopiasoftware[utopiasoftware_app_namespace].databaseOperations.loadData("recent-searches",utopiasoftware[utopiasoftware_app_namespace].model.appDatabase);case 3:recentSearchData=_context22.sent;displayContent="<ons-list-title>Recent Searches</ons-list-title>";for(index=0;index<recentSearchData.products.length;index++){displayContent+='\n                    <ons-list-item modifier="longdivider" tappable lock-on-drag="true">\n                        <div class="center">\n                            <div style="width: 100%;" \n                            onclick="utopiasoftware[utopiasoftware_app_namespace].controller.searchPageViewModel.\n                              recentSearchesItemClicked('+index+')">\n                                <span class="list-item__subtitle">'+recentSearchData.products[index].name+'</span>\n                            </div>\n                        </div>\n                        <div class="right" prevent-tap \n                        onclick="utopiasoftware[utopiasoftware_app_namespace].controller.searchPageViewModel.\n                                    removeRecentSearchItem('+index+', this);">\n                            <ons-icon icon="md-close-circle" style="color: lavender; font-size: 18px;"></ons-icon>\n                        </div>\n                    </ons-list-item>'}$("#search-page #search-list").html(displayContent);_context22.next=11;break;case 9:_context22.prev=9;_context22.t0=_context22["catch"](0);case 11:case"end":return _context22.stop()}}},_callee22,this,[[0,9]])}));function displayRecentSearches(){return _ref22.apply(this,arguments)}return displayRecentSearches}(),saveRecentSearchItem:function(){var _ref23=_asyncToGenerator(regeneratorRuntime.mark(function _callee23(product){var recentSearchesResultArray;return regeneratorRuntime.wrap(function _callee23$(_context23){while(1){switch(_context23.prev=_context23.next){case 0:recentSearchesResultArray=[];_context23.prev=1;_context23.next=4;return utopiasoftware[utopiasoftware_app_namespace].databaseOperations.loadData("recent-searches",utopiasoftware[utopiasoftware_app_namespace].model.appDatabase);case 4:recentSearchesResultArray=_context23.sent.products;_context23.next=9;break;case 7:_context23.prev=7;_context23.t0=_context23["catch"](1);case 9:_context23.prev=9;recentSearchesResultArray.unshift(product);recentSearchesResultArray=recentSearchesResultArray.slice(0,5);_context23.next=14;return utopiasoftware[utopiasoftware_app_namespace].databaseOperations.saveData({_id:"recent-searches",docType:"RECENT_SEARCHES",products:recentSearchesResultArray},utopiasoftware[utopiasoftware_app_namespace].model.appDatabase);case 14:_context23.next=16;return utopiasoftware[utopiasoftware_app_namespace].controller.searchPageViewModel.displayRecentSearches();case 16:_context23.next=20;break;case 18:_context23.prev=18;_context23.t1=_context23["catch"](9);case 20:case"end":return _context23.stop()}}},_callee23,this,[[1,7],[9,18]])}));function saveRecentSearchItem(_x10){return _ref23.apply(this,arguments)}return saveRecentSearchItem}(),removeRecentSearchItem:function(){var _ref24=_asyncToGenerator(regeneratorRuntime.mark(function _callee25(productIndex,clickedElement){return regeneratorRuntime.wrap(function _callee25$(_context25){while(1){switch(_context25.prev=_context25.next){case 0:window.setTimeout(_asyncToGenerator(regeneratorRuntime.mark(function _callee24(){var recentSearchesResultArray,$listItem;return regeneratorRuntime.wrap(function _callee24$(_context24){while(1){switch(_context24.prev=_context24.next){case 0:recentSearchesResultArray=[];_context24.prev=1;_context24.next=4;return utopiasoftware[utopiasoftware_app_namespace].databaseOperations.loadData("recent-searches",utopiasoftware[utopiasoftware_app_namespace].model.appDatabase);case 4:recentSearchesResultArray=_context24.sent.products;_context24.next=9;break;case 7:_context24.prev=7;_context24.t0=_context24["catch"](1);case 9:_context24.prev=9;recentSearchesResultArray.splice(productIndex,1);_context24.next=13;return utopiasoftware[utopiasoftware_app_namespace].databaseOperations.saveData({_id:"recent-searches",docType:"RECENT_SEARCHES",products:recentSearchesResultArray},utopiasoftware[utopiasoftware_app_namespace].model.appDatabase);case 13:$listItem=$(clickedElement).closest("ons-list-item");_context24.next=16;return kendo.fx($listItem).expand("vertical").duration(300).reverse();case 16:_context24.next=18;return utopiasoftware[utopiasoftware_app_namespace].controller.searchPageViewModel.displayRecentSearches();case 18:_context24.next=22;break;case 20:_context24.prev=20;_context24.t1=_context24["catch"](9);case 22:case"end":return _context24.stop()}}},_callee24,this,[[1,7],[9,20]])})),0);case 1:case"end":return _context25.stop()}}},_callee25,this)}));function removeRecentSearchItem(_x11,_x12){return _ref24.apply(this,arguments)}return removeRecentSearchItem}(),recentSearchesItemClicked:function(){var _ref26=_asyncToGenerator(regeneratorRuntime.mark(function _callee27(productIndex){return regeneratorRuntime.wrap(function _callee27$(_context27){while(1){switch(_context27.prev=_context27.next){case 0:window.setTimeout(_asyncToGenerator(regeneratorRuntime.mark(function _callee26(){var recentSearchesResultArray;return regeneratorRuntime.wrap(function _callee26$(_context26){while(1){switch(_context26.prev=_context26.next){case 0:_context26.prev=0;_context26.next=3;return utopiasoftware[utopiasoftware_app_namespace].databaseOperations.loadData("recent-searches",utopiasoftware[utopiasoftware_app_namespace].model.appDatabase);case 3:recentSearchesResultArray=_context26.sent.products;$("#app-main-navigator").get(0).pushPage("product-details-page.html",{animation:"lift",data:{product:recentSearchesResultArray[productIndex]}});_context26.next=9;break;case 7:_context26.prev=7;_context26.t0=_context26["catch"](0);case 9:case"end":return _context26.stop()}}},_callee26,this,[[0,7]])})),0);case 1:case"end":return _context27.stop()}}},_callee27,this)}));function recentSearchesItemClicked(_x13){return _ref26.apply(this,arguments)}return recentSearchesItemClicked}(),enterButtonClicked:function(){var _ref28=_asyncToGenerator(regeneratorRuntime.mark(function _callee28(keyEvent){var searchAutoComplete;return regeneratorRuntime.wrap(function _callee28$(_context28){while(1){switch(_context28.prev=_context28.next){case 0:if(keyEvent.which===kendo.keys.ENTER){keyEvent.preventDefault();keyEvent.stopImmediatePropagation();keyEvent.stopPropagation();Keyboard.hide();searchAutoComplete=$("#search-page #search-page-input").get(0).ej2_instances[0];searchAutoComplete.value=$("#search-page #search-page-input").val();searchAutoComplete._allowRemoteSearch=true;searchAutoComplete.dataBind();searchAutoComplete.change()}case 1:case"end":return _context28.stop()}}},_callee28,this)}));function enterButtonClicked(_x14){return _ref28.apply(this,arguments)}return enterButtonClicked}(),loadProducts:function(){var _ref29=_asyncToGenerator(regeneratorRuntime.mark(function _callee29(queryParam){var pageToAccess=arguments.length>1&&arguments[1]!==undefined?arguments[1]:queryParam.page||1;var pageSize=arguments.length>2&&arguments[2]!==undefined?arguments[2]:queryParam.per_page||3;var productPromisesArray;return regeneratorRuntime.wrap(function _callee29$(_context29){while(1){switch(_context29.prev=_context29.next){case 0:queryParam.page=pageToAccess;queryParam.per_page=pageSize;productPromisesArray=[];if(navigator.connection.type!==Connection.NONE){productPromisesArray.push(new Promise(function(resolve,reject){Promise.resolve($.ajax({url:utopiasoftware[utopiasoftware_app_namespace].model.appBaseUrl+"/wp-json/wc/v3/products",type:"get",beforeSend:function beforeSend(jqxhr){jqxhr.setRequestHeader("Authorization","Basic "+utopiasoftware[utopiasoftware_app_namespace].accessor)},dataType:"json",timeout:24e4,processData:true,data:queryParam})).then(function(productsArray){if(productsArray.length>0){utopiasoftware[utopiasoftware_app_namespace].controller.searchPageViewModel.currentSearchResultsArray=productsArray}resolve(productsArray)}).catch(function(err){reject(err)})}))}else{productPromisesArray.push(Promise.reject("no internet connection"))}return _context29.abrupt("return",Promise.all(productPromisesArray));case 5:case"end":return _context29.stop()}}},_callee29,this)}));function loadProducts(_x17){return _ref29.apply(this,arguments)}return loadProducts}(),displayPageContent:function(){var _ref30=_asyncToGenerator(regeneratorRuntime.mark(function _callee30(productsArray){var displayCompletedPromise;return regeneratorRuntime.wrap(function _callee30$(_context30){while(1){switch(_context30.prev=_context30.next){case 0:displayCompletedPromise=new Promise(function(resolve,reject){var productsContent="";if(productsArray.length<=0){$("#search-page-search-input-popover #search-input-popover-list").html('<ons-list-item modifier="nodivider" lock-on-drag="true">\n                                <div class="center">\n                                    <div style="text-align: center; width: 100%;">\n                                        No Results Found\n                                    </div>\n                                </div>\n                            </ons-list-item>');resolve(productsArray.length)}else{for(var index=0;index<productsArray.length;index++){productsContent+='<ons-list-item modifier="nodivider" tappable lock-on-drag="true" \n                              onclick="utopiasoftware[utopiasoftware_app_namespace].controller.searchPageViewModel.\n                              searchAutocompletePopOverItemClicked('+index+')">\n                                <div class="left">\n                                    <div class="search-result-image" style="background-image: url(\''+productsArray[index].images[0].src+'\'); \n                                                            width: 2em; height: 2em"></div>\n                                </div>\n                                <div class="center">\n                                    <div style="text-align: center;">\n                                        '+productsArray[index].name+"\n                                    </div>\n                                </div>\n                            </ons-list-item>"}productsContent+='<ons-list-item modifier="nodivider" tappable lock-on-drag="true" \n                          onclick="utopiasoftware[utopiasoftware_app_namespace].controller.searchPageViewModel.findMoreClicked();">\n                                <div class="center">\n                                    <div style="text-align: center; width: 100%; font-weight: bold;">\n                                        Find More...\n                                    </div>\n                                </div>\n                            </ons-list-item>';$("#search-page-search-input-popover #search-input-popover-list").html(productsContent);resolve(productsArray.length)}});return _context30.abrupt("return",displayCompletedPromise);case 2:case"end":return _context30.stop()}}},_callee30,this)}));function displayPageContent(_x18){return _ref30.apply(this,arguments)}return displayPageContent}(),searchAutocompletePopOverItemClicked:function(){var _ref31=_asyncToGenerator(regeneratorRuntime.mark(function _callee32(productIndex){var selectedProduct;return regeneratorRuntime.wrap(function _callee32$(_context32){while(1){switch(_context32.prev=_context32.next){case 0:selectedProduct=utopiasoftware[utopiasoftware_app_namespace].controller.searchPageViewModel.currentSearchResultsArray[productIndex];window.setTimeout(_asyncToGenerator(regeneratorRuntime.mark(function _callee31(){return regeneratorRuntime.wrap(function _callee31$(_context31){while(1){switch(_context31.prev=_context31.next){case 0:_context31.prev=0;_context31.next=3;return $("#app-main-navigator").get(0).pushPage("product-details-page.html",{animation:"lift",data:{product:selectedProduct}});case 3:_context31.next=5;return utopiasoftware[utopiasoftware_app_namespace].controller.searchPageViewModel.saveRecentSearchItem(selectedProduct);case 5:$("#search-page #search-page-input").val(selectedProduct.name);_context31.next=10;break;case 8:_context31.prev=8;_context31.t0=_context31["catch"](0);case 10:case"end":return _context31.stop()}}},_callee31,this,[[0,8]])})),0);case 2:case"end":return _context32.stop()}}},_callee32,this)}));function searchAutocompletePopOverItemClicked(_x19){return _ref31.apply(this,arguments)}return searchAutocompletePopOverItemClicked}(),findMoreClicked:function(){var _ref33=_asyncToGenerator(regeneratorRuntime.mark(function _callee34(){return regeneratorRuntime.wrap(function _callee34$(_context34){while(1){switch(_context34.prev=_context34.next){case 0:window.setTimeout(_asyncToGenerator(regeneratorRuntime.mark(function _callee33(){var productArray,toast;return regeneratorRuntime.wrap(function _callee33$(_context33){while(1){switch(_context33.prev=_context33.next){case 0:_context33.prev=0;_context33.next=3;return $("#app-main-tabbar").get(0).setActiveTab(4,{animation:"none"});case 3:_context33.next=5;return utopiasoftware[utopiasoftware_app_namespace].controller.productsPageViewModel.loadProducts({order:"desc",orderby:"date",status:"publish",type:"variable",stock_status:"instock",page:1,per_page:20,search:$("#search-page #search-page-input").get(0).ej2_instances[0].value.trim()});case 5:productArray=_context33.sent;_context33.next=8;return utopiasoftware[utopiasoftware_app_namespace].controller.productsPageViewModel.displayPageContent(productArray[0]);case 8:_context33.next=18;break;case 10:_context33.prev=10;_context33.t0=_context33["catch"](0);$(".page-toast").get(0).ej2_instances[0].hide("All");toast=$(".page-toast").get(0).ej2_instances[0];toast.cssClass="error-ej2-toast";toast.content="Sorry, an error occurred."+(navigator.connection.type===Connection.NONE?" Connect to the Internet.":"")+" Pull down to refresh and try again";toast.dataBind();toast.show();case 18:_context33.prev=18;$("#products-page .page-preloader").css("display","none");return _context33.finish(18);case 21:case"end":return _context33.stop()}}},_callee33,this,[[0,10,18,21]])})),0);case 1:case"end":return _context34.stop()}}},_callee34,this)}));function findMoreClicked(){return _ref33.apply(this,arguments)}return findMoreClicked}()},accountPageViewModel:{pageInit:function pageInit(event){var loadPageOnAppReady=function(){var _ref35=_asyncToGenerator(regeneratorRuntime.mark(function _callee35(){var accordion;return regeneratorRuntime.wrap(function _callee35$(_context35){while(1){switch(_context35.prev=_context35.next){case 0:if(!(!ons.isReady()||utopiasoftware[utopiasoftware_app_namespace].model.isAppReady===false)){_context35.next=3;break}setTimeout(loadPageOnAppReady,500);return _context35.abrupt("return");case 3:event.target.onDeviceBackButton=utopiasoftware[utopiasoftware_app_namespace].controller.accountPageViewModel.backButtonClicked;try{accordion=new ej.navigations.Accordion({expandMode:"Single"});accordion.appendTo("#account-personal-accordion");accordion.expandItem(true,0)}catch(err){}case 5:case"end":return _context35.stop()}}},_callee35,this)}));return function loadPageOnAppReady(){return _ref35.apply(this,arguments)}}();var $thisPage=$(event.target);loadPageOnAppReady()},pageShow:function pageShow(){$("#app-main-page ons-toolbar div.title-bar").html("Account");window.SoftInputMode.set("adjustPan")},pageHide:function(){var _ref36=_asyncToGenerator(regeneratorRuntime.mark(function _callee36(){return regeneratorRuntime.wrap(function _callee36$(_context36){while(1){switch(_context36.prev=_context36.next){case 0:case"end":return _context36.stop()}}},_callee36,this)}));function pageHide(){return _ref36.apply(this,arguments)}return pageHide}(),pageDestroy:function pageDestroy(){},backButtonClicked:function backButtonClicked(){$("#app-main-tabbar").get(0).setActiveTab(2)}},loginPageViewModel:{loginFormValidator:null,signupFormValidator:null,pageInit:function pageInit(event){var loadPageOnAppReady=function(){var _ref37=_asyncToGenerator(regeneratorRuntime.mark(function _callee37(){return regeneratorRuntime.wrap(function _callee37$(_context37){while(1){switch(_context37.prev=_context37.next){case 0:if(!(!ons.isReady()||utopiasoftware[utopiasoftware_app_namespace].model.isAppReady===false)){_context37.next=3;break}setTimeout(loadPageOnAppReady,500);return _context37.abrupt("return");case 3:$("#app-main-navigator").get(0).topPage.onDeviceBackButton=utopiasoftware[utopiasoftware_app_namespace].controller.loginPageViewModel.backButtonClicked;$thisPage.on("postchange","#login-carousel",utopiasoftware[utopiasoftware_app_namespace].controller.loginPageViewModel.changeScreenCarouselPostChange);$thisPage.on("postchange","#login-carousel",utopiasoftware[utopiasoftware_app_namespace].controller.loginPageViewModel.hideTooltipsCarouselPostChange);utopiasoftware[utopiasoftware_app_namespace].controller.loginPageViewModel.loginFormValidator=$("#login-page #login-form").parsley();utopiasoftware[utopiasoftware_app_namespace].controller.loginPageViewModel.signupFormValidator=$("#login-page #signup-form").parsley();utopiasoftware[utopiasoftware_app_namespace].controller.loginPageViewModel.loginFormValidator.on("field:error",function(fieldInstance){var tooltip=$("#login-page #login-form").get(0).ej2_instances[fieldInstance.$element.get(0)._utopiasoftware_validator_index];tooltip.content=fieldInstance.getErrorsMessages()[0];tooltip.dataBind();tooltip.open(fieldInstance.$element.get(0))});utopiasoftware[utopiasoftware_app_namespace].controller.loginPageViewModel.loginFormValidator.on("field:success",function(fieldInstance){var tooltip=$("#login-page #login-form").get(0).ej2_instances[fieldInstance.$element.get(0)._utopiasoftware_validator_index];tooltip.close()});utopiasoftware[utopiasoftware_app_namespace].controller.loginPageViewModel.loginFormValidator.on("form:success",utopiasoftware[utopiasoftware_app_namespace].controller.loginPageViewModel.loginFormValidated);utopiasoftware[utopiasoftware_app_namespace].controller.loginPageViewModel.signupFormValidator.on("field:error",function(fieldInstance){var tooltip=$("#login-page #signup-form").get(0).ej2_instances[fieldInstance.$element.get(0)._utopiasoftware_validator_index];tooltip.content=fieldInstance.getErrorsMessages()[0];tooltip.dataBind();tooltip.open(fieldInstance.$element.get(0))});utopiasoftware[utopiasoftware_app_namespace].controller.loginPageViewModel.signupFormValidator.on("field:success",function(fieldInstance){var tooltip=$("#login-page #signup-form").get(0).ej2_instances[fieldInstance.$element.get(0)._utopiasoftware_validator_index];tooltip.close()});utopiasoftware[utopiasoftware_app_namespace].controller.loginPageViewModel.signupFormValidator.on("form:success",utopiasoftware[utopiasoftware_app_namespace].controller.loginPageViewModel.signupFormValidated);$("#login-page .login-page-form-container").on("scroll",function(){window.setTimeout(function(){switch($("#login-page #login-carousel").get(0).getActiveIndex()){case 0:$("#login-page #login-form ons-input").each(function(index,element){document.getElementById("login-form").ej2_instances[index].refresh(element)});break;case 1:$("#login-page #signup-form ons-input").each(function(index,element){document.getElementById("signup-form").ej2_instances[index].refresh(element)});break;case 2:break}},0)});try{$("#login-form ons-input",$thisPage).each(function(index,element){element._utopiasoftware_validator_index=index;new ej.popups.Tooltip({cssClass:"utopiasoftware-ej2-validation-tooltip",position:"TopCenter",opensOn:"Custom"}).appendTo($("#login-page #login-form").get(0))});$("#signup-form ons-input",$thisPage).each(function(index,element){element._utopiasoftware_validator_index=index;new ej.popups.Tooltip({cssClass:"utopiasoftware-ej2-validation-tooltip",position:"TopCenter",opensOn:"Custom"}).appendTo($("#login-page #signup-form").get(0))});new ej.buttons.Button({isToggle:true,cssClass:"e-flat e-small e-round",iconCss:"zmdi zmdi-eye",iconPosition:"Left"}).appendTo($("#signup-password-view-button",$thisPage).get(0))}catch(err){}case 16:case"end":return _context37.stop()}}},_callee37,this)}));return function loadPageOnAppReady(){return _ref37.apply(this,arguments)}}();var $thisPage=$(event.target);loadPageOnAppReady()},pageShow:function pageShow(){window.SoftInputMode.set("adjustPan");window.addEventListener("keyboardDidShow",utopiasoftware[utopiasoftware_app_namespace].controller.loginPageViewModel.keyboardShownAdjustView)},pageHide:function(){var _ref38=_asyncToGenerator(regeneratorRuntime.mark(function _callee38(){return regeneratorRuntime.wrap(function _callee38$(_context38){while(1){switch(_context38.prev=_context38.next){case 0:window.removeEventListener("keyboardDidShow",utopiasoftware[utopiasoftware_app_namespace].controller.loginPageViewModel.keyboardShownAdjustView);$("#login-page #login-form").get(0).ej2_instances.forEach(function(tooltipArrayElem){tooltipArrayElem.close()});$("#login-page #signup-form").get(0).ej2_instances.forEach(function(tooltipArrayElem){tooltipArrayElem.close()});utopiasoftware[utopiasoftware_app_namespace].controller.loginPageViewModel.loginFormValidator.reset();utopiasoftware[utopiasoftware_app_namespace].controller.loginPageViewModel.signupFormValidator.reset();case 5:case"end":return _context38.stop()}}},_callee38,this)}));function pageHide(){return _ref38.apply(this,arguments)}return pageHide}(),pageDestroy:function pageDestroy(){$("#login-page #login-form").get(0).ej2_instances.forEach(function(tooltipArrayElem){tooltipArrayElem.destroy()});$("#login-page #signup-form").get(0).ej2_instances.forEach(function(tooltipArrayElem){tooltipArrayElem.destroy()});utopiasoftware[utopiasoftware_app_namespace].controller.loginPageViewModel.loginFormValidator.destroy();utopiasoftware[utopiasoftware_app_namespace].controller.loginPageViewModel.signupFormValidator.destroy()},backButtonClicked:function backButtonClicked(){$("#app-main-navigator").get(0).popPage()},segmentButtonClicked:function segmentButtonClicked(itemIndex){$("#login-page #login-carousel").get(0).setActiveIndex(itemIndex)},passwordVisibilityButtonClicked:function passwordVisibilityButtonClicked(buttonElement,inputId){if(!$(buttonElement).hasClass("e-active")){$(document.getElementById(inputId)).attr("type","text");var ej2Button=buttonElement.ej2_instances[0];ej2Button.iconCss="zmdi zmdi-eye-off";ej2Button.dataBind()}else{$(document.getElementById(inputId)).attr("type","password");var _ej2Button=buttonElement.ej2_instances[0];_ej2Button.iconCss="zmdi zmdi-eye";_ej2Button.dataBind()}},changeScreenCarouselPostChange:function changeScreenCarouselPostChange(event){switch(event.originalEvent.activeIndex){case 0:$("#login-page ons-carousel-item.second .login-segment button:nth-of-type(2) input").prop("checked",true);$("#login-page ons-carousel-item.second .login-segment button:nth-of-type(1) input").prop("checked",false);$("#login-page ons-carousel-item.third .login-segment button input").prop("checked",false);$("#login-page ons-carousel-item.first .login-page-form-container").scrollTop(0);break;case 1:$("#login-page ons-carousel-item.first .login-segment button:nth-of-type(1) input").prop("checked",true);$("#login-page ons-carousel-item.first .login-segment button:nth-of-type(2) input").prop("checked",false);$("#login-page ons-carousel-item.third .login-segment button input").prop("checked",false);$("#login-page ons-carousel-item.second .login-page-form-container").scrollTop(0);break;case 2:$("#login-page ons-carousel-item.first .login-segment button:nth-of-type(1) input").prop("checked",true);$("#login-page ons-carousel-item.first .login-segment button:nth-of-type(2) input").prop("checked",false);$("#login-page ons-carousel-item.second .login-segment button:nth-of-type(2) input").prop("checked",true);$("#login-page ons-carousel-item.second .login-segment button:nth-of-type(1) input").prop("checked",false);$("#login-page ons-carousel-item.third .login-page-form-container").scrollTop(0);break}},hideTooltipsCarouselPostChange:function hideTooltipsCarouselPostChange(event){switch(event.originalEvent.lastActiveIndex){case 0:$("#login-page #login-form").get(0).ej2_instances.forEach(function(tooltipArrayElem){tooltipArrayElem.close()});break;case 1:$("#login-page #signup-form").get(0).ej2_instances.forEach(function(tooltipArrayElem){tooltipArrayElem.close()});break;case 2:break}},keyboardShownAdjustView:function keyboardShownAdjustView(event){var adjustedKeyboardHeight=Math.ceil(event.keyboardHeight)+6e3;switch($("#login-page #login-carousel").get(0).getActiveIndex()){case 0:$("#login-page ons-carousel-item.first .login-page-form-container").css({"padding-bottom":adjustedKeyboardHeight+"px"});$("#login-page ons-carousel-item.first .login-page-form-container").scrollTop(Math.floor($(document.activeElement).closest("ons-input").position().top-30));break;case 1:$("#login-page ons-carousel-item.second .login-page-form-container").css({"padding-bottom":adjustedKeyboardHeight+"px"});$("#login-page ons-carousel-item.second .login-page-form-container").scrollTop(Math.floor($(document.activeElement).closest("ons-input").position().top-30));break;case 2:break}},signinButtonClicked:function(){var _ref39=_asyncToGenerator(regeneratorRuntime.mark(function _callee39(){return regeneratorRuntime.wrap(function _callee39$(_context39){while(1){switch(_context39.prev=_context39.next){case 0:utopiasoftware[utopiasoftware_app_namespace].controller.loginPageViewModel.loginFormValidator.whenValidate();case 1:case"end":return _context39.stop()}}},_callee39,this)}));function signinButtonClicked(){return _ref39.apply(this,arguments)}return signinButtonClicked}(),signupButtonClicked:function(){var _ref40=_asyncToGenerator(regeneratorRuntime.mark(function _callee40(){return regeneratorRuntime.wrap(function _callee40$(_context40){while(1){switch(_context40.prev=_context40.next){case 0:utopiasoftware[utopiasoftware_app_namespace].controller.loginPageViewModel.signupFormValidator.whenValidate();case 1:case"end":return _context40.stop()}}},_callee40,this)}));function signupButtonClicked(){return _ref40.apply(this,arguments)}return signupButtonClicked}(),loginFormValidated:function(){var _ref41=_asyncToGenerator(regeneratorRuntime.mark(function _callee41(){return regeneratorRuntime.wrap(function _callee41$(_context41){while(1){switch(_context41.prev=_context41.next){case 0:case"end":return _context41.stop()}}},_callee41,this)}));function loginFormValidated(){return _ref41.apply(this,arguments)}return loginFormValidated}(),signupFormValidated:function(){var _ref42=_asyncToGenerator(regeneratorRuntime.mark(function _callee42(){return regeneratorRuntime.wrap(function _callee42$(_context42){while(1){switch(_context42.prev=_context42.next){case 0:case"end":return _context42.stop()}}},_callee42,this)}));function signupFormValidated(){return _ref42.apply(this,arguments)}return signupFormValidated}()},productsPageViewModel:{currentPage:0,pageSize:20,viewContentHeight:0,lastActiveNavTab:0,currentQueryParam:{},pageInit:function pageInit(event){var loadPageOnAppReady=function(){var _ref43=_asyncToGenerator(regeneratorRuntime.mark(function _callee43(){return regeneratorRuntime.wrap(function _callee43$(_context43){while(1){switch(_context43.prev=_context43.next){case 0:if(!(!ons.isReady()||utopiasoftware[utopiasoftware_app_namespace].model.isAppReady===false)){_context43.next=3;break}setTimeout(loadPageOnAppReady,500);return _context43.abrupt("return");case 3:event.target.onDeviceBackButton=utopiasoftware[utopiasoftware_app_namespace].controller.productsPageViewModel.backButtonClicked;event.target.onInfiniteScroll=utopiasoftware[utopiasoftware_app_namespace].controller.productsPageViewModel.pageInfiniteScroll;$("#products-page-pull-hook",$thisPage).get(0).onAction=utopiasoftware[utopiasoftware_app_namespace].controller.productsPageViewModel.pagePullHookAction;$("#products-page-pull-hook",$thisPage).on("changestate",function(event){switch(event.originalEvent.state){case"initial":$("#products-page-pull-hook-fab",event.originalEvent.pullHook).html('<ons-icon icon="md-long-arrow-down" size="24px" style="color: #363E7C"></ons-icon>');break;case"preaction":$("#products-page-pull-hook-fab",event.originalEvent.pullHook).html('<ons-icon icon="md-long-arrow-up" size="24px" style="color: #363E7C"></ons-icon>');break;case"action":$("#products-page-pull-hook-fab",event.originalEvent.pullHook).html('<ons-progress-circular indeterminate modifier="pull-hook"></ons-progress-circular>');break}});utopiasoftware[utopiasoftware_app_namespace].controller.productsPageViewModel.viewContentHeight=Math.floor($("#products-page .page__content").height());$("#products-page .page__content").on("scroll",function(){window.setTimeout(function(){var scrollTop=Math.floor($("#products-page .page__content").scrollTop());var percentageScroll=scrollTop/utopiasoftware[utopiasoftware_app_namespace].controller.productsPageViewModel.viewContentHeight*100;if(percentageScroll>=50){$("#products-page #products-page-scroll-top-fab").css({transform:"scale(1)",display:"inline-block"})}else{$("#products-page #products-page-scroll-top-fab").css({transform:"scale(0)"})}},0)});$("#app-main-tabbar").on("prechange",function(event){if(event.originalEvent.index===4){return}utopiasoftware[utopiasoftware_app_namespace].controller.productsPageViewModel.lastActiveNavTab=event.originalEvent.index});$thisPage.on("click",".e-card",function(event){utopiasoftware[utopiasoftware_app_namespace].controller.productsPageViewModel.productItemClicked(window.parseInt($(event.currentTarget).attr("data-product")),window.parseInt($(event.currentTarget).attr("data-page")))});try{}catch(err){}case 12:case"end":return _context43.stop()}}},_callee43,this)}));return function loadPageOnAppReady(){return _ref43.apply(this,arguments)}}();var $thisPage=$(event.target);loadPageOnAppReady()},pageShow:function pageShow(event){$("#app-main-page ons-toolbar div.title-bar").html("Products");if($("#app-main-navigator").get(0)._resetPageDisplay!==false){event.target._allowInfinitePageScroll=false;$("#products-page .page-preloader").css("display","block");$("#products-page #products-contents-container").html("");$("#products-page #products-page-scroll-top-fab").css({display:"none"})}window.SoftInputMode.set("adjustPan");document.addEventListener("offline",utopiasoftware[utopiasoftware_app_namespace].controller.productsPageViewModel.deviceOfflineListener,false);document.addEventListener("online",utopiasoftware[utopiasoftware_app_namespace].controller.productsPageViewModel.deviceOnlineListener,false)},pageHide:function(){var _ref44=_asyncToGenerator(regeneratorRuntime.mark(function _callee44(event){return regeneratorRuntime.wrap(function _callee44$(_context44){while(1){switch(_context44.prev=_context44.next){case 0:event.target._allowInfinitePageScroll=false;delete $("#app-main-navigator").get(0)._resetPageDisplay;document.removeEventListener("offline",utopiasoftware[utopiasoftware_app_namespace].controller.productsPageViewModel.deviceOfflineListener,false);document.removeEventListener("online",utopiasoftware[utopiasoftware_app_namespace].controller.productsPageViewModel.deviceOnlineListener,false);$("#products-page .page__content .infinite-load-container").remove();case 5:case"end":return _context44.stop()}}},_callee44,this)}));function pageHide(_x20){return _ref44.apply(this,arguments)}return pageHide}(),pageDestroy:function pageDestroy(){},backButtonClicked:function backButtonClicked(){$("#app-main-tabbar").get(0).setActiveTab(utopiasoftware[utopiasoftware_app_namespace].controller.productsPageViewModel.lastActiveNavTab)},deviceOfflineListener:function deviceOfflineListener(){var toast=$(".page-toast").get(0).ej2_instances[0];toast.hide("All");toast.cssClass="default-ej2-toast";toast.content="No Internet connection. Connect to the Internet to see updated products";toast.dataBind();toast.show()},deviceOnlineListener:function deviceOnlineListener(){$(".page-toast").get(0).ej2_instances[0].hide("All")},pagePullHookAction:function(){var _ref45=_asyncToGenerator(regeneratorRuntime.mark(function _callee45(){var doneCallBack=arguments.length>0&&arguments[0]!==undefined?arguments[0]:function(){};var productArray,toast;return regeneratorRuntime.wrap(function _callee45$(_context45){while(1){switch(_context45.prev=_context45.next){case 0:$("#products-page #products-page-pull-hook").attr("disabled",true);$(".page-toast").get(0).ej2_instances[0].hide("All");_context45.prev=2;_context45.next=5;return utopiasoftware[utopiasoftware_app_namespace].controller.productsPageViewModel.loadProducts(utopiasoftware[utopiasoftware_app_namespace].controller.productsPageViewModel.currentQueryParam,1);case 5:productArray=_context45.sent;_context45.next=8;return utopiasoftware[utopiasoftware_app_namespace].controller.productsPageViewModel.displayPageContent(productArray[0]);case 8:_context45.next=17;break;case 10:_context45.prev=10;_context45.t0=_context45["catch"](2);toast=$(".page-toast").get(0).ej2_instances[0];toast.cssClass="error-ej2-toast";toast.content="Sorry, an error occurred. Refresh to try again";toast.dataBind();toast.show();case 17:_context45.prev=17;$("#products-page .page-preloader").css("display","none");$("#products-page #products-page-pull-hook").removeAttr("disabled");doneCallBack();return _context45.finish(17);case 22:case"end":return _context45.stop()}}},_callee45,this,[[2,10,17,22]])}));function pagePullHookAction(){return _ref45.apply(this,arguments)}return pagePullHookAction}(),pageInfiniteScroll:function(){var _ref46=_asyncToGenerator(regeneratorRuntime.mark(function _callee46(){var doneCallBack=arguments.length>0&&arguments[0]!==undefined?arguments[0]:function(){};var productArray,toast;return regeneratorRuntime.wrap(function _callee46$(_context46){while(1){switch(_context46.prev=_context46.next){case 0:if(!($("#products-page").get(0)._allowInfinitePageScroll===false)){_context46.next=3;break}doneCallBack();return _context46.abrupt("return");case 3:$("#products-page .page__content").append('<div class="infinite-load-container" style="text-align: center">\n                        <ons-progress-circular indeterminate modifier="pull-hook"></ons-progress-circular>\n                    </div>');$(".page-toast").get(0).ej2_instances[0].hide("All");productArray=[];_context46.prev=6;_context46.next=9;return utopiasoftware[utopiasoftware_app_namespace].controller.productsPageViewModel.loadProducts(utopiasoftware[utopiasoftware_app_namespace].controller.productsPageViewModel.currentQueryParam,utopiasoftware[utopiasoftware_app_namespace].controller.productsPageViewModel.currentPage+1);case 9:productArray=_context46.sent;_context46.next=12;return utopiasoftware[utopiasoftware_app_namespace].controller.productsPageViewModel.displayPageContent(productArray[0],true,false);case 12:_context46.next=21;break;case 14:_context46.prev=14;_context46.t0=_context46["catch"](6);toast=$(".page-toast").get(0).ej2_instances[0];toast.cssClass="error-ej2-toast";toast.content="Sorry, an error occurred. Refresh to try again";toast.dataBind();toast.show();case 21:_context46.prev=21;if(productArray&&productArray[0].length>0){$("#products-page .page__content .infinite-load-container").remove()}else{$("#products-page .page__content .infinite-load-container").css({visibility:"hidden"})}doneCallBack();return _context46.finish(21);case 25:case"end":return _context46.stop()}}},_callee46,this,[[6,14,21,25]])}));function pageInfiniteScroll(){return _ref46.apply(this,arguments)}return pageInfiniteScroll}(),loadProducts:function(){var _ref47=_asyncToGenerator(regeneratorRuntime.mark(function _callee47(queryParam){var pageToAccess=arguments.length>1&&arguments[1]!==undefined?arguments[1]:queryParam.page||utopiasoftware[utopiasoftware_app_namespace].controller.productsPageViewModel.currentPage+1;var pageSize=arguments.length>2&&arguments[2]!==undefined?arguments[2]:queryParam.per_page||utopiasoftware[utopiasoftware_app_namespace].controller.productsPageViewModel.pageSize;var productPromisesArray,toast;return regeneratorRuntime.wrap(function _callee47$(_context47){while(1){switch(_context47.prev=_context47.next){case 0:queryParam.page=pageToAccess;queryParam.per_page=pageSize;productPromisesArray=[];if(navigator.connection.type!==Connection.NONE){productPromisesArray.push(new Promise(function(resolve,reject){Promise.resolve($.ajax({url:utopiasoftware[utopiasoftware_app_namespace].model.appBaseUrl+"/wp-json/wc/v3/products",type:"get",beforeSend:function beforeSend(jqxhr){jqxhr.setRequestHeader("Authorization","Basic "+utopiasoftware[utopiasoftware_app_namespace].accessor)},dataType:"json",timeout:24e4,processData:true,data:queryParam})).then(function(productsArray){if(productsArray.length>0){var cachedDataId=(""+pageToAccess).padStart(7,"0")+"products";utopiasoftware[utopiasoftware_app_namespace].databaseOperations.saveData({_id:cachedDataId,docType:"PRODUCTS",products:productsArray},utopiasoftware[utopiasoftware_app_namespace].model.appDatabase);utopiasoftware[utopiasoftware_app_namespace].controller.productsPageViewModel.currentPage=queryParam.page;utopiasoftware[utopiasoftware_app_namespace].controller.productsPageViewModel.currentQueryParam=queryParam}resolve(productsArray)}).catch(function(err){reject(err)})}))}else{toast=$(".page-toast").get(0).ej2_instances[0];toast.hide("All");toast.cssClass="default-ej2-toast";toast.content="No Internet connection. Pull down to refresh and see updated products";toast.dataBind();toast.show();productPromisesArray.push(new Promise(function(resolve,reject){var cachedDataId=(""+pageToAccess).padStart(7,"0")+"products";Promise.resolve(utopiasoftware[utopiasoftware_app_namespace].databaseOperations.loadData(cachedDataId,utopiasoftware[utopiasoftware_app_namespace].model.appDatabase)).then(function(cachedProductsData){resolve(cachedProductsData.products)}).catch(function(err){reject(err)})}))}return _context47.abrupt("return",Promise.all(productPromisesArray));case 5:case"end":return _context47.stop()}}},_callee47,this)}));function loadProducts(_x25){return _ref47.apply(this,arguments)}return loadProducts}(),displayPageContent:function(){var _ref48=_asyncToGenerator(regeneratorRuntime.mark(function _callee48(productsArray){var appendContent=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;var overwriteContent=arguments.length>2&&arguments[2]!==undefined?arguments[2]:true;var index,displayCompletedPromise;return regeneratorRuntime.wrap(function _callee48$(_context48){while(1){switch(_context48.prev=_context48.next){case 0:for(index=0;index<4;index++){productsArray.push.apply(productsArray,_toConsumableArray(productsArray))}displayCompletedPromise=new Promise(function(resolve,reject){var productsContent="";if(productsArray.length<=0){resolve(productsArray.length)}else{for(var _index=0;_index<productsArray.length;_index++){if(!productsArray[_index].regular_price||productsArray[_index].regular_price==""){productsArray[_index].regular_price="0.00"}productsContent+='<div class="col-xs-4" ';if((_index+1)%3!==0){productsContent+='style="border-right: 1px lightgray solid; border-bottom: 1px lightgray solid">'}else{productsContent+='style="border-bottom: 1px lightgray solid">'}productsContent+='\n                        <ons-ripple background="rgba(63, 81, 181, 0.3)"></ons-ripple>\n                        <div class="e-card" \n                        data-product="'+_index+'" \n                        data-page="'+utopiasoftware[utopiasoftware_app_namespace].controller.productsPageViewModel.currentPage+'">\n                            <div class="e-card-image" style="min-height: 100px; \n                            background-image: url(\''+productsArray[_index].images[0].src+"');\">\n                            "+(productsArray[_index].on_sale===true?'\n                            <span class="e-badge e-badge-danger" style="float: right; clear: both; \n                                                    background-color: transparent; color: #d64113;\n                                                    border: 1px #d64113 solid; font-size: 0.6em;">\n                                                    '+Math.ceil(Math.abs(kendo.parseFloat(productsArray[_index].price)-kendo.parseFloat(productsArray[_index].regular_price))/kendo.parseFloat(productsArray[_index].regular_price==="0.00"?productsArray[_index].price:productsArray[_index].regular_price)*100)+"% OFF\n                             </span>":"")+'\n                            </div>\n                            <div class="e-card-header">\n                                <div class="e-card-header-caption"  style="padding-left: 3px; padding-right: 5px">\n                                    <div class="e-card-sub-title" style="color: #000000; font-size: 14px; text-align: center; text-transform: capitalize">\n                                        '+productsArray[_index].name+'\n                                    </div>\n                        <div style="color: gold; font-size: 0.6em !important; white-space: nowrap !important; \n                        text-overflow: ellipsis; overflow: hidden;">\n                        '+(Math.floor(kendo.parseFloat(productsArray[_index].average_rating))>0?'<ons-icon icon="md-star" fixed-width></ons-icon>'.repeat(Math.floor(kendo.parseFloat(productsArray[_index].average_rating))):'<ons-icon icon="md-star-outline" style="color: lightgray" fixed-width></ons-icon>'.repeat(5))+'\n                            <span style="display: inline-block; color: gray;">\n                            '+(Math.floor(kendo.parseFloat(productsArray[_index].average_rating))>0?"("+productsArray[_index].rating_count+")":"")+'\n                           </span>\n                        </div>\n                        <div class="e-card-sub-title" style="text-align: left;">&#x20a6;'+kendo.toString(kendo.parseFloat(productsArray[_index].price),"n2")+'</div>\n                        <div class="e-card-sub-title" style="text-align: left; text-decoration: line-through; \n                        '+(productsArray[_index].on_sale===true?"visibility: visible":"visibility: hidden")+'">&#x20a6;'+kendo.toString(kendo.parseFloat(productsArray[_index].regular_price),"n2")+"</div>\n                        </div>\n                        </div>\n                        </div>\n                        </div>"}if(overwriteContent===true){$("#products-page #products-contents-container").html(productsContent)}else{if(appendContent===true){$("#products-page #products-contents-container").append(productsContent)}else{$("#products-page #products-contents-container").prepend(productsContent)}}$("#products-page").get(0)._allowInfinitePageScroll=true;resolve(productsArray.length)}});return _context48.abrupt("return",displayCompletedPromise);case 3:case"end":return _context48.stop()}}},_callee48,this)}));function displayPageContent(_x28){return _ref48.apply(this,arguments)}return displayPageContent}(),scrollPageToTop:function(){var _ref49=_asyncToGenerator(regeneratorRuntime.mark(function _callee49(){return regeneratorRuntime.wrap(function _callee49$(_context49){while(1){switch(_context49.prev=_context49.next){case 0:window.setTimeout(function(){$("#products-page .page__content").animate({scrollTop:0},400)},0);case 1:case"end":return _context49.stop()}}},_callee49,this)}));function scrollPageToTop(){return _ref49.apply(this,arguments)}return scrollPageToTop}(),productItemClicked:function(){var _ref50=_asyncToGenerator(regeneratorRuntime.mark(function _callee51(productIndex,productPage){return regeneratorRuntime.wrap(function _callee51$(_context51){while(1){switch(_context51.prev=_context51.next){case 0:window.setTimeout(_asyncToGenerator(regeneratorRuntime.mark(function _callee50(){var productItemsArray;return regeneratorRuntime.wrap(function _callee50$(_context50){while(1){switch(_context50.prev=_context50.next){case 0:_context50.prev=0;_context50.next=3;return utopiasoftware[utopiasoftware_app_namespace].databaseOperations.loadData((""+productPage).padStart(7,"0")+"products",utopiasoftware[utopiasoftware_app_namespace].model.appDatabase);case 3:productItemsArray=_context50.sent.products;$("#app-main-navigator").get(0).pushPage("product-details-page.html",{animation:"lift",data:{product:productItemsArray[productIndex]}});_context50.next=9;break;case 7:_context50.prev=7;_context50.t0=_context50["catch"](0);case 9:case"end":return _context50.stop()}}},_callee50,this,[[0,7]])})),0);case 1:case"end":return _context51.stop()}}},_callee51,this)}));function productItemClicked(_x29,_x30){return _ref50.apply(this,arguments)}return productItemClicked}()},productDetailsPageViewModel:{currentProductDetails:null,currentProductVariationIndex:-1,productVariationsArray:[],pageInit:function pageInit(event){var loadPageOnAppReady=function(){var _ref52=_asyncToGenerator(regeneratorRuntime.mark(function _callee52(){var productDetailsArray,toast;return regeneratorRuntime.wrap(function _callee52$(_context52){while(1){switch(_context52.prev=_context52.next){case 0:if(!(!ons.isReady()||utopiasoftware[utopiasoftware_app_namespace].model.isAppReady===false)){_context52.next=3;break}setTimeout(loadPageOnAppReady,500);return _context52.abrupt("return");case 3:$("#app-main-navigator").get(0).topPage.onDeviceBackButton=utopiasoftware[utopiasoftware_app_namespace].controller.productDetailsPageViewModel.backButtonClicked;$("#product-details-page-pull-hook",$thisPage).get(0).onAction=utopiasoftware[utopiasoftware_app_namespace].controller.productDetailsPageViewModel.pagePullHookAction;$("#product-details-page-pull-hook",$thisPage).on("changestate",function(event){switch(event.originalEvent.state){case"initial":$("#product-details-page-pull-hook-fab",event.originalEvent.pullHook).html('<ons-icon icon="md-long-arrow-down" size="24px" style="color: #363E7C"></ons-icon>');break;case"preaction":$("#product-details-page-pull-hook-fab",event.originalEvent.pullHook).html('<ons-icon icon="md-long-arrow-up" size="24px" style="color: #363E7C"></ons-icon>');break;case"action":$("#product-details-page-pull-hook-fab",event.originalEvent.pullHook).html('<ons-progress-circular indeterminate modifier="pull-hook"></ons-progress-circular>');break}});_context52.prev=6;new ej.inputs.NumericTextBox({cssClass:"product-details-quantity-class",currency:null,decimals:0,floatLabelType:"Auto",format:"n",showSpinButton:false,min:1,max:10,placeholder:"Pick Quantity",step:1,strictMode:true,value:1}).appendTo("#product-details-quantity");new ej.buttons.Button({}).appendTo("#product-details-add-to-cart");new ej.buttons.Button({}).appendTo("#product-details-customise-product");new ej.buttons.Button({cssClass:"e-flat e-small",iconCss:"zmdi zmdi-star-outline",iconPosition:"Left"}).appendTo("#product-details-review");new ej.buttons.Button({cssClass:"e-flat e-small",iconCss:"zmdi zmdi-share",iconPosition:"Left"}).appendTo("#product-details-share");utopiasoftware[utopiasoftware_app_namespace].controller.productDetailsPageViewModel.loadProductVariations();_context52.next=15;return utopiasoftware[utopiasoftware_app_namespace].controller.productDetailsPageViewModel.loadProduct();case 15:productDetailsArray=_context52.sent;_context52.next=18;return utopiasoftware[utopiasoftware_app_namespace].controller.productDetailsPageViewModel.displayProductDetails(productDetailsArray[0]);case 18:_context52.next=28;break;case 20:_context52.prev=20;_context52.t0=_context52["catch"](6);$(".page-toast").get(0).ej2_instances[0].hide("All");toast=$(".page-toast").get(0).ej2_instances[0];toast.cssClass="error-ej2-toast";toast.content="Sorry, an error occurred."+(navigator.connection.type===Connection.NONE?" Connect to the Internet.":"")+" Pull down to refresh and try again";toast.dataBind();toast.show();case 28:_context52.prev=28;$("#product-details-page .page-preloader").css("display","none");return _context52.finish(28);case 31:case"end":return _context52.stop()}}},_callee52,this,[[6,20,28,31]])}));return function loadPageOnAppReady(){return _ref52.apply(this,arguments)}}();var $thisPage=$(event.target);loadPageOnAppReady()},pageShow:function pageShow(){window.SoftInputMode.set("adjustPan")},pageHide:function(){var _ref53=_asyncToGenerator(regeneratorRuntime.mark(function _callee53(){return regeneratorRuntime.wrap(function _callee53$(_context53){while(1){switch(_context53.prev=_context53.next){case 0:case"end":return _context53.stop()}}},_callee53,this)}));function pageHide(){return _ref53.apply(this,arguments)}return pageHide}(),pageDestroy:function pageDestroy(){utopiasoftware[utopiasoftware_app_namespace].controller.productDetailsPageViewModel.currentProductDetails=null;utopiasoftware[utopiasoftware_app_namespace].controller.productDetailsPageViewModel.currentProductVariationIndex=-1;utopiasoftware[utopiasoftware_app_namespace].controller.productDetailsPageViewModel.productVariationsArray=[];$("#product-details-quantity").get(0).ej2_instances[0].destroy();$("#product-details-review").get(0).ej2_instances[0].destroy();$("#product-details-share").get(0).ej2_instances[0].destroy();$("#product-details-customise-product").get(0).ej2_instances[0].destroy();$("#product-details-page .product-details-variation-option").each(function(index,element){element.ej2_instances[0].destroy()})},backButtonClicked:function backButtonClicked(){var pagesStackArray=$("#app-main-navigator").get(0).pages;if(pagesStackArray.length>1){var previousPage=$(pagesStackArray[pagesStackArray.length-2]).get(0);switch(previousPage.id){case"app-main-page":if($("#app-main-tabbar").get(0).getActiveTabIndex()===4){$("#app-main-navigator").get(0)._resetPageDisplay=false;$("#products-page").get(0)._allowInfinitePageScroll=true;$("#app-main-navigator").get(0).popPage()}else{$("#app-main-navigator").get(0).popPage()}break;default:$("#app-main-navigator").get(0).popPage();break}}else{}},shareButtonClicked:function(){var _ref54=_asyncToGenerator(regeneratorRuntime.mark(function _callee54(){var shareOptions;return regeneratorRuntime.wrap(function _callee54$(_context54){while(1){switch(_context54.prev=_context54.next){case 0:shareOptions={};shareOptions.message="check out this #ShopOakExclusive product";shareOptions.chooserTitle="share product with...";window.setTimeout(function(){if(utopiasoftware[utopiasoftware_app_namespace].controller.productDetailsPageViewModel.currentProductVariationIndex!==-1){var productVariationIndex=utopiasoftware[utopiasoftware_app_namespace].controller.productDetailsPageViewModel.currentProductVariationIndex;var productVariation=utopiasoftware[utopiasoftware_app_namespace].controller.productDetailsPageViewModel.productVariationsArray[productVariationIndex];shareOptions.url=productVariation.permalink;shareOptions.files=[productVariation.image&&productVariation.image!==""?productVariation.image.src:utopiasoftware[utopiasoftware_app_namespace].controller.productDetailsPageViewModel.currentProductDetails.images[0].src]}else{shareOptions.url=utopiasoftware[utopiasoftware_app_namespace].controller.productDetailsPageViewModel.currentProductDetails.permalink;shareOptions.files=[utopiasoftware[utopiasoftware_app_namespace].controller.productDetailsPageViewModel.currentProductDetails.images[0].src]}cordova.plugins.clipboard.copy(shareOptions.message+" | "+shareOptions.url,function(){window.plugins.toast.showWithOptions({message:"shared message copied to clipboard",duration:3e3,position:"center",styling:{cornerRadius:0,opacity:1,backgroundColor:"#3F51B5",textColor:"#FFFFFF",textSize:14}})},function(){});window.plugins.socialsharing.shareWithOptions(shareOptions,function(){},function(){})},0);case 4:case"end":return _context54.stop()}}},_callee54,this)}));function shareButtonClicked(){return _ref54.apply(this,arguments)}return shareButtonClicked}(),pagePullHookAction:function(){var _ref55=_asyncToGenerator(regeneratorRuntime.mark(function _callee55(){var doneCallBack=arguments.length>0&&arguments[0]!==undefined?arguments[0]:function(){};var productDetailsArray,toast;return regeneratorRuntime.wrap(function _callee55$(_context55){while(1){switch(_context55.prev=_context55.next){case 0:$("#product-details-page #product-details-page-pull-hook").attr("disabled",true);$(".page-toast").get(0).ej2_instances[0].hide("All");_context55.prev=2;utopiasoftware[utopiasoftware_app_namespace].controller.productDetailsPageViewModel.loadProductVariations();_context55.next=6;return utopiasoftware[utopiasoftware_app_namespace].controller.productDetailsPageViewModel.loadProduct();case 6:productDetailsArray=_context55.sent;_context55.next=9;return utopiasoftware[utopiasoftware_app_namespace].controller.productDetailsPageViewModel.displayProductDetails(productDetailsArray[0]);case 9:_context55.next=18;break;case 11:_context55.prev=11;_context55.t0=_context55["catch"](2);toast=$(".page-toast").get(0).ej2_instances[0];toast.cssClass="error-ej2-toast";toast.content="Sorry, an error occurred. Refresh to try again";toast.dataBind();toast.show();case 18:_context55.prev=18;$("#product-details-page #product-details-page-pull-hook").removeAttr("disabled");doneCallBack();return _context55.finish(18);case 22:case"end":return _context55.stop()}}},_callee55,this,[[2,11,18,22]])}));function pagePullHookAction(){return _ref55.apply(this,arguments)}return pagePullHookAction}(),loadProduct:function(){var _ref56=_asyncToGenerator(regeneratorRuntime.mark(function _callee56(){var productPromisesArray,toast,aProduct;return regeneratorRuntime.wrap(function _callee56$(_context56){while(1){switch(_context56.prev=_context56.next){case 0:productPromisesArray=[];if(navigator.connection.type===Connection.NONE){$(".page-toast").get(0).ej2_instances[0].hide("All");$(".timed-page-toast").get(0).ej2_instances[0].hide("All");toast=$(".timed-page-toast").get(0).ej2_instances[0];toast.cssClass="default-ej2-toast";toast.timeOut=3e3;toast.content="Connect to the Internet to see updated product details";toast.dataBind();toast.show()}if($("#app-main-navigator").get(0).topPage.data.product){aProduct=$("#app-main-navigator").get(0).topPage.data.product;if(!aProduct.regular_price||aProduct.regular_price==""){aProduct.regular_price="0.00"}utopiasoftware[utopiasoftware_app_namespace].controller.productDetailsPageViewModel.currentProductDetails=aProduct;productPromisesArray.push(Promise.resolve(aProduct))}else{productPromisesArray.push(new Promise(function(resolve,reject){Promise.resolve($.ajax({url:utopiasoftware[utopiasoftware_app_namespace].model.appBaseUrl+("/wp-json/wc/v3/products/"+jQuery("#app-main-navigator").get(0).topPage.data.productId),type:"get",beforeSend:function beforeSend(jqxhr){jqxhr.setRequestHeader("Authorization","Basic "+utopiasoftware[utopiasoftware_app_namespace].accessor)},dataType:"json",timeout:24e4,processData:true})).then(function(product){if(!product.regular_price||product.regular_price==""){product.regular_price="0.00"}utopiasoftware[utopiasoftware_app_namespace].controller.productDetailsPageViewModel.currentProductDetails=product;resolve(product)}).catch(function(err){reject(err)})}))}return _context56.abrupt("return",Promise.all(productPromisesArray));case 4:case"end":return _context56.stop()}}},_callee56,this)}));function loadProduct(){return _ref56.apply(this,arguments)}return loadProduct}(),loadProductVariations:function(){var _ref57=_asyncToGenerator(regeneratorRuntime.mark(function _callee57(){var productPromisesArray,productId;return regeneratorRuntime.wrap(function _callee57$(_context57){while(1){switch(_context57.prev=_context57.next){case 0:productPromisesArray=[];productId=null;if($("#app-main-navigator").get(0).topPage.data.product){productId=$("#app-main-navigator").get(0).topPage.data.product.id}else{productId=jQuery("#app-main-navigator").get(0).topPage.data.productId}productPromisesArray.push(new Promise(function(resolve,reject){Promise.resolve($.ajax({url:utopiasoftware[utopiasoftware_app_namespace].model.appBaseUrl+("/wp-json/wc/v3/products/"+productId+"/variations"),type:"get",beforeSend:function beforeSend(jqxhr){jqxhr.setRequestHeader("Authorization","Basic "+utopiasoftware[utopiasoftware_app_namespace].accessor)},dataType:"json",timeout:24e4,processData:true,data:{page:1,per_page:99,status:"publish"}})).then(function(productVariations){productVariations=productVariations.map(function(currentElement,index){currentElement._variationValue=currentElement.attributes.map(function(attribute){return attribute.option}).join("");return currentElement});utopiasoftware[utopiasoftware_app_namespace].controller.productDetailsPageViewModel.productVariationsArray=productVariations;resolve(productVariations)}).catch(function(err){reject(err)})}));return _context57.abrupt("return",Promise.all(productPromisesArray));case 5:case"end":return _context57.stop()}}},_callee57,this)}));function loadProductVariations(){return _ref57.apply(this,arguments)}return loadProductVariations}(),displayProductDetails:function(){var _ref58=_asyncToGenerator(regeneratorRuntime.mark(function _callee60(productDetails){var variationContent,index;return regeneratorRuntime.wrap(function _callee60$(_context60){while(1){switch(_context60.prev=_context60.next){case 0:$("#product-details-page .e-card-image").css("background-image",'url("'+productDetails.images[0].src+'")');if(productDetails.on_sale===true){$("#product-details-page .e-card-image").html('\n                <span class="e-badge e-badge-danger" style="float: right; clear: both; \n                                                    background-color: transparent; color: #d64113;\n                                                    border: 1px #d64113 solid; font-size: 0.6em;">\n                                                    '+Math.ceil(Math.abs(kendo.parseFloat(productDetails.price)-kendo.parseFloat(productDetails.regular_price))/kendo.parseFloat(productDetails.regular_price==="0.00"?productDetails.price:productDetails.regular_price)*100)+"% OFF\n                 </span>")}$("#product-details-page .e-card-title").html(""+productDetails.name);$("#product-details-page .product-details-price").html("&#x20a6;"+kendo.toString(kendo.parseFloat(productDetails.price),"n2"));if(productDetails.on_sale===true){$("#product-details-page .product-details-regular-price").html("&#x20a6;"+kendo.toString(kendo.parseFloat(productDetails.regular_price),"n2"));$("#product-details-page .product-details-regular-price").css("visibility","visible");$("#product-details-quantity").get(0).ej2_instances[0].cssClass="product-details-quantity-class sales";$("#product-details-quantity").get(0).ej2_instances[0].dataBind()}else{$("#product-details-page .product-details-regular-price").css("visibility","collapse");$("#product-details-quantity").get(0).ej2_instances[0].cssClass="product-details-quantity-class";$("#product-details-quantity").get(0).ej2_instances[0].dataBind()}$("#product-details-quantity").get(0).ej2_instances[0].value=1;$("#product-details-quantity").get(0).ej2_instances[0].dataBind();$("#product-details-page .product-details-description").html(""+productDetails.short_description);$("#product-details-page .product-details-variation-option").each(function(index,element){element.ej2_instances[0].destroy()});$("#product-details-page .product-details-variations").removeClass("expandable-content");variationContent="";for(index=0;index<productDetails.attributes.length;index++){variationContent+='<div class="col-xs-4" style="padding-right: 5px; padding-left: 5px;">\n                    <select name="'+productDetails.attributes[index].name+'" class="product-details-variation-option">\n                        '+productDetails.attributes[index].options.map(function(arrayElem){return'<option value="'+arrayElem+'">'+arrayElem+"</option>"}).join("")+"\n                    </select>\n                </div>"}$("#product-details-page .product-details-variations").html(variationContent);$("#product-details-page .product-details-variation-option").each(function(index,element){if(productDetails.default_attributes.length>0){$('option[value="'+productDetails.default_attributes[index].option+'"]',element).attr("selected",true)}new ej.dropdowns.DropDownList({cssClass:"product-details-variation-class",placeholder:productDetails.attributes[index].name,floatLabelType:"Always",change:function(){var _ref59=_asyncToGenerator(regeneratorRuntime.mark(function _callee59(){return regeneratorRuntime.wrap(function _callee59$(_context59){while(1){switch(_context59.prev=_context59.next){case 0:return _context59.abrupt("return",new Promise(function(resolve2,reject2){window.setTimeout(_asyncToGenerator(regeneratorRuntime.mark(function _callee58(){var concatenatedVarationValue,variationIndexPosition,productVariation;return regeneratorRuntime.wrap(function _callee58$(_context58){while(1){switch(_context58.prev=_context58.next){case 0:concatenatedVarationValue="";$("#product-details-page .product-details-variation-option").each(function(index2,element2){concatenatedVarationValue+=element2.ej2_instances[0].value});variationIndexPosition=utopiasoftware[utopiasoftware_app_namespace].controller.productDetailsPageViewModel.productVariationsArray.findIndex(function(element3){return concatenatedVarationValue===element3._variationValue});utopiasoftware[utopiasoftware_app_namespace].controller.productDetailsPageViewModel.currentProductVariationIndex=variationIndexPosition;if(utopiasoftware[utopiasoftware_app_namespace].controller.productDetailsPageViewModel.currentProductVariationIndex!==-1){productVariation=utopiasoftware[utopiasoftware_app_namespace].controller.productDetailsPageViewModel.productVariationsArray[variationIndexPosition];if(productVariation.image&&productVariation.image!==""){$("#product-details-page .e-card-image").css("background-image",'url("'+productVariation.image.src+'")')}if(productVariation.price&&productVariation.price!==""){$("#product-details-page .product-details-price").html("&#x20a6;"+kendo.toString(kendo.parseFloat(productVariation.price),"n2"))}}resolve2();case 6:case"end":return _context58.stop()}}},_callee58,this)})),0)}));case 1:case"end":return _context59.stop()}}},_callee59,this)}));function change(){return _ref59.apply(this,arguments)}return change}()}).appendTo(element)});$("#product-details-page .product-details-variations").addClass("expandable-content");$("#product-details-page .product-details-rating").html("\n            "+(Math.floor(kendo.parseFloat(productDetails.average_rating))>0?'<ons-icon icon="md-star" fixed-width></ons-icon>'.repeat(Math.floor(kendo.parseFloat(productDetails.average_rating))):'<ons-icon icon="md-star-outline" style="color: lightgray" fixed-width></ons-icon>'.repeat(5))+'\n                <span style="display: inline-block; color: gray;">\n                '+(Math.floor(kendo.parseFloat(productDetails.average_rating))>0?"("+productDetails.rating_count+")":"")+"\n                </span>\n            ");$("#product-details-page .product-details-more-description").html("\n            "+productDetails.description);$("#product-details-page .product-details-dimensions").html('\n            <span class="list-item__subtitle" style="display: block">length - '+(!productDetails.dimensions.length||productDetails.dimensions.length==""?"(Not Available)":""+productDetails.dimensions.length)+'</span>\n            <span class="list-item__subtitle" style="display: block">width - '+(!productDetails.dimensions.width||productDetails.dimensions.width==""?"(Not Available)":""+productDetails.dimensions.width)+'</span>\n            <span class="list-item__subtitle" style="display: block">height - '+(!productDetails.dimensions.height||productDetails.dimensions.height==""?"(Not Available)":""+productDetails.dimensions.height)+"</span>");$("#product-details-page .product-details-weight").html(""+(!productDetails.weight||productDetails.weight==""?"(Not Available)":""+productDetails.weight));case 19:case"end":return _context60.stop()}}},_callee60,this)}));function displayProductDetails(_x32){return _ref58.apply(this,arguments)}return displayProductDetails}(),customiseButtonClicked:function(){var _ref61=_asyncToGenerator(regeneratorRuntime.mark(function _callee62(){var toast;return regeneratorRuntime.wrap(function _callee62$(_context62){while(1){switch(_context62.prev=_context62.next){case 0:if(!(navigator.connection.type===Connection.NONE)){_context62.next=10;break}$(".page-toast").get(0).ej2_instances[0].hide("All");$(".timed-page-toast").get(0).ej2_instances[0].hide("All");toast=$(".timed-page-toast").get(0).ej2_instances[0];toast.cssClass="error-ej2-toast";toast.timeOut=3500;toast.content="Please connect to the Internet to customise product";toast.dataBind();toast.show();return _context62.abrupt("return");case 10:window.setTimeout(_asyncToGenerator(regeneratorRuntime.mark(function _callee61(){var productUrl,variationIndex,productVariation;return regeneratorRuntime.wrap(function _callee61$(_context61){while(1){switch(_context61.prev=_context61.next){case 0:productUrl="";if(utopiasoftware[utopiasoftware_app_namespace].controller.productDetailsPageViewModel.currentProductVariationIndex!==-1){variationIndex=utopiasoftware[utopiasoftware_app_namespace].controller.productDetailsPageViewModel.currentProductVariationIndex;productVariation=utopiasoftware[utopiasoftware_app_namespace].controller.productDetailsPageViewModel.productVariationsArray[variationIndex];productUrl=productVariation.permalink}else{productUrl=utopiasoftware[utopiasoftware_app_namespace].controller.productDetailsPageViewModel.currentProductDetails.permalink}_context61.next=4;return $("#app-main-navigator").get(0).pushPage("customise-product-page.html");case 4:_context61.next=6;return utopiasoftware[utopiasoftware_app_namespace].controller.customiseProductPageViewModel.loadProductCustomisation(productUrl);case 6:case"end":return _context61.stop()}}},_callee61,this)})),0);case 11:case"end":return _context62.stop()}}},_callee62,this)}));function customiseButtonClicked(){return _ref61.apply(this,arguments)}return customiseButtonClicked}()},customiseProductPageViewModel:{currentCustomisationUrl:"",pageInit:function pageInit(event){var loadPageOnAppReady=function(){var _ref63=_asyncToGenerator(regeneratorRuntime.mark(function _callee63(){return regeneratorRuntime.wrap(function _callee63$(_context63){while(1){switch(_context63.prev=_context63.next){case 0:if(!(!ons.isReady()||utopiasoftware[utopiasoftware_app_namespace].model.isAppReady===false)){_context63.next=3;break}setTimeout(loadPageOnAppReady,500);return _context63.abrupt("return");case 3:$("#app-main-navigator").get(0).topPage.onDeviceBackButton=utopiasoftware[utopiasoftware_app_namespace].controller.customiseProductPageViewModel.backButtonClicked;$("#customise-product-page-pull-hook",$thisPage).get(0).onAction=utopiasoftware[utopiasoftware_app_namespace].controller.customiseProductPageViewModel.pagePullHookAction;window.addEventListener("message",utopiasoftware[utopiasoftware_app_namespace].controller.customiseProductPageViewModel.receiveMessageListener,false);$("#customise-product-page-pull-hook",$thisPage).on("changestate",function(event){switch(event.originalEvent.state){case"initial":$("#customise-product-page-pull-hook-fab",event.originalEvent.pullHook).html('<ons-icon icon="md-long-arrow-down" size="24px" style="color: #363E7C"></ons-icon>');break;case"preaction":$("#customise-product-page-pull-hook-fab",event.originalEvent.pullHook).html('<ons-icon icon="md-long-arrow-up" size="24px" style="color: #363E7C"></ons-icon>');break;case"action":$("#customise-product-page-pull-hook-fab",event.originalEvent.pullHook).html('<ons-progress-circular indeterminate modifier="pull-hook"></ons-progress-circular>');break}});case 7:case"end":return _context63.stop()}}},_callee63,this)}));return function loadPageOnAppReady(){return _ref63.apply(this,arguments)}}();var $thisPage=$(event.target);loadPageOnAppReady()},pageShow:function pageShow(){window.SoftInputMode.set("adjustPan");document.addEventListener("offline",utopiasoftware[utopiasoftware_app_namespace].controller.customiseProductPageViewModel.deviceOfflineListener,false);document.addEventListener("online",utopiasoftware[utopiasoftware_app_namespace].controller.customiseProductPageViewModel.deviceOnlineListener,false)},pageHide:function(){var _ref64=_asyncToGenerator(regeneratorRuntime.mark(function _callee64(){return regeneratorRuntime.wrap(function _callee64$(_context64){while(1){switch(_context64.prev=_context64.next){case 0:document.removeEventListener("offline",utopiasoftware[utopiasoftware_app_namespace].controller.customiseProductPageViewModel.deviceOfflineListener,false);document.removeEventListener("online",utopiasoftware[utopiasoftware_app_namespace].controller.customiseProductPageViewModel.deviceOnlineListener,false);case 2:case"end":return _context64.stop()}}},_callee64,this)}));function pageHide(){return _ref64.apply(this,arguments)}return pageHide}(),pageDestroy:function pageDestroy(){window.removeEventListener("message",utopiasoftware[utopiasoftware_app_namespace].controller.customiseProductPageViewModel.receiveMessageListener,false)},backButtonClicked:function backButtonClicked(){$("#app-main-navigator").get(0).popPage()},deviceOfflineListener:function deviceOfflineListener(){$(".page-toast").get(0).ej2_instances[0].hide("All");$(".timed-page-toast").get(0).ej2_instances[0].hide("All");var toast=$(".page-toast").get(0).ej2_instances[0];toast.cssClass="default-ej2-toast";toast.content="No Internet connection. Connect to the Internet to customise product";toast.dataBind();toast.show()},deviceOnlineListener:function deviceOnlineListener(){$(".page-toast").get(0).ej2_instances[0].hide("All")},receiveMessageListener:function(){var _ref65=_asyncToGenerator(regeneratorRuntime.mark(function _callee65(receiveEvent){return regeneratorRuntime.wrap(function _callee65$(_context65){while(1){switch(_context65.prev=_context65.next){case 0:if(!(receiveEvent.origin!=="https://shopoakexclusive.com")){_context65.next=2;break}return _context65.abrupt("return");case 2:if(!(receiveEvent.data==="page ready")){_context65.next=5;break}$("#customise-product-page .page-preloader").css("display","none");return _context65.abrupt("return");case 5:case"end":return _context65.stop()}}},_callee65,this)}));function receiveMessageListener(_x33){return _ref65.apply(this,arguments)}return receiveMessageListener}(),pagePullHookAction:function(){var _ref66=_asyncToGenerator(regeneratorRuntime.mark(function _callee66(){var doneCallBack=arguments.length>0&&arguments[0]!==undefined?arguments[0]:function(){};var toast;return regeneratorRuntime.wrap(function _callee66$(_context66){while(1){switch(_context66.prev=_context66.next){case 0:$("#customise-product-page .page-preloader").css("display","block");$("#customise-product-page #customise-product-page-pull-hook").attr("disabled",true);$(".page-toast").get(0).ej2_instances[0].hide("All");_context66.prev=3;_context66.next=6;return utopiasoftware[utopiasoftware_app_namespace].controller.customiseProductPageViewModel.loadProductCustomisation();case 6:_context66.next=15;break;case 8:_context66.prev=8;_context66.t0=_context66["catch"](3);toast=$(".page-toast").get(0).ej2_instances[0];toast.cssClass="error-ej2-toast";toast.content="Sorry, an error occurred. Refresh to try again";toast.dataBind();toast.show();case 15:_context66.prev=15;window.setTimeout(function(){$("#customise-product-page #customise-product-page-pull-hook").removeAttr("disabled");doneCallBack()},2e3);return _context66.finish(15);case 18:case"end":return _context66.stop()}}},_callee66,this,[[3,8,15,18]])}));function pagePullHookAction(){return _ref66.apply(this,arguments)}return pagePullHookAction}(),loadProductCustomisation:function(){var _ref67=_asyncToGenerator(regeneratorRuntime.mark(function _callee67(){var customisationUrl=arguments.length>0&&arguments[0]!==undefined?arguments[0]:utopiasoftware[utopiasoftware_app_namespace].controller.customiseProductPageViewModel.currentCustomisationUrl;var toast;return regeneratorRuntime.wrap(function _callee67$(_context67){while(1){switch(_context67.prev=_context67.next){case 0:if(!(navigator.connection.type===Connection.NONE)){_context67.next=10;break}$(".page-toast").get(0).ej2_instances[0].hide("All");$(".timed-page-toast").get(0).ej2_instances[0].hide("All");toast=$(".timed-page-toast").get(0).ej2_instances[0];toast.cssClass="default-ej2-toast";toast.timeOut=3500;toast.content="Please connect to the Internet to customise product and Pull Down to refresh";toast.dataBind();toast.show();return _context67.abrupt("return");case 10:$("#customise-product-page #customise-product-page-iframe").attr("src",customisationUrl);utopiasoftware[utopiasoftware_app_namespace].controller.customiseProductPageViewModel.currentCustomisationUrl=customisationUrl;return _context67.abrupt("return",true);case 13:case"end":return _context67.stop()}}},_callee67,this)}));function loadProductCustomisation(){return _ref67.apply(this,arguments)}return loadProductCustomisation}()}};